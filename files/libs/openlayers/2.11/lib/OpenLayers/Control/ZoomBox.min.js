OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,alwaysZoom:!1,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(e){if(e instanceof OpenLayers.Bounds){var t;if(this.out){var i=Math.abs(e.right-e.left),n=Math.abs(e.top-e.bottom),r=Math.min(this.map.size.h/n,this.map.size.w/i),o=this.map.getExtent(),s=this.map.getLonLatFromPixel(e.getCenterPixel()),a=s.lon-o.getWidth()/2*r,l=s.lon+o.getWidth()/2*r,c=s.lat-o.getHeight()/2*r,h=s.lat+o.getHeight()/2*r;t=new OpenLayers.Bounds(a,c,l,h)}else{var u=this.map.getLonLatFromPixel(new OpenLayers.Pixel(e.left,e.bottom)),d=this.map.getLonLatFromPixel(new OpenLayers.Pixel(e.right,e.top));t=new OpenLayers.Bounds(u.lon,u.lat,d.lon,d.lat)}var p=this.map.getZoom();this.map.zoomToExtent(t),p==this.map.getZoom()&&1==this.alwaysZoom&&this.map.zoomTo(p+(this.out?-1:1))}else this.out?this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()-1):this.map.setCenter(this.map.getLonLatFromPixel(e),this.map.getZoom()+1)},CLASS_NAME:"OpenLayers.Control.ZoomBox"});