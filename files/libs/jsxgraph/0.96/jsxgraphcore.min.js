var JXG={};(function(){var e,t;if(JXG.countDrawings=0,JXG.countTime=0,JXG.require=function(){},JXG.rendererFiles={},JXG.rendererFiles.svg="SVGRenderer",JXG.rendererFiles.vml="VMLRenderer",JXG.rendererFiles.canvas="CanvasRenderer",JXG.baseFiles=null,JXG.requirePath="","undefined"!=typeof document)for(e=0;document.getElementsByTagName("script").length>e;e++)t=document.getElementsByTagName("script")[e],t.src&&t.src.match(/loadjsxgraphInOneFile\.js(\?.*)?$/)&&(JXG.requirePath=t.src.replace(/loadjsxgraphInOneFile\.js(\?.*)?$/,""));JXG.serverBase=JXG.requirePath+"server/","undefined"!=typeof module&&(module.exports=JXG)})(),JXG.extend=function(e,t,i,n){var r,o;i=i||!1,n=n||!1;for(r in t)(!i||i&&t.hasOwnProperty(r))&&(o=n?r.toLowerCase():r,e[o]=t[r])},JXG.shortcut=function(e,t){return function(){return e[t].apply(this,arguments)}},JXG.extend(JXG,{touchProperty:"touches",version:"0.96.01",supportsVML:function(){return"undefined"!=typeof document&&!!document.namespaces},supportsSVG:function(){return"undefined"!=typeof document&&document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")},supportsCanvas:function(){return"undefined"!=typeof document&&!!document.createElement("canvas").getContext},isNode:function(){return"undefined"==typeof document&&"undefined"==typeof window&&"undefined"!=typeof module&&module.exports},isTouchDevice:function(){return"ontouchstart"in document.documentElement},isAndroid:function(){return JXG.exists(navigator)&&navigator.userAgent.toLowerCase().search("android")>-1},isWebkitAndroid:function(){return this.isAndroid()&&navigator.userAgent.search(" AppleWebKit/")>-1},isApple:function(){return JXG.exists(navigator)&&(-1!=navigator.userAgent.search(/iPad/)||-1!=navigator.userAgent.search(/iPhone/))},isWebkitApple:function(){return this.isApple()&&navigator.userAgent.search(/Mobile *.*Safari/)>-1},isMetroApp:function(){return"undefined"!=typeof window&&window.clientInformation&&window.clientInformation.appName&&window.clientInformation.appName.indexOf("MSAppHost")>-1},clearVisPropOld:function(e){e.visPropOld={strokecolor:"",strokeopacity:"",strokewidth:"",fillcolor:"",fillopacity:"",shadow:!1,firstarrow:!1,lastarrow:!1,cssclass:"",fontsize:-1}},ieVersion:function(){var e;if("undefined"==typeof document)return e;for(var t=3,i=document.createElement("div"),n=i.getElementsByTagName("i");i.innerHTML="<!--[if gt IE "+ ++t+"]><i><"+"/i><![endif]-->",n[0];);return t>4?t:e}(),getReference:function(e,t){return"string"==typeof t&&(JXG.exists(e.objects[t])?t=e.objects[t]:JXG.exists(e.elementsByName[t])?t=e.elementsByName[t]:JXG.exists(e.groups[t])&&(t=e.groups[t])),t},getRef:JXG.shortcut(JXG,"getReference"),isId:function(e,t){return"string"==typeof t&&!!e.objects[t]},isName:function(e,t){return"string"==typeof t&&!!e.elementsByName[t]},isGroup:function(e,t){return"string"==typeof t&&!!e.groups[t]},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isFunction:function(e){return"function"==typeof e},isArray:function(e){var t;return t=Array.isArray?Array.isArray(e):null!==e&&"object"==typeof e&&"splice"in e&&"join"in e},isPoint:function(e){return"object"==typeof e?e.elementClass==JXG.OBJECT_CLASS_POINT:!1},exists:function(e){return function(t){return t!==e&&null!==t}}(),def:function(e,t){return JXG.exists(e)?e:t},str2Bool:function(e){return JXG.exists(e)?"boolean"==typeof e?e:JXG.isString(e)?"true"==e.toLowerCase():!1:!0},_board:function(e,t){return JXG.JSXGraph.initBoard(e,t)},createEvalFunction:function(e,t,i){var n,r,o=[];for(n=0;i>n;n++)"string"==typeof t[n]&&(r=JXG.GeonextParser.geonext2JS(t[n],e),r=r.replace(/this\.board\./g,"board."),o[n]=Function("","return "+r+";"));return function(e){var i=t[e];return"string"==typeof i?o[e]():"function"==typeof i?i():"number"==typeof i?i:0}},createFunction:function(e,t,i,n){var r=null;return JXG.exists(n)&&!n||!JXG.isString(e)?JXG.isFunction(e)?r=e:JXG.isNumber(e)?r=function(){return e}:JXG.isString(e)&&(r=function(){return e}):r=t.jc.snippet(e,!0,i,!0),null!==r&&(r.origin=e),r},checkParents:function(e,t,i){var n,r,o,a,s=[],l=t.slice(0),c=function(e,t){var i=(typeof e).toLowerCase();if("number"===i)return t&&(t.type&&t.type===e||t.elementClass&&t.elementClass===e);switch(e.toLowerCase()){case"string":case"object":case"function":case"number":return(typeof t).toLowerCase()===e.toLowerCase();case"array":return JXG.isArray(t)}return!1};for(n=0;i.length>n;n++){for(r=0;i[n].length>r&&t.length>=i[n].length;r++){for(o=0;l.length>o&&!c(i[n][r],l[o]);)o++;l.length>o&&s.push(l.splice(a-o-1,1)[0])}if(!l.length)return s;l=t.slice(0),s=[]}},readOption:function(e,t,i){var n=e.elements[i];return JXG.exists(e[t][i])&&(n=e[t][i]),n},checkAttributes:function(e,t){var i;JXG.exists(e)||(e={});for(i in t)JXG.exists(e[i])||(e[i]=t[i]);return e},copyAttributes:function(e,t){var i,n,r,o,a,s={circle:1,curve:1,image:1,line:1,point:1,polygon:1,text:1,ticks:1,integral:1};for(r=arguments.length,i=3>r||s[arguments[2]]?this.deepCopy(t.elements,null,!0):{},4>r&&this.exists(arguments[2])&&this.exists(t.layer[arguments[2]])&&(i.layer=t.layer[arguments[2]]),o=t,a=!0,n=2;r>n;n++){if(!JXG.exists(o[arguments[n]])){a=!1;break}o=o[arguments[n]]}for(a&&(i=this.deepCopy(i,o,!0)),o=e,a=!0,n=3;r>n;n++){if(!JXG.exists(o[arguments[n]])){a=!1;break}o=o[arguments[n]]}for(a&&this.extend(i,o,null,!0),o=t,a=!0,n=2;r>n;n++){if(!JXG.exists(o[arguments[n]])){a=!1;break}o=o[arguments[n]]}return a&&(i.label=JXG.deepCopy(o.label,i.label)),i.label=JXG.deepCopy(t.label,i.label),i},getDimensions:function(e){var t,i,n,r,o,a,s,l;if("undefined"==typeof document||null==e)return{width:500,height:500};if(t=document.getElementById(e),!JXG.exists(t))throw Error("\nJSXGraph: HTML container element '"+e+"' not found.");return i=t.style.display,"none"!=i&&null!=i?{width:t.offsetWidth,height:t.offsetHeight}:(n=t.style,r=n.visibility,o=n.position,a=n.display,n.visibility="hidden",n.position="absolute",n.display="block",s=t.clientWidth,l=t.clientHeight,n.display=a,n.position=o,n.visibility=r,{width:s,height:l})},addEvent:function(e,t,i,n){var r=function(){return i.apply(n,arguments)};r.origin=i,n["x_internal"+t]=n["x_internal"+t]||[],n["x_internal"+t].push(r),JXG.exists(e)&&JXG.exists(e.addEventListener)?e.addEventListener(t,r,!1):e.attachEvent("on"+t,r)},removeEvent:function(e,t,i,n){var r;if(!JXG.exists(n))return JXG.debug("no such owner"),void 0;if(!JXG.exists(n["x_internal"+t]))return JXG.debug("no such type: "+t),void 0;if(!JXG.isArray(n["x_internal"+t]))return JXG.debug("owner[x_internal + "+t+"] is not an array"),void 0;if(r=JXG.indexOf(n["x_internal"+t],i,"origin"),-1===r)return JXG.debug("no such event function in internal list: "+i),void 0;try{JXG.exists(e.addEventListener)?e.removeEventListener(t,n["x_internal"+t][r],!1):e.detachEvent("on"+t,n["x_internal"+t][r])}catch(o){JXG.debug("event not registered in browser: ("+t+" -- "+i+")")}n["x_internal"+t].splice(r,1)},removeAllEvents:function(e,t,i){var n,r;if(i["x_internal"+t]){for(r=i["x_internal"+t].length,n=r-1;n>=0;n--)JXG.removeEvent(e,t,i["x_internal"+t][n].origin,i);i["x_internal"+t].length>0&&JXG.debug("removeAllEvents: Not all events could be removed.")}},bind:function(e,t){return function(){return e.apply(t,arguments)}},removeElementFromArray:function(e,t){var i;for(i=0;e.length>i;i++)if(e[i]===t)return e.splice(i,1),e;return e},getPosition:function(e,t){var i,n,r,o=0,a=0;if(e||(e=window.event),r=e[JXG.touchProperty],JXG.exists(t))if(-1==t){for(n=r.length,i=0;n>i;i++)if(r[i]){e=r[i];break}}else e=r[t];return e.pageX||e.pageY?(o=e.pageX,a=e.pageY):(e.clientX||e.clientY)&&(o=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,a=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),[o,a]},getOffset:function(e){var t,i=e,n=e,r=i.offsetLeft-i.scrollLeft,o=i.offsetTop-i.scrollTop;for(t=this.getCSSTransform([r,o],i),r=t[0],o=t[1];i=i.offsetParent;)for(r+=i.offsetLeft,o+=i.offsetTop,i.offsetParent&&(r+=i.clientLeft-i.scrollLeft,o+=i.clientTop-i.scrollTop),t=this.getCSSTransform([r,o],i),r=t[0],o=t[1],n=n.parentNode;n!=i;)r+=n.clientLeft-n.scrollLeft,o+=n.clientTop-n.scrollTop,t=this.getCSSTransform([r,o],n),r=t[0],o=t[1],n=n.parentNode;return[r,o]},getStyle:function(e,t){var i;return window.getComputedStyle?i=document.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.currentStyle&&JXG.ieVersion>=9?i=e.currentStyle[t]:e.style&&(t=t.replace(/-([a-z]|[0-9])/gi,function(e,t){return(t+"").toUpperCase()}),i=e.style[t]),i},getCSSTransform:function(e,t){var i,n,r,o,a,s,l,c,u=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(a=u.length,i=0,r="";a>i;i++)if(JXG.exists(t.style[u[i]])){r=t.style[u[i]];break}if(""!=r&&(o=r.indexOf("("),o>0)){for(a=r.length,arrstr=r.substring(o+1,a-1),l=arrstr.split(","),n=0,s=l.length;s>n;n++)l[n]=parseFloat(l[n]);0==r.indexOf("matrix")?(c=[[l[0],l[1]],[l[2],l[3]]],e[0]+=l[4],e[1]+=l[5]):0==r.indexOf("translateX")?e[0]+=l[0]:0==r.indexOf("translateY")?e[1]+=l[0]:0==r.indexOf("translate")?(e[0]+=l[0],e[1]+=l[1]):0==r.indexOf("scaleX")?(c=[[l[0],0],[0,1]],e=JXG.Math.matVecMult(c,e)):0==r.indexOf("scaleY")?(c=[[1,0],[0,l[0]]],e=JXG.Math.matVecMult(c,e)):0==r.indexOf("scale")&&(c=[[l[0],0],[0,l[1]]],e=JXG.Math.matVecMult(c,e))}return e},getCSSTransformMatrix:function(e){var t,i,n,r,o,a,s,l,c=["transform","webkitTransform","MozTransform","msTransform","oTransform"];for(l=[[1,0,0],[0,1,0],[0,0,1]],o=c.length,t=0,n="";o>t;t++)if(JXG.exists(e.style[c[t]])){n=e.style[c[t]];break}if(""!=n&&(r=n.indexOf("("),r>0)){for(o=n.length,arrstr=n.substring(r+1,o-1),s=arrstr.split(","),i=0,a=s.length;a>i;i++)s[i]=parseFloat(s[i]);0==n.indexOf("matrix")?l=[[1,0,0],[s[4],s[0],s[1]],[s[5],s[2],s[3]]]:0==n.indexOf("translateX")?l[1][0]=s[0]:0==n.indexOf("translateY")?l[2][0]=s[0]:0==n.indexOf("translate")?(l[1][0]=s[0],l[2][0]=s[1]):0==n.indexOf("scaleX")?l[1][1]=s[0]:0==n.indexOf("scaleY")?l[2][2]=s[0]:0==n.indexOf("scale")&&(l[1][1]=s[0],l[2][2]=s[1])}return l},keys:function(e,t){var i,n=[];for(i in e)t?e.hasOwnProperty(i)&&n.push(i):n.push(i);return n},indexOf:function(e,t,i){var n,r=JXG.exists(i);if(Array.indexOf&&!r)return e.indexOf(t);for(n=0;e.length>n;n++)if(r&&e[n][i]===t||!r&&e[n]===t)return n;return-1},escapeHTML:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},unescapeHTML:function(e){return e.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")},clone:function(e){var t={};return t.prototype=e,t},cloneAndCopy:function(e,t){var i,n=function(){};n.prototype=e;for(i in t)n[i]=t[i];return n},deepCopy:function(e,t,i){var n,r,o,a;if(i=i||!1,"object"!=typeof e||null==e)return e;if(this.isArray(e))for(n=[],r=0;e.length>r;r++)o=e[r],n[r]="object"==typeof o?this.deepCopy(o):o;else{n={};for(r in e)a=i?r.toLowerCase():r,o=e[r],n[a]="object"==typeof o?this.deepCopy(o):o;for(r in t)a=i?r.toLowerCase():r,o=t[r],n[a]="object"==typeof o?JXG.isArray(o)||!JXG.exists(n[a])?this.deepCopy(o):this.deepCopy(n[a],o,i):o}return n},toJSON:function(e,t){var i,n;if(t=JXG.def(t,!1),window.JSON&&window.JSON.stringify&&!t)try{return i=JSON.stringify(e)}catch(r){}switch(typeof e){case"object":if(e){var o=[];if(e instanceof Array){for(var a=0;e.length>a;a++)o.push(JXG.toJSON(e[a],t));return"["+o.join(",")+"]"}for(var s in e){try{n=JXG.toJSON(e[s],t)}catch(r){n=""}t?o.push(s+":"+n):o.push('"'+s+'":'+n)}return"{"+o.join(",")+"} "}return"null";case"string":return"'"+e.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return new String(e)}},capitalize:function(e){return e.charAt(0).toUpperCase()+e.substring(1).toLowerCase()},timedChunk:function(e,t,i,n){var r=e.concat();setTimeout(function(){var o=+new Date;do t.call(i,r.shift());while(r.length>0&&300>+new Date-o);r.length>0?setTimeout(arguments.callee,1):n(e)},1)},trimNumber:function(e){return e=e.replace(/^0+/,""),e=e.replace(/0+$/,""),("."==e[e.length-1]||","==e[e.length-1])&&(e=e.slice(0,-1)),("."==e[0]||","==e[0])&&(e="0"+e),e},trim:function(e){return e=e.replace(/^\s+/,""),e=e.replace(/\s+$/,"")},evaluate:function(e){return JXG.isFunction(e)?e():e},eliminateDuplicates:function(e){var t,i=e.length,n=[],r={};for(t=0;i>t;t++)r[e[t]]=0;for(t in r)r.hasOwnProperty(t)&&n.push(t);return n},cmpArrays:function(e,t){var i;if(e===t)return!0;if(e.length!==t.length)return!1;for(i=0;e.length>i;i++)if(typeof e[i]!=typeof t[i]||e[i]!==t[i])return!1;return!0},trunc:function(e,t){return t=JXG.def(t,0),e=0==t?~~e:e.toFixed(t)},autoDigits:function(e){var t=Math.abs(e);return t=t>.1?e.toFixed(2):t>=.01?e.toFixed(4):t>=1e-4?e.toFixed(6):e},debug:function(e){var t;for(t=0;arguments.length>t;t++)e=arguments[t],window.console&&console.log?console.log(e):document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=e+"<br/>")},debugWST:function(e){var t;JXG.debug(e),window.console&&console.log&&(t=Error(),t&&t.stack&&(console.log("stacktrace"),console.log(t.stack.split("\n").slice(1).join("\n"))))},uniqueArray:function(e){var t,i,n,r=[];if(0===e.length)return[];for(n=JXG.isArray(e[0]),t=0;e.length>t;t++)for(i=t+1;e.length>i;i++)n&&JXG.cmpArrays(e[t],e[i])?e[t]=[]:!n&&e[t]===e[i]&&(e[t]="");for(i=0,t=0;e.length>t;t++)n||""===e[t]?n&&0!==e[t].length&&(r[i]=e[t].slice(0),i++):(r[i]=e[t],i++);return r},isInArray:function(e,t){var i;for(i=0;e.length>i;i++)if(e[i]==t)return!0;return!1},isArray2:function(e){return"object"==typeof e&&e instanceof Array},isObject:function(e){return"object"==typeof e&&e instanceof Object&&!(e instanceof Array)},isInObject:function(e,t){for(var i in e)if(e.hasOwnProperty(i)&&e[i]==t)return!0;return!1},collectionContains:function(e,t){return JXG.isArray2(e)?JXG.isInArray(e,t):JXG.isObject(e)?JXG.isInObject(e,t):e==t}}),"undefined"!=typeof window&&"undefined"!=typeof document&&JXG.addEvent(window,"load",function(){var e,t,i,n,r,o,a,s,l,c,u,d=document.getElementsByTagName("script");for(t=0;d.length>t;t++)if(e=d[t].getAttribute("type",!1),JXG.exists(e)&&("text/jessiescript"===e.toLowerCase()||"jessiescript"===e.toLowerCase()||"text/jessiecode"===e.toLowerCase()||"jessiecode"===e.toLowerCase())){if(o=d[t].getAttribute("width",!1)||"500px",a=d[t].getAttribute("height",!1)||"500px",s=d[t].getAttribute("boundingbox",!1)||"-5, 5, 5, -5",s=s.split(","),4!==s.length)s=[-5,5,5,-5];else for(i=0;s.length>i;i++)s[i]=parseFloat(s[i]);l=JXG.str2Bool(d[t].getAttribute("axis",!1)||"false"),c=JXG.str2Bool(d[t].getAttribute("grid",!1)||"false"),n=document.createElement("div"),n.setAttribute("id","jessiescript_autgen_jxg_"+t),n.setAttribute("style","width:"+o+"; height:"+a+"; float:left"),n.setAttribute("class","jxgbox");try{document.body.insertBefore(n,d[t])}catch(h){"undefined"!=typeof jQuery&&jQuery(n).insertBefore(d[t])}if(document.getElementById("jessiescript_autgen_jxg_"+t))if(r=JXG.JSXGraph.initBoard("jessiescript_autgen_jxg_"+t,{boundingbox:s,keepaspectratio:!0,grid:c,axis:l}),u=d[t].innerHTML,u=u.replace(/<!\[CDATA\[/g,"").replace(/\]\]>/g,""),d[t].innerHTML=u,e.toLowerCase().indexOf("script")>-1)r.construct(u);else try{r.jc.parse(u)}catch(h){JXG.debug(h)}else JXG.debug("JSXGraph: Apparently the div injection failed. Can't create a board, sorry.")}},window),JXG.EventEmitter={eventHandlers:{},triggerEventHandlers:function(e){var t,i,n,r,o,a,s=Array.prototype.slice.call(arguments,1);for(JXG.isArray(e)||(e=[e]),o=e.length,n=0;o>n;n++)if(r=e[n],JXG.isArray(this.eventHandlers[r]))for(a=this.eventHandlers[r].length,t=0;a>t;t++)i=this.eventHandlers[r][t],i.handler.apply(i.context,s);return this},on:function(e,t,i){return JXG.isArray(this.eventHandlers[e])||(this.eventHandlers[e]=[]),i=JXG.def(i,this),this.eventHandlers[e].push({handler:t,context:i}),this},off:function(e,t){var i;return e&&JXG.isArray(this.eventHandlers[e])?(t?(i=JXG.indexOf(this.eventHandlers[e],t,"handler"),i>-1&&this.eventHandlers[e].splice(i,1)):this.eventHandlers[e].length=0,this):this},eventify:function(e){e.eventHandlers={},e.on=this.on,e.off=this.off,e.triggerEventHandlers=this.triggerEventHandlers}},JXG.Math=function(e,t,i){var n=function(e){var t,n;return e.memo?e.memo:(t={},n=Array.prototype.join,e.memo=function(){var r=n.call(arguments);return t[r]!==i?t[r]:t[r]=e.apply(this,arguments)})};return{eps:1e-6,mod:function(e,i){return e-t.floor(e/i)*i},vector:function(e,i){var n,r;for(i=i||0,n=Array(t.ceil(e)),r=0;e>r;r++)n[r]=i;return n},matrix:function(e,i,n){var r,o,a;for(n=n||0,i=i||e,r=Array(t.ceil(e)),o=0;e>o;o++)for(r[o]=Array(t.ceil(i)),a=0;i>a;a++)r[o][a]=n;return r},identity:function(e,n){var r,o;for(n===i&&"number"!=typeof n&&(n=e),r=this.matrix(e,n),o=0;t.min(e,n)>o;o++)r[o][o]=1;return r},frustum:function(t,i,n,r,o,a){var s=e.Math.matrix(4,4);return s[0][0]=2*o/(i-t),s[0][1]=0,s[0][2]=(i+t)/(i-t),s[0][3]=0,s[1][0]=0,s[1][1]=2*o/(r-n),s[1][2]=(r+n)/(r-n),s[1][3]=0,s[2][0]=0,s[2][1]=0,s[2][2]=-(a+o)/(a-o),s[2][3]=-(2*a*o)/(a-o),s[3][0]=0,s[3][1]=0,s[3][2]=-1,s[3][3]=0,s},projection:function(e,i,n,r){var o=n*t.tan(e/2),a=o*i;return this.frustum(-a,a,-o,o,n,r)},matVecMult:function(e,t){var i,n,r,o=e.length,a=t.length,s=[];if(3===a)for(i=0;o>i;i++)s[i]=e[i][0]*t[0]+e[i][1]*t[1]+e[i][2]*t[2];else for(i=0;o>i;i++){for(n=0,r=0;a>r;r++)n+=e[i][r]*t[r];s[i]=n}return s},matMatMult:function(e,t){var i,n,r,o,a=e.length,s=a>0?t[0].length:0,l=t.length,c=this.matrix(a,s);for(i=0;a>i;i++)for(n=0;s>n;n++){for(r=0,o=0;l>o;o++)r+=e[i][o]*t[o][n];c[i][n]=r}return c},transpose:function(e){var t,i,n,r,o;for(r=e.length,o=e.length>0?e[0].length:0,t=this.matrix(o,r),i=0;o>i;i++)for(n=0;r>n;n++)t[i][n]=e[n][i];return t},inverse:function(i){var n,r,o,a,s,l,c,u=i.length,d=[],h=[],p=[];for(n=0;u>n;n++){for(d[n]=[],r=0;u>r;r++)d[n][r]=i[n][r];h[n]=n}for(r=0;u>r;r++){for(s=t.abs(d[r][r]),l=r,n=r+1;u>n;n++)t.abs(d[n][r])>s&&(s=t.abs(d[n][r]),l=n);if(e.Math.eps>=s)return!1;if(l>r){for(o=0;u>o;o++)c=d[r][o],d[r][o]=d[l][o],d[l][o]=c;c=h[r],h[r]=h[l],h[l]=c}for(a=1/d[r][r],n=0;u>n;n++)d[n][r]*=a;for(d[r][r]=a,o=0;u>o;o++)if(o!=r){for(n=0;u>n;n++)n!=r&&(d[n][o]-=d[n][r]*d[r][o]);d[r][o]=-a*d[r][o]}}for(n=0;u>n;n++){for(o=0;u>o;o++)p[h[o]]=d[n][o];for(o=0;u>o;o++)d[n][o]=p[o]}return d},innerProduct:function(e,t,n){var r,o=0;for((n===i||"number"!=typeof n)&&(n=e.length),r=0;n>r;r++)o+=e[r]*t[r];return o},crossProduct:function(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]},factorial:n(function(e){return 0>e?0/0:(e=t.floor(e),0===e||1===e?1:e*arguments.callee(e-1))}),binomial:n(function(e,i){var n,r;if(i>e||0>i)return 0/0;if(i=t.round(i),e=t.round(e),0===i||i===e)return 1;for(n=1,r=0;i>r;r++)n*=e-r,n/=r+1;return n}),cosh:function(e){return.5*(t.exp(e)+t.exp(-e))},sinh:function(e){return.5*(t.exp(e)-t.exp(-e))},pow:function(e,i){return 0===e?0===i?1:0:t.floor(i)===i?t.pow(e,i):e>0?t.exp(i*t.log(t.abs(e))):0/0},squampow:function(e,i){var n;if(t.floor(i)===i){for(n=1,0>i&&(e=1/e,i*=-1);0!=i;)1&i&&(n*=e),i>>=1,e*=e;return n}return this.pow(e,i)},normalize:function(e){var i,n,r=2*e[3],o=e[4]/r;return e[5]=o,e[6]=-e[1]/r,e[7]=-e[2]/r,1/0===o||isNaN(o)?(i=t.sqrt(e[1]*e[1]+e[2]*e[2]),e[0]/=i,e[1]/=i,e[2]/=i,e[3]=0,e[4]=1):t.abs(o)>=1?(e[0]=(e[6]*e[6]+e[7]*e[7]-o*o)/(2*o),e[1]=-e[6]/o,e[2]=-e[7]/o,e[3]=1/(2*o),e[4]=1):(n=0>=o?-1:1,e[0]=.5*n*(e[6]*e[6]+e[7]*e[7]-o*o),e[1]=-n*e[6],e[2]=-n*e[7],e[3]=n/2,e[4]=n*o),e},toGL:function(e){var t,i,n;if(t="undefined"!=typeof Float32Array?new Float32Array(16):Array(16),4!==e.length&&4!==e[0].length)return t;for(i=0;4>i;i++)for(n=0;4>n;n++)t[i+4*n]=e[i][n];return t}}}(JXG,Math),JXG.Math.Numerics=function(e,t){var i={rk4:{s:4,A:[[0,0,0,0],[.5,0,0,0],[0,.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,.5,.5,1]},heun:{s:2,A:[[0,0],[1,0]],b:[.5,.5],c:[0,1]},euler:{s:1,A:[[0]],b:[1],c:[0]}};return{Gauss:function(i,n){var r,o,a,s,l,c=e.Math.eps,u=i.length>0?i[0].length:0,d=function(e,t){var i=this[e];this[e]=this[t],this[t]=i};if(u!==n.length||u!==i.length)throw Error("JXG.Math.Numerics.Gauss: Dimensions don't match. A must be a square matrix and b must be of the same length as A.");for(r=Array(u),o=n.slice(0,u),a=0;u>a;a++)r[a]=i[a].slice(0,u);for(s=0;u>s;s++){for(a=u-1;a>s;a--)if(t.abs(r[a][s])>c)if(c>t.abs(r[s][s]))d.apply(r,[a,s]),d.apply(o,[a,s]);else for(r[a][s]/=r[s][s],o[a]-=r[a][s]*o[s],l=s+1;u>l;l++)r[a][l]-=r[a][s]*r[s][l];if(c>t.abs(r[s][s]))throw Error("JXG.Math.Numerics.Gauss(): The given matrix seems to be singular.")}return this.backwardSolve(r,o,!0),o},backwardSolve:function(e,t,i){var n,r,o,a,s;for(n=i?t:t.slice(0,t.length),r=e.length,o=e.length>0?e[0].length:0,a=r-1;a>=0;a--){for(s=o-1;s>a;s--)n[a]-=e[a][s]*n[s];n[a]/=e[a][a]}return n},gaussBareiss:function(i){var n,r,o,a,s,l,c,u,d,h=e.Math.eps;if(c=i.length,0>=c)return 0;for(c>i[0].length&&(c=i[0].length),u=Array(c),a=0;c>a;a++)u[a]=i[a].slice(0,c);for(r=1,o=1,n=0;c-1>n;n++){if(l=u[n][n],h>t.abs(l)){for(a=0;c>a&&!(t.abs(u[a][n])>=h);a++);if(a==c)return 0;for(s=n;c>s;s++)d=u[a][s],u[a][s]=u[n][s],u[n][s]=d;o=-o,l=u[n][n]}for(a=n+1;c>a;a++)for(s=n+1;c>s;s++)d=l*u[a][s]-u[a][n]*u[n][s],u[a][s]=d/r;r=l}return o*u[c-1][c-1]},det:function(e){var t=e.length;return 2==t&&2==e[0].length?e[0][0]*e[1][1]-e[1][0]*e[0][1]:this.gaussBareiss(e)},Jacobi:function(i){var n,r,o,a,s,l,c,u,d,h=e.Math.eps,p=0,f=i.length,g=[[0,0,0],[0,0,0],[0,0,0]],m=[[0,0,0],[0,0,0],[0,0,0]],b=0;for(n=0;f>n;n++){for(r=0;f>r;r++)g[n][r]=0,m[n][r]=i[n][r],p+=t.abs(m[n][r]);g[n][n]=1}if(1==f)return[m,g];if(0>=p)return[m,g];p/=f*f;do{for(u=0,d=0,r=1;f>r;r++)for(n=0;r>n;n++)if(a=t.abs(m[n][r]),a>d&&(d=a),u+=a,a>=h){for(a=.5*t.atan2(2*m[n][r],m[n][n]-m[r][r]),s=t.sin(a),l=t.cos(a),o=0;f>o;o++)c=m[o][n],m[o][n]=l*c+s*m[o][r],m[o][r]=-s*c+l*m[o][r],c=g[o][n],g[o][n]=l*c+s*g[o][r],g[o][r]=-s*c+l*g[o][r];for(m[n][n]=l*m[n][n]+s*m[r][n],m[r][r]=-s*m[n][r]+l*m[r][r],m[n][r]=0,o=0;f>o;o++)m[n][o]=m[o][n],m[r][o]=m[o][r]}b++}while(t.abs(u)/p>h&&2e3>b);return[m,g]},NewtonCotes:function(e,t,i){var n,r,o,a=0,s=i&&"number"==typeof i.number_of_nodes?i.number_of_nodes:28,l={trapez:!0,simpson:!0,milne:!0},c=i&&i.integration_type&&l.hasOwnProperty(i.integration_type)&&l[i.integration_type]?i.integration_type:"milne",u=(e[1]-e[0])/s;switch(c){case"trapez":for(a=.5*(t(e[0])+t(e[1])),n=e[0],r=0;s-1>r;r++)n+=u,a+=t(n);a*=u;break;case"simpson":if(s%2>0)throw Error("JSXGraph:  INT_SIMPSON requires config.number_of_nodes dividable by 2.");for(o=s/2,a=t(e[0])+t(e[1]),n=e[0],r=0;o-1>r;r++)n+=2*u,a+=2*t(n);for(n=e[0]-u,r=0;o>r;r++)n+=2*u,a+=4*t(n);a*=u/3;break;default:if(s%4>0)throw Error("JSXGraph: Error in INT_MILNE: config.number_of_nodes must be a multiple of 4");for(o=.25*s,a=7*(t(e[0])+t(e[1])),n=e[0],r=0;o-1>r;r++)n+=4*u,a+=14*t(n);for(n=e[0]-3*u,r=0;o>r;r++)n+=4*u,a+=32*(t(n)+t(n+2*u));for(n=e[0]-2*u,r=0;o>r;r++)n+=4*u,a+=12*t(n);a*=2*u/45}return a},I:function(e,t){return this.NewtonCotes(e,t,{number_of_nodes:16,integration_type:"milne"})},Newton:function(i,n,r){var o,a=0,s=e.Math.eps,l=i.apply(r,[n]),c=1;for(e.isArray(n)&&(n=n[0]);50>a&&t.abs(l)>s;)o=this.D(i,r)(n),c+=2,t.abs(o)>s?n-=l/o:n+=.2*t.random()-1,l=i.apply(r,[n]),c++,a++;return n},root:function(e,t,i){return this.fzero(e,t,i)},Neville:function(t){var i=[],n=function(n){return function(r,o){var a,s,l,c=e.Math.binomial,u=t.length,d=u-1,h=0,p=0;if(!o)for(l=1,a=0;u>a;a++)i[a]=c(d,a)*l,l*=-1;for(s=r,a=0;u>a;a++){if(0===s)return t[a][n]();l=i[a]/s,s--,h+=t[a][n]()*l,p+=l}return h/p}},r=n("X"),o=n("Y");return[r,o,0,function(){return t.length-1}]},splineDef:function(e,i){var n,r,o,a=t.min(e.length,i.length),s=[],l=[],c=[],u=[],d=[],h=[];if(2===a)return[0,0];for(r=0;a>r;r++)n={X:e[r],Y:i[r]},c.push(n);for(c.sort(function(e,t){return e.X-t.X}),r=0;a>r;r++)e[r]=c[r].X,i[r]=c[r].Y;for(r=0;a-1>r;r++)u.push(e[r+1]-e[r]);for(r=0;a-2>r;r++)d.push(6*(i[r+2]-i[r+1])/u[r+1]-6*(i[r+1]-i[r])/u[r]);for(s.push(2*(u[0]+u[1])),l.push(d[0]),r=0;a-3>r;r++)o=u[r+1]/s[r],s.push(2*(u[r+1]+u[r+2])-o*u[r+1]),l.push(d[r+1]-o*l[r]);for(h[a-3]=l[a-3]/s[a-3],r=a-4;r>=0;r--)h[r]=(l[r]-u[r+1]*h[r+1])/s[r];for(r=a-3;r>=0;r--)h[r+1]=h[r];return h[0]=0,h[a-1]=0,h},splineEval:function(i,n,r,o){var a,s,l,c,u,d,h,p=t.min(n.length,r.length),f=1,g=!1,m=[];for(e.isArray(i)?(f=i.length,g=!0):i=[i],a=0;f>a;a++){if(i[a]<n[0]||n[a]>n[p-1])return 0/0;for(s=1;p>s&&!(i[a]<=n[s]);s++);s--,l=r[s],c=(r[s+1]-r[s])/(n[s+1]-n[s])-(n[s+1]-n[s])/6*(o[s+1]+2*o[s]),u=o[s]/2,d=(o[s+1]-o[s])/(6*(n[s+1]-n[s])),h=i[a]-n[s],m.push(l+(c+(u+d*h)*h)*h)}return g?m:m[0]},generatePolynomialTerm:function(e,t,i,n){var r,o=[];for(r=t;r>=0;r--)o=o.concat(["(",e[r].toPrecision(n),")"]),r>1?o=o.concat(["*",i,"<sup>",r,"<","/sup> + "]):1===r&&(o=o.concat(["*",i," + "]));return o.join("")},lagrangePolynomial:function(e){var t=[],i=function(i,n){var r,o,a,s,l,c,u,d=0,h=0;if(a=e.length,!n){for(r=0;a>r;r++){for(t[r]=1,s=e[r].X(),o=0;a>o;o++)o!=r&&(t[r]*=s-e[o].X());t[r]=1/t[r]}for(c=[],u=0;a>u;u++)c.push([1])}for(r=0;a>r;r++){if(s=e[r].X(),i===s)return e[r].Y();l=t[r]/(i-s),h+=l,d+=l*e[r].Y()}return d/h};return i.getTerm=function(){return""},i},CatmullRomSpline:function(e){var i,n=[],r={},o={},a=function(a){return function(s,l){var c,u,d=e.length;if(2>d)return 0/0;if(!l)for(r[a]=function(){return 2*e[0][a]()-e[1][a]()},o[a]=function(){return 2*e[d-1][a]()-e[d-2][a]()},i=[r].concat(e,[o]),n[a]=[],c=0;d-1>c;c++)n[a][c]=[2*i[c+1][a](),-i[c][a]()+i[c+2][a](),2*i[c][a]()-5*i[c+1][a]()+4*i[c+2][a]()-i[c+3][a](),-i[c][a]()+3*i[c+1][a]()-3*i[c+2][a]()+i[c+3][a]()];return d+=2,isNaN(s)?0/0:0>s?i[1][a]():s>=d-3?i[d-2][a]():(c=t.floor(s),c==s?i[c][a]():(s-=c,u=n[a][c],.5*(((u[3]*s+u[2])*s+u[1])*s+u[0])))}};return[a("X"),a("Y"),0,function(){return e.length-1}]},regressionPolynomial:function(i,n,r){var o,a,s,l,c,u,d="";if(e.isPoint(i)&&"function"==typeof i.Value)a=function(){return i.Value()};else if(e.isFunction(i))a=i;else{if(!e.isNumber(i))throw Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+typeof i+"'.");a=function(){return i}}if(3==arguments.length&&e.isArray(n)&&e.isArray(r))c=0;else{if(!(2==arguments.length&&e.isArray(n)&&n.length>0&&e.isPoint(n[0])))throw Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.");c=1}return u=function(i,u){var h,p,f,g,m,b,v,y,x,C=n.length;if(x=t.floor(a()),!u){if(1===c)for(s=[],l=[],h=0;C>h;h++)s[h]=n[h].X(),l[h]=n[h].Y();if(0===c)for(s=[],l=[],h=0;C>h;h++)e.isFunction(n[h])?s.push(n[h]()):s.push(n[h]),e.isFunction(r[h])?l.push(r[h]()):l.push(r[h]);for(f=[],p=0;C>p;p++)f.push([1]);for(h=1;x>=h;h++)for(p=0;C>p;p++)f[p][h]=f[p][h-1]*s[p];m=l,g=e.Math.transpose(f),b=e.Math.matMatMult(g,f),v=e.Math.matVecMult(g,m),o=e.Math.Numerics.Gauss(b,v),d=e.Math.Numerics.generatePolynomialTerm(o,x,"x",3)}for(y=o[x],h=x-1;h>=0;h--)y=y*i+o[h];return y},u.getTerm=function(){return d},u},bezier:function(e){var i,n=function(n){return function(r,o){var a=3*t.floor(r),s=r%1,l=1-s;return o||(i=t.floor(e.length/3)),0>r?e[0][n]():r>=i?e[e.length-1][n]():isNaN(r)?0/0:l*l*(l*e[a][n]()+3*s*e[a+1][n]())+(3*l*e[a+2][n]()+s*e[a+3][n]())*s*s}};return[n("X"),n("Y"),0,function(){return t.floor(e.length/3)}]},bspline:function(e,i){var n,r=[],o=function(e,t){var i,n=[];for(i=0;e+t+1>i;i++)n[i]=t>i?0:e>=i?i-t+1:e-t+2;return n},a=function(e,t,i,n,r){var o,a,s,l,c,u=[];for(u[r]=e>=t[r]&&t[r+1]>e?1:0,o=2;n>=o;o++)for(a=r-o+1;r>=a;a++)s=r-o+1>=a||0>a?0:u[a],l=a>=r?0:u[a+1],c=t[a+o-1]-t[a],u[a]=0==c?0:(e-t[a])/c*s,c=t[a+o]-t[a+1],0!=c&&(u[a]+=(t[a+o]-e)/c*l);return u},s=function(s){return function(l){var c,u,d,h=e.length,p=h-1,f=i;if(0>=p)return 0/0;if(f>=p+2&&(f=p+1),0>=l)return e[0][s]();if(l>=p-f+2)return e[p][s]();for(n=o(p,f),d=t.floor(l)+f-1,r=a(l,n,p,f,d),c=0,u=d-f+1;d>=u;u++)h>u&&u>=0&&(c+=e[u][s]()*r[u]);return c}};return[s("X"),s("Y"),0,function(){return e.length-1}]},D:function(t,i){var n=1e-5,r=1/(2*n);return 1==arguments.length||arguments.length>1&&!e.exists(arguments[1])?function(e,i){return(t(e+n,i)-t(e-n,i))*r}:function(e,o){return(t.apply(i,[e+n,o])-t.apply(i,[e-n,o]))*r}},riemann:function(e,i,n,r,o){var a,s,l,c,u,d,h=[],p=[],f=0,g=r,m=0;if(i=t.round(i),h[f]=g,p[f]=0,i>0)for(s=(o-r)/i,d=.01*s,a=0;i>a;a++){if("right"===n)l=e(g+s);else if("middle"===n)l=e(g+.5*s);else if("left"===n||"trapezodial"===n)l=e(g);else if("lower"===n)for(l=e(g),c=g+d;g+s>=c;c+=d)u=e(c),l>u&&(l=u);else if("upper"===n)for(l=e(g),c=g+d;g+s>=c;c+=d)u=e(c),u>l&&(l=u);else l=e(g+s*t.random());f++,h[f]=g,p[f]=l,f++,g+=s,"trapezodial"===n&&(l=e(g)),h[f]=g,p[f]=l,f++,h[f]=g,p[f]=0,m+=l*s}return[h,p,m]},riemannsum:function(e,i,n,r,o){var a,s,l,c,u,d,h=0,p=r;if(i=t.floor(i),i>0)for(s=(o-r)/i,d=.01*s,a=0;i>a;a++){if("right"===n)l=e(p+s);else if("middle"===n)l=e(p+.5*s);else if("trapezodial"===n)l=.5*(e(p+s)+e(p));else if("left"===n)l=e(p);else if("lower"===n)for(l=e(p),c=p+d;p+s>=c;c+=d)u=e(c),l>u&&(l=u);else if("upper"===n)for(l=e(p),c=p+d;p+s>=c;c+=d)u=e(c),u>l&&(l=u);else l=e(p+s*t.random());h+=s*l,p+=s}return h},rungeKutta:function(t,n,r,o,a){var s,l,c,u,d,h,p=[],f=[],g=(r[1]-r[0])/o,m=r[0],b=n.length,v=[],y=0;for(e.isString(t)&&(t=i[t]||i.euler),h=t.s,s=0;b>s;s++)p[s]=n[s];for(l=0;o>l;l++){for(v[y]=[],s=0;b>s;s++)v[y][s]=p[s];for(y++,u=[],c=0;h>c;c++){for(s=0;b>s;s++)f[s]=0;for(d=0;c>d;d++)for(s=0;b>s;s++)f[s]+=t.A[c][d]*g*u[d][s];for(s=0;b>s;s++)f[s]+=p[s];u.push(a(m+t.c[c]*g,f))}for(s=0;b>s;s++)f[s]=0;for(d=0;h>d;d++)for(s=0;b>s;s++)f[s]+=t.b[d]*u[d][s];for(s=0;b>s;s++)p[s]=p[s]+g*f[s];m+=g}return v},maxIterationsRoot:80,maxIterationsMinimize:500,fzero:function(i,n,r){var o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w,k,_,E=e.Math.eps,T=this.maxIterationsRoot,S=0,A=0,P=E;if(e.isArray(n)){if(2>n.length)throw Error("JXG.Math.Numerics.fzero: length of array x0 has to be at least two.");o=n[0],l=i.apply(r,[o]),A++,a=n[1],c=i.apply(r,[a]),A++}else{for(o=n,l=i.apply(r,[o]),A++,d=0==o?1:o,h=[.9*d,1.1*d,d-1,d+1,.5*d,1.5*d,-d,2*d,-10*d,10*d],f=h.length,p=0;f>p&&(a=h[p],c=i.apply(r,[a]),A++,!(0>=l*c));p++);o>a&&(g=o,o=a,a=g,m=l,l=c,c=m)}if(l*c>0)return e.isArray(n)?this.fminbr(i,[o,a],r):this.Newton(i,o,r);for(s=o,u=l;T>S;){if(b=a-o,t.abs(u)<t.abs(c)&&(o=a,a=s,s=o,l=c,c=u,u=l),v=2*P*t.abs(a)+.5*E,C=.5*(s-a),v>=t.abs(C)&&P>=t.abs(c))return a;t.abs(b)>=v&&t.abs(l)>t.abs(c)&&(k=s-a,o==s?(w=c/l,y=k*w,x=1-w):(x=l/u,w=c/u,_=c/l,y=_*(k*x*(x-w)-(a-o)*(w-1)),x=(x-1)*(w-1)*(_-1)),y>0?x=-x:y=-y,.75*k*x-.5*t.abs(v*x)>y&&t.abs(.5*b*x)>y&&(C=y/x)),v>t.abs(C)&&(C=C>0?v:-v),o=a,l=c,a+=C,c=i.apply(r,[a]),A++,(c>0&&u>0||0>c&&0>u)&&(s=o,u=l),S++}return a},fminbr:function(i,n,r){var o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C=.5*(3-t.sqrt(5)),w=e.Math.eps,k=t.sqrt(e.Math.eps),_=this.maxIterationsMinimize,E=0,T=0;if(!e.isArray(n)||2>n.length)throw Error("JXG.Math.Numerics.fminbr: length of array x0 has to be at least two.");for(o=n[0],a=n[1],l=o+C*(a-o),d=i.apply(r,[l]),T++,s=l,c=l,u=d,h=d;_>E;){if(p=a-o,f=.5*(o+a),g=k*t.abs(s)+w/3,2*g>=t.abs(s-f)+.5*p)return s;m=C*(f>s?a-s:o-s),t.abs(s-c)>=g&&(y=(s-c)*(u-d),v=(s-l)*(u-h),b=(s-l)*v-(s-c)*y,v=2*(v-y),v>0?b=-b:v=-v,t.abs(b)<t.abs(m*v)&&b>v*(o-s+2*g)&&v*(a-s-2*g)>b&&(m=b/v)),g>t.abs(m)&&(m=m>0?g:-g),y=s+m,x=i.apply(r,[y]),T++,u>=x?(s>y?a=s:o=s,l=c,c=s,s=y,d=h,h=u,u=x):(s>y?o=y:a=y,h>=x||c==s?(l=c,c=y,d=h,h=x):(d>=x||l==s||l==c)&&(l=y,d=x)),E++}return s},reuleauxPolygon:function(i,n){var r,o=2*t.PI,a=o/n,s=(n-1)/2,l=0,c=function(c,u){return function(d,h){h||(l=i[0].Dist(i[s]),r=e.Math.Geometry.rad([i[0].X()+1,i[0].Y()],i[0],i[s%n]));var p=(d%o+o)%o,f=t.floor(p/a)%n;return isNaN(f)?f:(p=.5*p+.5*f*a+r,i[f][c]()+l*t[u](p))}};return[c("X","cos"),c("Y","sin"),0,2*t.PI]},RamerDouglasPeuker:function(i,n){var r,o,a,s=[],l=function(e,t,i,n,r){var o=c(e,t,i);o[0]>n?(l(e,t,o[1],n,r),l(e,o[1],i,n,r)):r.push(e[i])},c=function(i,n,r){var o,a,s,l,c,u,d,h,p,f,g,m=0,b=n;if(2>r-n)return[-1,0];if(s=i[n].scrCoords,l=i[r].scrCoords,isNaN(s[1]+s[2]+l[1]+l[2]))return[0/0,r];for(a=n+1;r>a;a++)c=i[a].scrCoords,u=c[1]-s[1],d=c[2]-s[2],h=l[1]-s[1],p=l[2]-s[2],f=h*h+p*p,f>=e.Math.eps?(g=(u*h+d*p)/f,0>g?g=0:g>1&&(g=1),u-=g*h,d-=g*p,o=u*u+d*d):(g=0,o=u*u+d*d),o>m&&(m=o,b=a);return[t.sqrt(m),b]};for(a=i.length,r=0;a>r&&isNaN(i[r].scrCoords[1]+i[r].scrCoords[2]);)r++;
for(o=a-1;o>r&&isNaN(i[o].scrCoords[1]+i[o].scrCoords[2]);)o--;return r>o||r==a||(s[0]=i[r],l(i,r,o,n,s)),s}}}(JXG,Math),JXG.Math.Statistics={sum:function(e){var t,i=e.length,n=0;for(t=0;i>t;t++)n+=e[t];return n},prod:function(e){var t,i=e.length,n=1;for(t=0;i>t;t++)n*=e[t];return n},mean:function(e){return e.length>0?this.sum(e)/e.length:0},median:function(e){var t,i;return e.length>0?(t=e.slice(0),t.sort(function(e,t){return e-t}),i=t.length,1==i%2?t[parseInt(.5*i)]:.5*(t[.5*i-1]+t[.5*i])):0},variance:function(e){var t,i,n,r=e.length;if(r>1){for(t=this.mean(e),i=0,n=0;r>n;n++)i+=(e[n]-t)*(e[n]-t);return i/(e.length-1)}return 0},sd:function(e){return Math.sqrt(this.variance(e))},weightedMean:function(e,t){if(e.length!=t.length)throw Error("JSXGraph error (Math.Statistics.weightedMean): Array dimension mismatch.");return e.length>0?this.mean(this.multiply(e,t)):0},max:function(e){return Math.max.apply(this,e)},min:function(e){return Math.min.apply(this,e)},range:function(e){return[this.min(e),this.max(e)]},abs:function(e){var t,i,n;if(JXG.isArray(e))for(i=e.length,n=[],t=0;i>t;t++)n[t]=Math.abs(e[t]);else n=Math.abs(e);return n},add:function(e,t){var i,n,r=[];if(JXG.isArray(e)&&JXG.isNumber(t))for(n=e.length,i=0;n>i;i++)r[i]=e[i]+t;else if(JXG.isNumber(e)&&JXG.isArray(t))for(n=t.length,i=0;n>i;i++)r[i]=e+t[i];else if(JXG.isArray(e)&&JXG.isArray(t))for(n=Math.min(e.length,t.length),i=0;n>i;i++)r[i]=e[i]+t[i];else r=e+t;return r},div:function(e,t){var i,n,r=[];if(JXG.isArray(e)&&JXG.isNumber(t))for(n=e.length,i=0;n>i;i++)r[i]=e[i]/t;else if(JXG.isNumber(e)&&JXG.isArray(t))for(n=t.length,i=0;n>i;i++)r[i]=e/t[i];else if(JXG.isArray(e)&&JXG.isArray(t))for(n=Math.min(e.length,t.length),i=0;n>i;i++)r[i]=e[i]/t[i];else r=e/t;return r},divide:JXG.shortcut(JXG.Math.Statistics,"div"),mod:function(e,t,i){var n,r,o=[],a=function(e,t){return e%t};if(i=JXG.def(i,!1),i&&(a=JXG.Math.mod),JXG.isArray(e)&&JXG.isNumber(t))for(r=e.length,n=0;r>n;n++)o[n]=a(e[n],t);else if(JXG.isNumber(e)&&JXG.isArray(t))for(r=t.length,n=0;r>n;n++)o[n]=a(e,t[n]);else if(JXG.isArray(e)&&JXG.isArray(t))for(r=Math.min(e.length,t.length),n=0;r>n;n++)o[n]=a(e[n],t[n]);else o=a(e,t);return o},multiply:function(e,t){var i,n,r=[];if(JXG.isArray(e)&&JXG.isNumber(t))for(n=e.length,i=0;n>i;i++)r[i]=e[i]*t;else if(JXG.isNumber(e)&&JXG.isArray(t))for(n=t.length,i=0;n>i;i++)r[i]=e*t[i];else if(JXG.isArray(e)&&JXG.isArray(t))for(n=Math.min(e.length,t.length),i=0;n>i;i++)r[i]=e[i]*t[i];else r=e*t;return r},subtract:function(e,t){var i,n,r=[];if(JXG.isArray(e)&&JXG.isNumber(t))for(n=e.length,i=0;n>i;i++)r[i]=e[i]-t;else if(JXG.isNumber(e)&&JXG.isArray(t))for(n=t.length,i=0;n>i;i++)r[i]=e-t[i];else if(JXG.isArray(e)&&JXG.isArray(t))for(n=Math.min(e.length,t.length),i=0;n>i;i++)r[i]=e[i]-t[i];else r=e-t;return r}},JXG.Math.Symbolic=function(e,t){return{generateSymbolicCoordinatesPartial:function(t,i,n,r){var o,a,s,l=function(e){var t;return t="underscore"===r?""+n+"_{"+e+"}":"brace"==r?""+n+"["+e+"]":""+n+e},c=i.ancestors,u=0;t.listOfFreePoints=[],t.listOfDependantPoints=[];for(a in c)if(o=0,e.isPoint(c[a])){for(s in c[a].ancestors)o++;0===o?(c[a].symbolic.x=c[a].coords.usrCoords[1],c[a].symbolic.y=c[a].coords.usrCoords[2],t.listOfFreePoints.push(c[a])):(u++,c[a].symbolic.x=l(u),u++,c[a].symbolic.y=l(u),t.listOfDependantPoints.push(c[a]))}return e.isPoint(i)&&(i.symbolic.x="x",i.symbolic.y="y"),u},clearSymbolicCoordinates:function(t){var i=function(t){var i,n=t&&t.length||0;for(i=0;n>i;i++)e.isPoint(t[i])&&(t[i].symbolic.x="",t[i].symbolic.y="")};i(t.listOfFreePoints),i(t.listOfDependantPoints),delete t.listOfFreePoints,delete t.listOfDependantPoints},generatePolynomials:function(t,i,n){var r,o,a,s,l=i.ancestors,c=[],u=[];n&&this.generateSymbolicCoordinatesPartial(t,i,"u","brace"),l[i.id]=i;for(o in l)if(r=0,c=[],e.isPoint(l[o])){for(a in l[o].ancestors)r++;if(r>0)for(c=l[o].generatePolynomial(),s=0;c.length>s;s++)u.push(c[s])}return n&&this.clearSymbolicCoordinates(t),u},geometricLocusByGroebnerBase:function(i,n){var r,o,a,s,l,c,u,d,h,p,f,g,m,b=this.generateSymbolicCoordinatesPartial(i,n,"u","brace"),v={},y=new e.Coords(e.COORDS_BY_USR,[0,0],i),x=new e.Coords(e.COORDS_BY_USR,[i.canvasWidth,i.canvasHeight],i),C=1,w=0,k=0,_=0,E=function(e,t){var i;for(i=0;t.length>i;i++)if(t[i].id===e)return!0;return!1},T=i.options.locus;if(e.Server.modules.geoloci===t&&e.Server.loadModule("geoloci"),e.Server.modules.geoloci===t)throw Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.");if(p=y.usrCoords[1],f=x.usrCoords[1],g=x.usrCoords[2],m=y.usrCoords[2],T.translateToOrigin&&i.listOfFreePoints.length>0){for(s=T.toOrigin!==t&&null!=T.toOrigin&&E(T.toOrigin.id,i.listOfFreePoints)?T.toOrigin:i.listOfFreePoints[0],w=s.symbolic.x,k=s.symbolic.y,c=0;i.listOfFreePoints.length>c;c++)i.listOfFreePoints[c].symbolic.x-=w,i.listOfFreePoints[c].symbolic.y-=k;if(p-=w,f-=w,g-=k,m-=k,T.translateTo10&&i.listOfFreePoints.length>1){for(l=T.to10!==t&&null!=T.to10&&T.to10.id!=T.toOrigin.id&&E(T.to10.id,i.listOfFreePoints)?T.to10:i.listOfFreePoints[0].id==s.id?i.listOfFreePoints[1]:i.listOfFreePoints[0],_=e.Math.Geometry.rad([1,0],[0,0],[l.symbolic.x,l.symbolic.y]),u=Math.cos(-_),d=Math.sin(-_),c=0;i.listOfFreePoints.length>c;c++)h=i.listOfFreePoints[c].symbolic.x,i.listOfFreePoints[c].symbolic.x=u*i.listOfFreePoints[c].symbolic.x-d*i.listOfFreePoints[c].symbolic.y,i.listOfFreePoints[c].symbolic.y=d*h+u*i.listOfFreePoints[c].symbolic.y;if(l.symbolic.y=0,h=p,p=u*p-d*g,g=d*h+u*g,h=f,f=u*f-d*m,m=d*h+u*m,T.stretch&&Math.abs(l.symbolic.x)>e.Math.eps){for(C=l.symbolic.x,c=0;i.listOfFreePoints.length>c;c++)i.listOfFreePoints[c].symbolic.x/=C,i.listOfFreePoints[c].symbolic.y/=C;for(c in i.objects)i.objects[c].elementClass==e.OBJECT_CLASS_CIRCLE&&"pointRadius"==i.objects[c].method&&(v[c]=i.objects[c].radius,i.objects[c].radius/=C);p/=C,f/=C,g/=C,m/=C,l.symbolic.x=1}}for(c=0;i.listOfFreePoints.length>c;c++)h=i.listOfFreePoints[c].symbolic.x,Math.abs(h)<e.Math.eps&&(i.listOfFreePoints[c].symbolic.x=0),Math.abs(h-Math.round(h))<e.Math.eps&&(i.listOfFreePoints[c].symbolic.x=Math.round(h)),h=i.listOfFreePoints[c].symbolic.y,Math.abs(h)<e.Math.eps&&(i.listOfFreePoints[c].symbolic.y=0),Math.abs(h-Math.round(h))<e.Math.eps&&(i.listOfFreePoints[c].symbolic.y=Math.round(h))}r=this.generatePolynomials(i,n),o=r.join(","),this.cbp=function(e){a=e},this.cb=e.bind(this.cbp,this),e.Server.modules.geoloci.lociCoCoA(p,f,g,m,b,o,C,_,w,k,this.cb,!0),this.clearSymbolicCoordinates(i);for(c in v)i.objects[c].radius=v[c];return a}}}(JXG),JXG.Math.Geometry={},JXG.extend(JXG.Math.Geometry,{angle:function(e,t,i){var n,r,o,a,s=[],l=[],c=[];return null==e.coords?(s[0]=e[0],s[1]=e[1]):(s[0]=e.coords.usrCoords[1],s[1]=e.coords.usrCoords[2]),null==t.coords?(l[0]=t[0],l[1]=t[1]):(l[0]=t.coords.usrCoords[1],l[1]=t.coords.usrCoords[2]),null==i.coords?(c[0]=i[0],c[1]=i[1]):(c[0]=i.coords.usrCoords[1],c[1]=i.coords.usrCoords[2]),n=s[0]-l[0],r=s[1]-l[1],o=c[0]-l[0],a=c[1]-l[1],Math.atan2(n*a-r*o,n*o+r*a)},trueAngle:function(e,t,i){return 57.29577951308232*this.rad(e,t,i)},rad:function(e,t,i){var n,r,o,a,s,l,c;return null==e.coords?(n=e[0],r=e[1]):(n=e.coords.usrCoords[1],r=e.coords.usrCoords[2]),null==t.coords?(o=t[0],a=t[1]):(o=t.coords.usrCoords[1],a=t.coords.usrCoords[2]),null==i.coords?(s=i[0],l=i[1]):(s=i.coords.usrCoords[1],l=i.coords.usrCoords[2]),c=Math.atan2(l-a,s-o)-Math.atan2(r-a,n-o),0>c&&(c+=6.283185307179586),c},angleBisector:function(e,t,i,n){var r,o,a,s=e.coords.usrCoords,l=t.coords.usrCoords,c=i.coords.usrCoords,u=s[1]-l[1],d=s[2]-l[2],h=Math.sqrt(u*u+d*d);return JXG.exists(n)||(n=e.board),u/=h,d/=h,r=Math.acos(u),0>d&&(r*=-1),0>r&&(r+=2*Math.PI),u=c[1]-l[1],d=c[2]-l[2],h=Math.sqrt(u*u+d*d),u/=h,d/=h,o=Math.acos(u),0>d&&(o*=-1),0>o&&(o+=2*Math.PI),a=.5*(r+o),r>o&&(a+=Math.PI),u=Math.cos(a)+l[1],d=Math.sin(a)+l[2],new JXG.Coords(JXG.COORDS_BY_USER,[u,d],n)},reflection:function(e,t,i){var n,r,o,a,s,l,c,u=t.coords.usrCoords,d=e.point1.coords.usrCoords,h=e.point2.coords.usrCoords;return JXG.exists(i)||(i=t.board),s=h[1]-d[1],l=h[2]-d[2],n=u[1]-d[1],r=u[2]-d[2],c=(s*r-l*n)/(s*s+l*l),o=u[1]+2*c*l,a=u[2]-2*c*s,new JXG.Coords(JXG.COORDS_BY_USER,[o,a],i)},rotation:function(e,t,i,n){var r,o,a,s,l,c,u=t.coords.usrCoords,d=e.coords.usrCoords;return JXG.exists(n)||(n=t.board),r=u[1]-d[1],o=u[2]-d[2],a=Math.cos(i),s=Math.sin(i),l=r*a-o*s+d[1],c=r*s+o*a+d[2],new JXG.Coords(JXG.COORDS_BY_USER,[l,c],n)},perpendicular:function(e,t,i){var n,r,o,a,s,l,c,u,d=e.point1.coords.usrCoords,h=e.point2.coords.usrCoords,p=t.coords.usrCoords;return JXG.exists(i)||(i=t.board),t==e.point1?(n=d[1]+h[2]-d[2],r=d[2]-h[1]+d[1],o=!0):t==e.point2?(n=h[1]+d[2]-h[2],r=h[2]-d[1]+h[1],o=!1):Math.abs(d[1]-h[1])>JXG.Math.eps&&Math.abs(p[2]-(d[2]-h[2])*(p[1]-d[1])/(d[1]-h[1])-d[2])<JXG.Math.eps||Math.abs(d[1]-h[1])<=JXG.Math.eps&&Math.abs(d[1]-p[1])<JXG.Math.eps?(n=p[1]+h[2]-p[2],r=p[2]-h[1]+p[1],o=!0,Math.abs(n-p[1])<JXG.Math.eps&&Math.abs(r-p[2])<JXG.Math.eps&&(n=p[1]+d[2]-p[2],r=p[2]-d[1]+p[1],o=!1)):(a=d[2]-h[2],s=d[1]-h[1],l=h[1]*a-h[2]*s,c=p[1]*s+p[2]*a,u=a*a+s*s,Math.abs(u)<JXG.Math.eps&&(u=JXG.Math.eps),n=(l*a+c*s)/u,r=(c*a-l*s)/u,o=!0),[new JXG.Coords(JXG.COORDS_BY_USER,[n,r],i),o]},circumcenterMidpoint:JXG.shortcut(JXG.Math.Geometry,"circumcenter"),circumcenter:function(e,t,i,n){var r,o,a,s,l=e.coords.usrCoords,c=t.coords.usrCoords,u=i.coords.usrCoords;return JXG.exists(n)||(n=e.board),r=[c[0]-l[0],-c[2]+l[2],c[1]-l[1]],o=[.5*(l[0]+c[0]),.5*(l[1]+c[1]),.5*(l[2]+c[2])],a=JXG.Math.crossProduct(r,o),r=[u[0]-c[0],-u[2]+c[2],u[1]-c[1]],o=[.5*(c[0]+u[0]),.5*(c[1]+u[1]),.5*(c[2]+u[2])],s=JXG.Math.crossProduct(r,o),new JXG.Coords(JXG.COORDS_BY_USER,JXG.Math.crossProduct(a,s),n)},distance:function(e,t){var i,n,r=0;if(e.length!=t.length)return 0/0;for(n=e.length,i=0;n>i;i++)r+=(e[i]-t[i])*(e[i]-t[i]);return Math.sqrt(r)},affineDistance:function(e,t){var i;return e.length!=t.length?0/0:(i=this.distance(e,t),i>JXG.Math.eps&&(Math.abs(e[0])<JXG.Math.eps||Math.abs(t[0])<JXG.Math.eps)?1/0:i)},calcStraight:function(e,t,i,n){var r,o,a,s,l,c,u,d,h,p,f,g;if(null==n&&(n=10),l=e.visProp.straightfirst,c=e.visProp.straightlast,Math.abs(t.scrCoords[0])<JXG.Math.eps&&(l=!0),Math.abs(i.scrCoords[0])<JXG.Math.eps&&(c=!0),(l||c)&&(u=[],u[0]=e.stdform[0]-e.stdform[1]*e.board.origin.scrCoords[1]/e.board.unitX+e.stdform[2]*e.board.origin.scrCoords[2]/e.board.unitY,u[1]=e.stdform[1]/e.board.unitX,u[2]=e.stdform[2]/-e.board.unitY,!isNaN(u[0]+u[1]+u[2]))){for(d=[],d[0]=JXG.Math.crossProduct(u,[n,0,1]),d[1]=JXG.Math.crossProduct(u,[n,1,0]),d[2]=JXG.Math.crossProduct(u,[-n-e.board.canvasHeight,0,1]),d[3]=JXG.Math.crossProduct(u,[-n-e.board.canvasWidth,1,0]),h=0;4>h;h++)if(Math.abs(d[h][0])>JXG.Math.eps){for(p=2;p>0;p--)d[h][p]/=d[h][0];d[h][0]=1}if(r=!1,o=!1,!l&&Math.abs(t.usrCoords[0])>=JXG.Math.eps&&t.scrCoords[1]>=0&&t.scrCoords[1]<=e.board.canvasWidth&&t.scrCoords[2]>=0&&t.scrCoords[2]<=e.board.canvasHeight&&(r=!0),!c&&Math.abs(i.usrCoords[0])>=JXG.Math.eps&&i.scrCoords[1]>=0&&i.scrCoords[1]<=e.board.canvasWidth&&i.scrCoords[2]>=0&&i.scrCoords[2]<=e.board.canvasHeight&&(o=!0),Math.abs(d[1][0])<JXG.Math.eps?(a=d[0],s=d[2]):Math.abs(d[0][0])<JXG.Math.eps?(a=d[1],s=d[3]):0>d[1][2]?(a=d[0],s=d[3][2]>e.board.canvasHeight?d[2]:d[3]):d[1][2]>e.board.canvasHeight?(a=d[2],s=0>d[3][2]?d[0]:d[3]):(a=d[1],s=0>d[3][2]?d[0]:d[3][2]>e.board.canvasHeight?d[2]:d[3]),a=new JXG.Coords(JXG.COORDS_BY_SCREEN,a.slice(1),e.board),s=new JXG.Coords(JXG.COORDS_BY_SCREEN,s.slice(1),e.board),!r&&!o){if(!l&&c&&!this.isSameDirection(t,i,a)&&!this.isSameDirection(t,i,s))return;if(l&&!c&&!this.isSameDirection(i,t,a)&&!this.isSameDirection(i,t,s))return}r?o||(g=this.isSameDir(t,i,a,s)?s:a):o?f=this.isSameDir(t,i,a,s)?a:s:this.isSameDir(t,i,a,s)?(f=a,g=s):(g=a,f=s),f&&t.setCoordinates(JXG.COORDS_BY_USER,f.usrCoords.slice(1)),g&&i.setCoordinates(JXG.COORDS_BY_USER,g.usrCoords.slice(1))}},isSameDir:function(e,t,i,n){var r=t.usrCoords[1]-e.usrCoords[1],o=t.usrCoords[2]-e.usrCoords[2],a=n.usrCoords[1]-i.usrCoords[1],s=n.usrCoords[2]-i.usrCoords[2];return Math.abs(t.usrCoords[0])<JXG.Math.eps&&(r=t.usrCoords[1],o=t.usrCoords[2]),Math.abs(e.usrCoords[0])<JXG.Math.eps&&(r=-e.usrCoords[1],o=-e.usrCoords[2]),r*a+o*s>=0},isSameDirection:function(e,t,i){var n,r,o,a,s=!1;return n=t.usrCoords[1]-e.usrCoords[1],r=t.usrCoords[2]-e.usrCoords[2],o=i.usrCoords[1]-e.usrCoords[1],a=i.usrCoords[2]-e.usrCoords[2],Math.abs(n)<JXG.Math.eps&&(n=0),Math.abs(r)<JXG.Math.eps&&(r=0),Math.abs(o)<JXG.Math.eps&&(o=0),Math.abs(a)<JXG.Math.eps&&(a=0),n>=0&&o>=0?(r>=0&&a>=0||0>=r&&0>=a)&&(s=!0):0>=n&&0>=o&&(r>=0&&a>=0||0>=r&&0>=a)&&(s=!0),s},intersectLineLine:function(e,t,i){var n,r,o,a,s,l=e.point1.coords.usrCoords,c=e.point2.coords.usrCoords,u=t.point1.coords.usrCoords,d=t.point2.coords.usrCoords;return JXG.exists(i)||(i=e.board),n=l[1]*c[2]-l[2]*c[1],r=u[1]*d[2]-u[2]*d[1],o=(c[2]-l[2])*(u[1]-d[1])-(l[1]-c[1])*(d[2]-u[2]),Math.abs(o)<JXG.Math.eps&&(o=JXG.Math.eps),a=(n*(u[1]-d[1])-r*(l[1]-c[1]))/o,s=(r*(c[2]-l[2])-n*(d[2]-u[2]))/o,new JXG.Coords(JXG.COORDS_BY_USER,[a,s],i)},intersectCircleLine:function(e,t,i){var n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w=t.point1.coords.usrCoords,k=t.point2.coords.usrCoords,_=e.center.coords.usrCoords;return JXG.exists(i)||(i=t.board),n=t.point1.Dist(t.point2),n>0?(r=e.center.Dist(t.point1),o=e.center.Dist(t.point2),a=(r*r+n*n-o*o)/(2*n),s=r*r-a*a,s=0>s?0:s,l=Math.sqrt(s),c=e.Radius(),u=Math.sqrt(c*c-l*l),d=k[1]-w[1],h=k[2]-w[2],p=_[1]+l/n*h,f=_[2]-l/n*d,r=k[1]*h-k[2]*d,o=p*d+f*h,g=h*h+d*d,Math.abs(g)<JXG.Math.eps&&(g=JXG.Math.eps),m=(r*h+o*d)/g,b=(o*h-r*d)/g,v=u/n,y=new JXG.Coords(JXG.COORDS_BY_USER,[m+v*d,b+v*h],i),x=new JXG.Coords(JXG.COORDS_BY_USER,[m-v*d,b-v*h],i),C=e.center.coords.distance(JXG.COORDS_BY_USER,y),C-1>c||isNaN(C)?[0]:[2,y,x]):[0]},intersectCircleCircle:function(e,t,i){var n,r,o,a,s,l,c,u={},d=e.Radius(),h=t.Radius(),p=e.center.coords.usrCoords,f=t.center.coords.usrCoords;return JXG.exists(i)||(i=e.board),n=d+h,r=Math.abs(d-h),o=e.center.coords.distance(JXG.COORDS_BY_USER,t.center.coords),o>n?[0]:r>o?[0]:0==o?[0]:(u[0]=1,a=f[1]-p[1],s=f[2]-p[2],l=(o*o-h*h+d*d)/(2*o),c=Math.sqrt(d*d-l*l),u[1]=new JXG.Coords(JXG.COORDS_BY_USER,[p[1]+l/o*a+c/o*s,p[2]+l/o*s-c/o*a],i),u[2]=new JXG.Coords(JXG.COORDS_BY_USER,[p[1]+l/o*a-c/o*s,p[2]+l/o*s+c/o*a],i),u)},meet:function(e,t,i,n){var r=JXG.Math.eps;return r>Math.abs(e[3])&&r>Math.abs(t[3])?this.meetLineLine(e,t,i,n):Math.abs(e[3])>=r&&r>Math.abs(t[3])?this.meetLineCircle(t,e,i,n):r>Math.abs(e[3])&&Math.abs(t[3])>=r?this.meetLineCircle(e,t,i,n):this.meetCircleCircle(e,t,i,n)},meetLineLine:function(e,t,i,n){var r=JXG.Math.crossProduct(e,t);return Math.abs(r[0])>JXG.Math.eps&&(r[1]/=r[0],r[2]/=r[0],r[0]=1),new JXG.Coords(JXG.COORDS_BY_USER,r,n)},meetLineCircle:function(e,t,i,n){var r,o,a,s,l,c,u,d,h,p;return t[4]<JXG.Math.eps?Math.abs(JXG.Math.innerProduct([1,t[6],t[7]],e,3))<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,t.slice(6,8),n):new JXG.Coords(JXG.COORDS_BY_USER,[0/0,0/0],n):(a=t[0],o=t.slice(1,3),r=t[3],s=e[0],l=e.slice(1,3),c=r,u=o[0]*l[1]-o[1]*l[0],d=r*s*s-(o[0]*l[0]+o[1]*l[1])*s+a,h=u*u-4*c*d,h>=0?(h=Math.sqrt(h),p=[(-u+h)/(2*c),(-u-h)/(2*c)],0==i?new JXG.Coords(JXG.COORDS_BY_USER,[-p[0]*-l[1]-s*l[0],-p[0]*l[0]-s*l[1]],n):new JXG.Coords(JXG.COORDS_BY_USER,[-p[1]*-l[1]-s*l[0],-p[1]*l[0]-s*l[1]],n)):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],n))},meetCircleCircle:function(e,t,i,n){var r;return e[4]<JXG.Math.eps?Math.abs(this.distance(e.slice(6,2),t.slice(6,8))-t[4])<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,e.slice(6,8),n):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],n):t[4]<JXG.Math.eps?Math.abs(this.distance(t.slice(6,2),e.slice(6,8))-e[4])<JXG.Math.eps?new JXG.Coords(JXG.COORDS_BY_USER,t.slice(6,8),n):new JXG.Coords(JXG.COORDS_BY_USER,[0,0,0],n):(r=[t[3]*e[0]-e[3]*t[0],t[3]*e[1]-e[3]*t[1],t[3]*e[2]-e[3]*t[2],0,1,1/0,1/0,1/0],r=JXG.Math.normalize(r),this.meetLineCircle(r,e,i,n))},meetCurveCurve:function(e,t,i,n,r){var o,a,s,l,c,u,d,h,p,f,g,m,b,v,y=0;for(JXG.exists(r)||(r=e.board),arguments.callee.t1memo?(o=arguments.callee.t1memo,a=arguments.callee.t2memo):(o=i,a=n),c1X=function(t){return e.X.apply(e,[t])},c1Y=function(t){return e.Y.apply(e,[t])},c2X=function(e){return t.X.apply(t,[e])},c2Y=function(e){return t.Y.apply(t,[e])},h=e.X(o)-t.X(a),p=e.Y(o)-t.Y(a),f=h*h+p*p,g=r.D(e.X,e),m=r.D(t.X,t),b=r.D(e.Y,e),v=r.D(t.Y,t);f>JXG.Math.eps&&10>y;)s=g(o),l=-m(a),c=b(o),u=-v(a),d=s*u-l*c,o-=(u*h-l*p)/d,a-=(s*p-c*h)/d,h=e.X(o)-t.X(a),p=e.Y(o)-t.Y(a),f=h*h+p*p,y++;return arguments.callee.t1memo=o,arguments.callee.t2memo=a,Math.abs(o)<Math.abs(a)?new JXG.Coords(JXG.COORDS_BY_USER,[e.X(o),e.Y(o)],r):new JXG.Coords(JXG.COORDS_BY_USER,[t.X(a),t.Y(a)],r)},meetCurveLine:function(e,t,i,n,r){var o,a,s,l=[0,0/0,0/0];for(JXG.exists(n)||(n=e.board),o=0;1>=o;o++)if(arguments[o].elementClass==JXG.OBJECT_CLASS_CURVE)a=arguments[o];else{if(arguments[o].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't call meetCurveLine with parent class "+arguments[o].elementClass+".");s=arguments[o]}return l="plot"===a.visProp.curvetype?this.meetCurveLineDiscrete(a,s,i,n,r):this.meetCurveLineContinuous(a,s,i,n)},meetCurveLineContinuous:function(e,t,i,n){var r,o,a,e,t,s,l,c,u,d,h,p,f,g;if(s=function(i){return t.stdform[0]+t.stdform[1]*e.X(i)+t.stdform[2]*e.Y(i)},arguments.callee.t1memo?(h=arguments.callee.t1memo,r=JXG.Math.Numerics.root(s,h)):(h=e.minX(),p=e.maxX(),r=JXG.Math.Numerics.root(s,[h,p])),arguments.callee.t1memo=r,f=e.X(r),g=e.Y(r),1==i){if(arguments.callee.t2memo&&(h=arguments.callee.t2memo,o=JXG.Math.Numerics.root(s,h)),!(Math.abs(o-r)>.1&&Math.abs(f-e.X(o))>.1&&Math.abs(g-e.Y(o))>.1))for(u=20,d=(e.maxX()-e.minX())/u,c=e.minX(),a=0;u>a&&(o=JXG.Math.Numerics.root(s,[c,c+d]),!(Math.abs(o-r)>.1&&Math.abs(f-e.X(o))>.1&&Math.abs(g-e.Y(o))>.1));a++)c+=d;r=o,arguments.callee.t2memo=r}return l=Math.abs(s(r))>JXG.Math.eps?0/0:1,new JXG.Coords(JXG.COORDS_BY_USER,[l,e.X(r),e.Y(r)],n)},meetCurveLineDiscrete:function(e,t,i,n,r){var o,a,s,l,c,u,d,h,p=0,f=!1;for(o=e.numberPoints,null!=r&&(h=r.point,JXG.exists(h)&&!h.visProp.alwaysintersect&&(f=!0)),c=new JXG.Coords(JXG.COORDS_BY_USER,[0,0/0,0/0],n),l=[1,e.X(0),e.Y(0)],a=1;o>a;a++)if(s=l.slice(0),l=[1,e.X(a),e.Y(a)],u=this.distance(s,l),!(JXG.Math.eps>u)&&(d=this.meetSegmentSegment(s,l,t.point1.coords.usrCoords,t.point2.coords.usrCoords,n),d[1]>=0&&1>=d[1])){if(p==i){if(f&&(0==t.visProp.straightfirst&&0>d[2]||0==t.visProp.straightlast&&d[2]>1))break;c=new JXG.Coords(JXG.COORDS_BY_USER,d[0],n);break}p++}return c},meetSegmentSegment:function(e,t,i,n){var r,o,a,s=JXG.Math.crossProduct(e,t),l=JXG.Math.crossProduct(i,n),c=JXG.Math.crossProduct(s,l),u=c[0];return Math.abs(u)<Math.eps?[c,Number.Infinity,Number.Infinity]:(a=[i[1]-e[1],i[2]-e[2]],r=(a[0]*(n[2]-i[2])-a[1]*(n[1]-i[1]))/u,o=(a[0]*(t[2]-e[2])-a[1]*(t[1]-e[1]))/u,[c,r,o])},projectPointToCircle:function(e,t,i){var n,r,o,a,s,l=t.center.coords.usrCoords;return JXG.exists(i)||(i=e.board),JXG.isPoint(e)?(n=e.coords.distance(JXG.COORDS_BY_USER,t.center.coords),r=e.coords.usrCoords):(n=e.distance(JXG.COORDS_BY_USER,t.center.coords),r=e.usrCoords),Math.abs(n)<JXG.Math.eps&&(n=JXG.Math.eps),s=t.Radius()/n,o=l[1]+s*(r[1]-l[1]),a=l[2]+s*(r[2]-l[2]),new JXG.Coords(JXG.COORDS_BY_USER,[o,a],i)},projectPointToLine:function(e,t,i){var n=[0,t.stdform[1],t.stdform[2]];return JXG.exists(i)||(i=e.board),n=JXG.Math.crossProduct(n,e.coords.usrCoords),this.meetLineLine(n,t.stdform,0,i)},projectCoordsToSegment:function(e,t,i){var n,r,o=[i[1]-t[1],i[2]-t[2]],a=[e[1]-t[1],e[2]-t[2]];return Math.abs(o[0])<JXG.Math.eps&&Math.abs(o[1])<JXG.Math.eps?t:(n=JXG.Math.innerProduct(a,o),r=JXG.Math.innerProduct(o,o),n/=r,[[1,n*o[0]+t[1],n*o[1]+t[2]],n])},projectPointToCurve:function(e,t,i){JXG.exists(i)||(i=e.board);var n=e.X(),r=e.Y(),o=e.position||0,a=this.projectCoordsToCurve(n,r,o,t,i);return e.position=a[1],a[0]},projectCoordsToCurve:function(e,t,i,n,r){var o,a,s,l,c,u,d,h,p,f,g,m,i,b,v,y,x,C,w=Number.POSITIVE_INFINITY;if(JXG.exists(r)||(r=n.board),"parameter"==n.visProp.curvetype||"polar"==n.visProp.curvetype){for(m=function(i){var r=e-n.X(i),o=t-n.Y(i);return r*r+o*o},y=m(i),C=20,x=(n.maxX()-n.minX())/C,b=n.minX(),a=0;C>a;a++)v=m(b),y>v&&(i=b,y=v),b+=x;i=JXG.Math.Numerics.root(JXG.Math.Numerics.D(m),i),n.minX()>i&&(i=n.maxX()+i-n.minX()),i>n.maxX()&&(i=n.minX()+i-n.maxX()),o=new JXG.Coords(JXG.COORDS_BY_USER,[n.X(i),n.Y(i)],r)}else if("plot"==n.visProp.curvetype){if(i=0,s=w,o=0==n.numberPoints?[0,1,1]:[n.Z(0),n.X(0),n.Y(0)],n.numberPoints>1)for(p=[n.Z(0),n.X(0),n.Y(0)],a=0;n.numberPoints-1>a;a++)f=[n.Z(a+1),n.X(a+1),n.Y(a+1)],u=[1,e,t],g=this.projectCoordsToSegment(u,p,f),c=g[1],d=g[0],c>=0&&1>=c?(l=this.distance(d,u),h=a+c):0>c?(d=p,l=this.distance(p,u),h=a):c>1&&a+1==n.numberPoints-1&&(d=f,l=this.distance(d,u),h=n.numberPoints-1),s>l&&(s=l,i=h,o=d),p=f;o=new JXG.Coords(JXG.COORDS_BY_USER,o,r)}else i=e,e=i,t=n.Y(i),o=new JXG.Coords(JXG.COORDS_BY_USER,[e,t],r);return[n.updateTransform(o),i]},projectPointToTurtle:function(e,t,i){var n,r,o,a,s,l,c,u,d=0,h=0,p=Number.POSITIVE_INFINITY,f=t.objects.length;for(JXG.exists(i)||(i=e.board),s=0;f>s;s++)c=t.objects[s],c.elementClass==JXG.OBJECT_CLASS_CURVE&&(n=this.projectPointToCurve(e,c),l=this.distance(n.usrCoords,e.coords.usrCoords),p>l&&(o=n.usrCoords[1],a=n.usrCoords[2],r=e.position,p=l,u=c,h=d),d+=c.numberPoints);return n=new JXG.Coords(JXG.COORDS_BY_USER,[o,a],i),e.position=r+h,u.updateTransform(n)},projectPointToPoint:function(e,t){return t.coords},distPointLine:function(e,t){var i,n=t[1],r=t[2],o=t[0];return Math.abs(n)+Math.abs(r)<JXG.Math.eps?Number.POSITIVE_INFINITY:(i=n*e[1]+r*e[2]+1*o,n*=n,r*=r,Math.abs(i)/Math.sqrt(n+r))}}),JXG.Math.Poly={},JXG.Math.Poly.Ring=function(e){this.vars=e},JXG.extend(JXG.Math.Poly.Ring.prototype,{}),JXG.Math.Poly.Monomial=function(e,t,i){var n;if(!JXG.exists(e))throw Error("JSXGraph error: In JXG.Math.Poly.monomial missing parameter 'ring'.");for(JXG.isArray(i)||(i=[]),i=i.slice(0,e.vars.length),n=i.length;e.vars.length>n;n++)i.push(0);this.ring=e,this.coefficient=t||0,this.exponents=JXG.deepCopy(i)},JXG.extend(JXG.Math.Poly.Monomial.prototype,{copy:function(){return new JXG.Math.Poly.Monomial(this.ring,this.coefficient,this.exponents)},print:function(){var e,t=[];for(e=0;this.ring.vars.length>e;e++)t.push(this.ring.vars[e]+"^"+this.exponents[e]);return this.coefficient+"*"+t.join("*")}}),JXG.Math.Poly.Polynomial=function(e,t){var i,n=function(){};if(!JXG.exists(e))throw Error("JSXGraph error: In JXG.Math.Poly.polynomial missing parameter 'ring'.");i=JXG.exists(t)&&"string"==typeof t?n(t):[],this.ring=e,this.monomials=i},JXG.extend(JXG.Math.Poly.Polynomial.prototype,{findSignature:function(e){var t;for(t=0;this.monomials.length>t;t++)if(JXG.cmpArrays(this.monomials[t].exponents,e))return t;return-1},addSubMonomial:function(e,t){var i;i=this.findSignature(e.exponents),i>-1?this.monomials[i].coefficient+=t*e.coefficient:(e.coefficient*=t,this.monomials.push(e))},add:function(e){var t;if(!JXG.exists(e)||e.ring!==this.ring)throw Error("JSXGraph error: In JXG.Math.Poly.polynomial.add either summand is undefined or rings don't match.");if(JXG.isArray(e.exponents))this.addSubMonomial(e,1);else for(t=0;e.monomials.length>t;t++)this.addSubMonomial(e.monomials[t],1)},sub:function(e){var t;if(!JXG.exists(e)||e.ring!==this.ring)throw Error("JSXGraph error: In JXG.Math.Poly.polynomial.sub either summand is undefined or rings don't match.");if(JXG.isArray(e.exponents))this.addSubMonomial(e,-1);else for(t=0;e.monomials.length>t;t++)this.addSubMonomial(e.monomials[t],-1)},copy:function(){var e,t;for(t=new JXG.Math.Poly.Polynomial(this.ring),e=0;this.monomials.length>e;e++)t.monomials.push(this.monomials[e].copy());return t},print:function(){var e,t=[];for(e=0;this.monomials.length>e;e++)t.push("("+this.monomials[e].print()+")");return t.join("+")}}),JXG.Complex=function(e,t){this.isComplex=!0,e===void 0&&(e=0),t===void 0&&(t=0),e.isComplex&&(t=e.imaginary,e=e.real),this.real=e,this.imaginary=t,this.absval=0,this.angle=0},JXG.extend(JXG.Complex.prototype,{toString:function(){return""+this.real+" + "+this.imaginary+"i"},add:function(e){"number"==typeof e?this.real+=e:(this.real+=e.real,this.imaginary+=e.imaginary)},sub:function(e){"number"==typeof e?this.real-=e:(this.real-=e.real,this.imaginary-=e.imaginary)},mult:function(e){var t,i;"number"==typeof e?(this.real*=e,this.imaginary*=e):(t=this.real,i=this.imaginary,this.real=t*e.real-i*e.imaginary,this.imaginary=t*e.imaginary+i*e.real)},div:function(e){var t,i,n;if("number"==typeof e){if(Math.abs(e)<Math.eps)return this.real=1/0,this.imaginary=1/0,void 0;this.real/=e,this.imaginary/=e}else{if(Math.abs(e.real)<Math.eps&&Math.abs(e.imaginary)<Math.eps)return this.real=1/0,this.imaginary=1/0,void 0;t=e.real*e.real+e.imaginary*e.imaginary,n=this.real,i=this.imaginary,this.real=(n*e.real+i*e.imaginary)/t,this.imaginary=(i*e.real-n*e.imaginary)/t}},conj:function(){this.imaginary*=-1}}),JXG.C={},JXG.C.add=function(e,t){var i=new JXG.Complex(e);return i.add(t),i},JXG.C.sub=function(e,t){var i=new JXG.Complex(e);return i.sub(t),i},JXG.C.mult=function(e,t){var i=new JXG.Complex(e);return i.mult(t),i},JXG.C.div=function(e,t){var i=new JXG.Complex(e);return i.div(t),i},JXG.C.conj=function(e){var t=new JXG.Complex(e);return t.conj(),t},JXG.C.abs=function(e){var t=new JXG.Complex(e);return t.conj(),t.mult(e),Math.sqrt(t.real)},JXG.AbstractRenderer=function(){this.vOffsetText=0,this.enhancedRendering=!0,this.container=null,this.type=""},JXG.extend(JXG.AbstractRenderer.prototype,{_updateVisual:function(e,t,i){(i||this.enhancedRendering)&&(t=t||{},e.visProp.draft?this.setDraft(e):(t.stroke||(this.setObjectStrokeWidth(e,e.visProp.strokewidth),this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity)),t.fill||this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity),t.dash||this.setDashStyle(e,e.visProp),t.shadow||this.setShadow(e),t.gradient||this.setShadow(e)))},drawPoint:function(e){var t,i=JXG.Point.prototype.normalizeFace.call(this,e.visProp.face);t="o"===i?"ellipse":"[]"===i?"rect":"path",this.appendChildPrim(this.createPrim(t,e.id),e.visProp.layer),this.appendNodesToElement(e,t),this._updateVisual(e,{dash:!0,shadow:!0},!0),this.updatePoint(e)},updatePoint:function(e){var t=e.visProp.size,i=JXG.Point.prototype.normalizeFace.call(this,e.visProp.face);isNaN(e.coords.scrCoords[2]+e.coords.scrCoords[1])||(this._updateVisual(e,{dash:!1,shadow:!1}),t*=e.board&&e.board.options.point.zoom?Math.sqrt(e.board.zoomX*e.board.zoomY):1,"o"===i?this.updateEllipsePrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2],t+1,t+1):"[]"===i?this.updateRectPrim(e.rendNode,e.coords.scrCoords[1]-t,e.coords.scrCoords[2]-t,2*t,2*t):this.updatePathPrim(e.rendNode,this.updatePathStringPoint(e,t,i),e.board),this.setShadow(e))},changePointStyle:function(e){var t=this.getElementById(e.id);JXG.exists(t)&&this.remove(t),this.drawPoint(e),JXG.clearVisPropOld(e),e.visProp.visible||this.hide(e),e.visProp.draft&&this.setDraft(e)},drawLine:function(e){this.appendChildPrim(this.createPrim("line",e.id),e.visProp.layer),this.appendNodesToElement(e,"lines"),this.updateLine(e)},updateLine:function(e){var t=new JXG.Coords(JXG.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),i=new JXG.Coords(JXG.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),n=null;(e.visProp.firstarrow||e.visProp.lastarrow)&&(n=0),JXG.Math.Geometry.calcStraight(e,t,i,n),this.updateLinePrim(e.rendNode,t.scrCoords[1],t.scrCoords[2],i.scrCoords[1],i.scrCoords[2],e.board),this.makeArrows(e),this._updateVisual(e,{fill:!0})},drawTicks:function(e){var t=this.createPrim("path",e.id);this.appendChildPrim(t,e.visProp.layer),this.appendNodesToElement(e,"path")},updateTicks:function(){},drawCurve:function(e){this.appendChildPrim(this.createPrim("path",e.id),e.visProp.layer),this.appendNodesToElement(e,"path"),this._updateVisual(e,{shadow:!0},!0),this.updateCurve(e)},updateCurve:function(e){this._updateVisual(e),e.visProp.handdrawing?this.updatePathPrim(e.rendNode,this.updatePathStringBezierPrim(e),e.board):this.updatePathPrim(e.rendNode,this.updatePathStringPrim(e),e.board),e.numberPoints>1&&this.makeArrows(e)},drawEllipse:function(e){this.appendChildPrim(this.createPrim("ellipse",e.id),e.visProp.layer),this.appendNodesToElement(e,"ellipse"),this.updateEllipse(e)},updateEllipse:function(e){this._updateVisual(e);var t=e.Radius();t>0&&Math.abs(e.center.coords.usrCoords[0])>JXG.Math.eps&&!isNaN(t+e.center.coords.scrCoords[1]+e.center.coords.scrCoords[2])&&2e6>t*e.board.unitX&&this.updateEllipsePrim(e.rendNode,e.center.coords.scrCoords[1],e.center.coords.scrCoords[2],t*e.board.unitX,t*e.board.unitY)},drawPolygon:function(e){this.appendChildPrim(this.createPrim("polygon",e.id),e.visProp.layer),this.appendNodesToElement(e,"polygon"),this.updatePolygon(e)},updatePolygon:function(e){this._updateVisual(e,{stroke:!0,dash:!0}),this.updatePolygonPrim(e.rendNode,e)},displayCopyright:function(){},drawInternalText:function(){},updateInternalText:function(){},drawText:function(e){var t,i;"html"===e.visProp.display?(t=this.container.ownerDocument.createElement("div"),t.style.position="absolute",t.className=e.visProp.cssclass,i=""==this.container.style.zIndex?0:parseInt(this.container.style.zIndex),t.style.zIndex=i+e.board.options.layer.text,this.container.appendChild(t),t.setAttribute("id",this.container.id+"_"+e.id)):t=this.drawInternalText(e),e.rendNode=t,e.htmlStr="",this.updateText(e)},updateText:function(e){var t=e.plaintext;e.visProp.visible&&(this.updateTextStyle(e,!1),"html"===e.visProp.display?(isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||("right"===e.visProp.anchorx?e.rendNode.style.right=parseInt(e.board.canvasWidth-e.coords.scrCoords[1])+"px":e.rendNode.style.left="middle"===e.visProp.anchorx?parseInt(e.coords.scrCoords[1]-.5*e.size[0])+"px":parseInt(e.coords.scrCoords[1])+"px",e.rendNode.style.top="top"===e.visProp.anchory?parseInt(e.coords.scrCoords[2]+this.vOffsetText)+"px":"middle"===e.visProp.anchory?parseInt(e.coords.scrCoords[2]-.5*e.size[1]+this.vOffsetText)+"px":parseInt(e.coords.scrCoords[2]-e.size[1]+this.vOffsetText)+"px"),e.htmlStr!==t&&(e.rendNode.innerHTML=t,e.htmlStr=t,e.visProp.usemathjax?MathJax.Hub.Queue(["Typeset",MathJax.Hub,e.rendNode]):e.visProp.useasciimathml&&AMprocessNode(e.rendNode,!1)),this.transformImage(e,e.transformations)):this.updateInternalText(e))},updateTextStyle:function(e,t){var i,n,r,o,a=e.visProp;if(t?(r=a.highlightstrokecolor,n=a.highlightstrokeopacity,o=a.highlightcssclass):(r=a.strokecolor,n=a.strokeopacity,o=a.cssclass),"html"===e.visProp.display||"canvas"!=this.type){if(i=JXG.evaluate(e.visProp.fontsize),e.visPropOld.fontsize!=i){try{e.rendNode.style.fontSize=i+"px"}catch(s){e.rendNode.style.fontSize=i}e.visPropOld.fontsize=i}e.visPropOld.cssclass!=o&&(e.rendNode.className=o,e.visPropOld.cssclass=o)}return"html"===e.visProp.display?this.setObjectStrokeColor(e,r,n):this.updateInternalTextStyle(e,r,n),this},updateInternalTextStyle:function(e,t,i){this.setObjectStrokeColor(e,t,i)},drawImage:function(){},updateImage:function(e){this.updateRectPrim(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),this.updateImageURL(e),this.transformImage(e,e.transformations),this._updateVisual(e,{stroke:!0,dash:!0},!0)},joinTransforms:function(e,t){var i,n=[[1,0,0],[0,1,0],[0,0,1]],r=e.board.origin.scrCoords[1],o=e.board.origin.scrCoords[2],a=e.board.unitX,s=e.board.unitY,l=[[1,0,0],[-r,1,0],[-o,0,1]],c=[[1,0,0],[0,1/a,0],[0,0,-1/s]],u=[[1,0,0],[0,a,0],[0,0,-s]],d=[[1,0,0],[r,1,0],[o,0,1]],h=t.length;for(i=0;h>i;i++)n=JXG.Math.matMatMult(l,n),n=JXG.Math.matMatMult(c,n),n=JXG.Math.matMatMult(t[i].matrix,n),n=JXG.Math.matMatMult(u,n),n=JXG.Math.matMatMult(d,n);return n},transformImage:function(){},updateImageURL:function(){},updateImageStyle:function(e,t){var i=t?el.visProp.highlightcssclass:el.visProp.cssclass;e.rendNode.className=i},appendChildPrim:function(){},appendNodesToElement:function(){},createPrim:function(){return null
},remove:function(){},makeArrows:function(){},updateEllipsePrim:function(){},updateLinePrim:function(){},updatePathPrim:function(){},updatePathStringPoint:function(){},updatePathStringPrim:function(){},updatePathStringBezierPrim:function(){},updatePolygonPrim:function(){},updateRectPrim:function(){},setPropertyPrim:function(){},show:function(){},hide:function(){},setBuffering:function(){},setDashStyle:function(){},setDraft:function(e){if(e.visProp.draft){var t=e.board.options.elements.draft.color,i=e.board.options.elements.draft.opacity;e.type===JXG.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,t,i):(e.elementClass===JXG.OBJECT_CLASS_POINT?this.setObjectFillColor(e,t,i):this.setObjectFillColor(e,"none",0),this.setObjectStrokeColor(e,t,i),this.setObjectStrokeWidth(e,e.board.options.elements.draft.strokeWidth))}},removeDraft:function(e){e.type===JXG.OBJECT_TYPE_POLYGON?this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity):(e.type===JXG.OBJECT_CLASS_POINT&&this.setObjectFillColor(e,e.visProp.fillcolor,e.visProp.fillopacity),this.setObjectStrokeColor(e,e.visProp.strokecolor,e.visProp.strokeopacity),this.setObjectStrokeWidth(e,e.visProp.strokewidth))},setGradient:function(){},updateGradient:function(){},setObjectFillColor:function(){},setObjectStrokeColor:function(){},setObjectStrokeWidth:function(){},setShadow:function(){},highlight:function(e){var t,i=e.visProp;if(!i.draft){if(e.type===JXG.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,i.highlightfillcolor,i.highlightfillopacity),t=0;e.borders.length>t;t++)this.setObjectStrokeColor(e.borders[t],e.borders[t].visProp.highlightstrokecolor,e.borders[t].visProp.highlightstrokeopacity);else e.type===JXG.OBJECT_TYPE_TEXT?this.updateTextStyle(e,!0):e.type===JXG.OBJECT_TYPE_IMAGE?this.updateImageStyle(e,!0):(this.setObjectStrokeColor(e,i.highlightstrokecolor,i.highlightstrokeopacity),this.setObjectFillColor(e,i.highlightfillcolor,i.highlightfillopacity));i.highlightstrokewidth&&this.setObjectStrokeWidth(e,Math.max(i.highlightstrokewidth,i.strokewidth))}return this},noHighlight:function(e){var t,i=e.visProp;if(!e.visProp.draft){if(e.type===JXG.OBJECT_TYPE_POLYGON)for(this.setObjectFillColor(e,i.fillcolor,i.fillopacity),t=0;e.borders.length>t;t++)this.setObjectStrokeColor(e.borders[t],e.borders[t].visProp.strokecolor,e.borders[t].visProp.strokeopacity);else e.type===JXG.OBJECT_TYPE_TEXT?this.updateTextStyle(e,!1):e.type===JXG.OBJECT_TYPE_IMAGE?this.updateImageStyle(e,!1):(this.setObjectStrokeColor(e,i.strokecolor,i.strokeopacity),this.setObjectFillColor(e,i.fillcolor,i.fillopacity));this.setObjectStrokeWidth(e,i.strokewidth)}return this},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(e){var t,i,n=function(n,r){var o;o=t.createElement("span"),i.appendChild(o),o.appendChild(document.createTextNode(n)),JXG.addEvent(o,"click",r,e)};t=e.containerObj.ownerDocument,i=t.createElement("div"),i.setAttribute("id",e.containerObj.id+"_navigationbar"),i.style.color=e.options.navbar.strokeColor,i.style.backgroundColor=e.options.navbar.fillColor,i.style.padding=e.options.navbar.padding,i.style.position=e.options.navbar.position,i.style.fontSize=e.options.navbar.fontSize,i.style.cursor=e.options.navbar.cursor,i.style.zIndex=e.options.navbar.zIndex,e.containerObj.appendChild(i),i.style.right=e.options.navbar.right,i.style.bottom=e.options.navbar.bottom,n("",e.zoomOut),n("o",e.zoom100),n("+",e.zoomIn),n("",e.clickLeftArrow),n("",e.clickUpArrow),n("",e.clickDownArrow),n("",e.clickRightArrow)},getElementById:function(e){return document.getElementById(this.container.id+"_"+e)},resize:function(){}}),JXG.NoRenderer=function(){this.enhancedRendering=!1,this.type="no"},JXG.extend(JXG.NoRenderer.prototype,{drawPoint:function(){},updatePoint:function(){},changePointStyle:function(){},drawLine:function(){},updateLine:function(){},drawTicks:function(){},updateTicks:function(){},drawCurve:function(){},updateCurve:function(){},drawEllipse:function(){},updateEllipse:function(){},drawPolygon:function(){},updatePolygon:function(){},displayCopyright:function(){},drawInternalText:function(){},updateInternalText:function(){},drawText:function(){},updateText:function(){},updateTextStyle:function(){},updateInternalTextStyle:function(){},drawImage:function(){},updateImage:function(){},transformImage:function(){},updateImageURL:function(){},appendChildPrim:function(){},appendNodesToElement:function(){},createPrim:function(){return null},remove:function(){},makeArrows:function(){},updateEllipsePrim:function(){},updateLinePrim:function(){},updatePathPrim:function(){},updatePathStringPoint:function(){},updatePathStringPrim:function(){},updatePathStringBezierPrim:function(){},updatePolygonPrim:function(){},updateRectPrim:function(){},setPropertyPrim:function(){},show:function(){},hide:function(){},setBuffering:function(){},setDashStyle:function(){},setDraft:function(){},removeDraft:function(){},setGradient:function(){},updateGradient:function(){},setObjectFillColor:function(){},setObjectStrokeColor:function(){},setObjectStrokeWidth:function(){},setShadow:function(){},highlight:function(){},noHighlight:function(){},suspendRedraw:function(){},unsuspendRedraw:function(){},drawZoomBar:function(){},getElementById:function(){return null},resize:function(){}}),JXG.FileReader={parseFileContent:function(e,t,i,n){var r=!1;JXG.exists(n)||(n=!0);try{r=new XMLHttpRequest,"raw"==i.toLowerCase()?r.overrideMimeType("text/plain; charset=iso-8859-1"):r.overrideMimeType("text/xml; charset=iso-8859-1")}catch(o){try{r=new ActiveXObject("Msxml2.XMLHTTP")}catch(o){try{r=new ActiveXObject("Microsoft.XMLHTTP")}catch(o){r=!1}}}if(!r)return alert("AJAX not activated!"),void 0;r.open("GET",e,n),this.cbp="raw"===i.toLowerCase()?function(){var e=r;4==e.readyState&&t(e.responseText)}:function(){var e=r;if(4==e.readyState){var n="";n=e.responseStream===void 0||"PK"!=e.responseText.slice(0,2)&&31!=JXG.Util.asciiCharCodeAt(e.responseText.slice(0,1),0)?e.responseText:JXG.Util.Base64.decode(BinFileReader(e)),this.parseString(n,t,i,!1)}},this.cb=JXG.bind(this.cbp,this),r.onreadystatechange=this.cb;try{r.send(null)}catch(o){throw Error("JSXGraph: A problem occurred while trying to read '"+e+"'.")}},cleanWhitespace:function(e){for(var t=e.firstChild;null!=t;)3!=t.nodeType||/\S/.test(t.nodeValue)?1==t.nodeType&&this.cleanWhitespace(t):e.removeChild(t),t=t.nextSibling},stringToXMLTree:function(e){"undefined"==typeof DOMParser&&(DOMParser=function(){},DOMParser.prototype.parseFromString=function(e){if("undefined"!=typeof ActiveXObject){var t=new ActiveXObject("MSXML.DomDocument");return t.loadXML(e),t}});var t=new DOMParser,i=t.parseFromString(e,"text/xml");return this.cleanWhitespace(i),i},parseString:function(e,t,i,n){var r,o;switch(i=i.toLowerCase()){case"cdy":case"cinderella":n&&(e=JXG.Util.Base64.decode(e)),e=JXG.CinderellaReader.readCinderella(e,t),t.xmlString=e;break;case"tracenpoche":t.xmlString=JXG.TracenpocheReader.readTracenpoche(e,t);break;case"graph":e=JXG.GraphReader.readGraph(e,t,!1);break;case"digraph":e=JXG.GraphReader.readGraph(e,t,!0);break;case"geonext":e=JXG.GeonextReader.prepareString(e),o=!0;break;case"geogebra":n="PK"!==e.slice(0,2),e=JXG.GeogebraReader.prepareString(e,n),o=!0;break;case"intergeo":n&&(e=JXG.Util.Base64.decode(e)),e=JXG.IntergeoReader.prepareString(e),o=!0;break;case"sketch":e=JXG.SketchReader.readSketch(e,t)}o&&(t.xmlString=e,r=this.stringToXMLTree(e),this.readElements(r,t,i))},readElements:function(e,t,i){"geonext"==i.toLowerCase()?(t.suspendUpdate(),0!=e.getElementsByTagName("GEONEXT").length&&JXG.GeonextReader.readGeonext(e,t),t.unsuspendUpdate()):0!=e.getElementsByTagName("geogebra").length?JXG.GeogebraReader.readGeogebra(e,t):"intergeo"==i.toLowerCase()&&JXG.IntergeoReader.readIntergeo(e,t)}},!JXG.isMetroApp()&&"undefined"!=typeof navigator&&/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent&&document&&document.write)&&document.write('<script type="text/vbscript">\nFunction Base64Encode(inData)\n  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"\n  Dim cOut, sOut, I\n  For I = 1 To LenB(inData) Step 3\n    Dim nGroup, pOut, sGroup\n    nGroup = &H10000 * AscB(MidB(inData, I, 1)) + _\n      &H100 * MyASC(MidB(inData, I + 1, 1)) + MyASC(MidB(inData, I + 2, 1))\n    nGroup = Oct(nGroup)\n    nGroup = String(8 - Len(nGroup), "0") & nGroup\n    pOut = Mid(Base64, CLng("&o" & Mid(nGroup, 1, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 3, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 5, 2)) + 1, 1) + _\n      Mid(Base64, CLng("&o" & Mid(nGroup, 7, 2)) + 1, 1)\n    sOut = sOut + pOut\n  Next\n  Select Case LenB(inData) Mod 3\n    Case 1: \'8 bit final\n      sOut = Left(sOut, Len(sOut) - 2) + "=="\n    Case 2: \'16 bit final\n      sOut = Left(sOut, Len(sOut) - 1) + "="\n  End Select\n  Base64Encode = sOut\nEnd Function\n\nFunction MyASC(OneChar)\n  If OneChar = "" Then MyASC = 0 Else MyASC = AscB(OneChar)\nEnd Function\n\nFunction BinFileReader(xhr)\n    Dim byteString\n    Dim b64String\n    Dim i\n    byteString = xhr.responseBody\n    ReDim byteArray(LenB(byteString))\n    For i = 1 To LenB(byteString)\n        byteArray(i-1) = AscB(MidB(byteString, i, 1))\n    Next\n    b64String = Base64Encode(byteString)\n    BinFileReader = b64String\nEnd Function\n</script>\n'),JXG.GeonextParser={},JXG.GeonextParser.replacePow=function(e){var t,i,n,r,o,a,s,l,c,u,d;for(e=e.replace(/(\s*)\^(\s*)/g,"^"),c=e.indexOf("^");c>=0;){if(l=e.slice(0,c),u=e.slice(c+1),")"==l.charAt(l.length-1)){for(t=1,i=l.length-2;i>=0&&t>0;)n=l.charAt(i),")"==n?t++:"("==n&&t--,i--;if(0!=t)throw Error("JSXGraph: Missing '(' in expression");for(r="",a=l.substring(0,i+1),s=i;s>=0&&a.substr(s,1).match(/([\w\.]+)/);)r=RegExp.$1+r,s--;r+=l.substring(i+1,l.length),r=r.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}else r="[\\w\\.]+";if(u.match(/^([\w\.]*\()/)){for(t=1,i=RegExp.$1.length;u.length>i&&t>0;)n=u.charAt(i),")"==n?t--:"("==n&&t++,i++;if(0!=t)throw Error("JSXGraph: Missing ')' in expression");o=u.substring(0,i),o=o.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}else o="[\\w\\.]+";d=RegExp("("+r+")\\^("+o+")"),e=e.replace(d,"JXG.Math.pow($1,$2)"),c=e.indexOf("^")}return e},JXG.GeonextParser.replaceIf=function(e){var t,i,n,r,o,a,s,l,c,u="",d=null,h=null,p=null;if(n=e.indexOf("If("),0>n)return e;for(e=e.replace(/""/g,"0");n>=0;){for(t=e.slice(0,n),i=e.slice(n+3),o=1,r=0,a=-1,s=-1;i.length>r&&o>0;)l=i.charAt(r),")"==l?o--:"("==l?o++:","==l&&1==o&&(0>a?a=r:s=r),r++;if(c=i.slice(0,r-1),i=i.slice(r),0>a)return"";if(0>s)return"";d=c.slice(0,a),h=c.slice(a+1,s),p=c.slice(s+1),d=this.replaceIf(d),h=this.replaceIf(h),p=this.replaceIf(p),u+=t+"(("+d+")?"+"("+h+"):("+p+"))",e=i,d=null,h=null,n=e.indexOf("If(")}return u+=i},JXG.GeonextParser.replaceSub=function(e){if(!e.indexOf)return e;for(var t,i=e.indexOf("_{");i>=0;)e=e.substr(0,i)+e.substr(i).replace(/_\{/,"<sub>"),t=e.substr(i).indexOf("}"),t>=0&&(e=e.substr(0,t)+e.substr(t).replace(/\}/,"</sub>")),i=e.indexOf("_{");for(i=e.indexOf("_");i>=0;)e=e.substr(0,i)+e.substr(i).replace(/_(.?)/,"<sub>$1</sub>"),i=e.indexOf("_");return e},JXG.GeonextParser.replaceSup=function(e){if(!e.indexOf)return e;for(var t,i=e.indexOf("^{");i>=0;)e=e.substr(0,i)+e.substr(i).replace(/\^\{/,"<sup>"),t=e.substr(i).indexOf("}"),t>=0&&(e=e.substr(0,t)+e.substr(t).replace(/\}/,"</sup>")),i=e.indexOf("^{");for(i=e.indexOf("^");i>=0;)e=e.substr(0,i)+e.substr(i).replace(/\^(.?)/,"<sup>$1</sup>"),i=e.indexOf("^");return e},JXG.GeonextParser.replaceNameById=function(e,t){var i,n,r,o,a=0,s=["X","Y","L","V"];for(o=0;s.length>o;o++)for(a=e.indexOf(s[o]+"(");a>=0;)a>=0&&(i=e.indexOf(")",a+2),i>=0&&(n=e.slice(a+2,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+2)+r.id+e.slice(i))),i=e.indexOf(")",a+2),a=e.indexOf(s[o]+"(",i);for(a=e.indexOf("Dist(");a>=0;)a>=0&&(i=e.indexOf(",",a+5),i>=0&&(n=e.slice(a+5,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+5)+r.id+e.slice(i))),i=e.indexOf(",",a+5),a=e.indexOf(",",i),i=e.indexOf(")",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+r.id+e.slice(i)),i=e.indexOf(")",a+1),a=e.indexOf("Dist(",i);for(s=["Deg","Rad"],o=0;s.length>o;o++)for(a=e.indexOf(s[o]+"(");a>=0;)a>=0&&(i=e.indexOf(",",a+4),i>=0&&(n=e.slice(a+4,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+4)+r.id+e.slice(i))),i=e.indexOf(",",a+4),a=e.indexOf(",",i),i=e.indexOf(",",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+r.id+e.slice(i)),i=e.indexOf(",",a+1),a=e.indexOf(",",i),i=e.indexOf(")",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+r.id+e.slice(i)),i=e.indexOf(")",a+1),a=e.indexOf(s[o]+"(",i);return e},JXG.GeonextParser.replaceIdByObj=function(e){var t=/(X|Y|L)\(([\w_]+)\)/g;return e=e.replace(t,'this.board.objects["$2"].$1()'),t=/(V)\(([\w_]+)\)/g,e=e.replace(t,'this.board.objects["$2"].Value()'),t=/(Dist)\(([\w_]+),([\w_]+)\)/g,e=e.replace(t,'this.board.objects["$2"].Dist(this.board.objects["$3"])'),t=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g,e=e.replace(t,'JXG.Math.Geometry.trueAngle(this.board.objects["$2"],this.board.objects["$3"],this.board.objects["$4"])'),t=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g,e=e.replace(t,'JXG.Math.Geometry.rad(this.board.objects["$1"],this.board.objects["$2"],this.board.objects["$3"])'),t=/N\((.+)\)/g,e=e.replace(t,"($1)")},JXG.GeonextParser.geonext2JS=function(e,t){var i,n,r,o=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc"],a=["Math.abs","Math.acos","Math.asin","Math.atan","Math.ceil","Math.cos","Math.exp","JXG.Math.factorial","Math.floor","Math.log","Math.max","Math.min","Math.random","this.board.round","Math.sin","Math.sqrt","Math.tan","Math.ceil"];for(e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&amp;/g,"&"),n=e,n=this.replaceNameById(n,t),n=this.replaceIf(n),n=this.replacePow(n),n=this.replaceIdByObj(n),r=0;o.length>r;r++)i=RegExp(["(\\W|^)(",o[r],")"].join(""),"ig"),n=n.replace(i,["$1",a[r]].join(""));return n=n.replace(/True/g,"true"),n=n.replace(/False/g,"false"),n=n.replace(/fasle/g,"false"),n=n.replace(/Pi/g,"Math.PI")},JXG.GeonextParser.findDependencies=function(e,t,i){i===void 0&&(i=e.board);var n,r,o,a=i.elementsByName;for(n in a)n!=e.name&&(a[n].type==JXG.OBJECT_TYPE_TEXT?a[n].visProp.islabel||(o=n.replace(/\[/g,"\\["),o=o.replace(/\]/g,"\\]"),r=RegExp("\\(([\\w\\[\\]'_ ]+,)*("+o+")(,[\\w\\[\\]'_ ]+)*\\)","g"),t.search(r)>=0&&a[n].addChild(e)):(o=n.replace(/\[/g,"\\["),o=o.replace(/\]/g,"\\]"),r=RegExp("\\(([\\w\\[\\]'_ ]+,)*("+o+")(,[\\w\\[\\]'_ ]+)*\\)","g"),t.search(r)>=0&&a[n].addChild(e)))},JXG.GeonextParser.gxt2jc=function(e,t){var i;return e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&amp;/g,"&"),i=e,i=this.replaceNameById2(i,t),i=i.replace(/True/g,"true"),i=i.replace(/False/g,"false"),i=i.replace(/fasle/g,"false")},JXG.GeonextParser.replaceNameById2=function(e,t){var i,n,r,o,a=0,s=["X","Y","L","V"];for(o=0;s.length>o;o++)for(a=e.indexOf(s[o]+"(");a>=0;)a>=0&&(i=e.indexOf(")",a+2),i>=0&&(n=e.slice(a+2,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+2)+"$('"+r.id+"')"+e.slice(i))),i=e.indexOf(")",a+2),a=e.indexOf(s[o]+"(",i);for(a=e.indexOf("Dist(");a>=0;)a>=0&&(i=e.indexOf(",",a+5),i>=0&&(n=e.slice(a+5,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+5)+"$('"+r.id+"')"+e.slice(i))),i=e.indexOf(",",a+5),a=e.indexOf(",",i),i=e.indexOf(")",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+"$('"+r.id+"')"+e.slice(i)),i=e.indexOf(")",a+1),a=e.indexOf("Dist(",i);for(s=["Deg","Rad"],o=0;s.length>o;o++)for(a=e.indexOf(s[o]+"(");a>=0;)a>=0&&(i=e.indexOf(",",a+4),i>=0&&(n=e.slice(a+4,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+4)+"$('"+r.id+"')"+e.slice(i))),i=e.indexOf(",",a+4),a=e.indexOf(",",i),i=e.indexOf(",",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+"$('"+r.id+"')"+e.slice(i)),i=e.indexOf(",",a+1),a=e.indexOf(",",i),i=e.indexOf(")",a+1),i>=0&&(n=e.slice(a+1,i),n=n.replace(/\\(['"])?/g,"$1"),r=t.elementsByName[n],e=e.slice(0,a+1)+"$('"+r.id+"')"+e.slice(i)),i=e.indexOf(")",a+1),a=e.indexOf(s[o]+"(",i);return e},JXG.Board=function(e,t,i,n,r,o,a,s,l,c,u){if(this.BOARD_MODE_NONE=0,this.BOARD_MODE_DRAG=1,this.BOARD_MODE_MOVE_ORIGIN=2,this.BOARD_QUALITY_LOW=1,this.BOARD_QUALITY_HIGH=2,this.BOARD_MODE_ZOOM=17,this.BOARD_MODE_CONSTRUCT=16,this.CONSTRUCTION_TYPE_POINT=1129599060,this.CONSTRUCTION_TYPE_CIRCLE=1129595724,this.CONSTRUCTION_TYPE_LINE=1129598030,this.CONSTRUCTION_TYPE_GLIDER=1129596740,this.CONSTRUCTION_TYPE_MIDPOINT=1129598288,this.CONSTRUCTION_TYPE_PERPENDICULAR=1129599044,this.CONSTRUCTION_TYPE_PARALLEL=1129599052,this.CONSTRUCTION_TYPE_INTERSECTION=1129597267,this.container=e,this.containerObj="undefined"!=typeof document?document.getElementById(this.container):null,"undefined"!=typeof document&&null==this.containerObj)throw Error("\nJSXGraph: HTML container element '"+e+"' not found.");this.renderer=t,this.grids=[],this.options=JXG.deepCopy(JXG.Options),this.dimension=2,this.jc=new JXG.JessieCode,this.jc.use(this),this.origin={},this.origin.usrCoords=[1,0,0],this.origin.scrCoords=[1,n[0],n[1]],this.zoomX=r,this.zoomY=o,this.unitX=a*this.zoomX,this.unitY=s*this.zoomY,this.canvasWidth=l,this.canvasHeight=c,this.id=JXG.exists(i)&&""!==i&&"undefined"!=typeof document&&!JXG.exists(document.getElementById(i))?i:this.generateId(),JXG.EventEmitter.eventify(this),this.hooks=[],this.dependentBoards=[],this.inUpdate=!1,this.objects={},this.objectsList=[],this.groups={},this.animationObjects={},this.highlightedObjects={},this.numObjects=0,this.elementsByName={},this.mode=this.BOARD_MODE_NONE,this.updateQuality=this.BOARD_QUALITY_HIGH,this.isSuspendedRedraw=!1,this.calculateSnapSizes(),this.drag_dx=0,this.drag_dy=0,this.mouse=null,this.touches=[],this.xmlString="",this.cPos=[],this.touchMoveLast=0,this.downObjects=[],this.showCopyright=!1,(null!=u&&u||null==u&&this.options.showCopyright)&&(this.showCopyright=!0,this.renderer.displayCopyright(JXG.JSXGraph.licenseText,parseInt(this.options.text.fontSize))),this.needsFullUpdate=!1,this.reducedUpdate=!1,this.currentCBDef="none",this.geonextCompatibilityMode=!1,this.options.text.useASCIIMathML&&translateASCIIMath?init():this.options.text.useASCIIMathML=!1,this.hasMouseHandlers=!1,this.hasTouchHandlers=!1,this.hasMouseUp=!1,this.hasTouchEnd=!1,this.addEventHandlers(),this.methodMap={update:"update",on:"on",off:"off",setView:"setBoundingBox",setBoundingBox:"setBoundingBox",migratePoint:"migratePoint",colorblind:"emulateColorblindness"}},JXG.extend(JXG.Board.prototype,{generateName:function(e){if(e.type==JXG.OBJECT_TYPE_TICKS)return"";var t,i,n=2,r="",o="",a=[],s="";for(t=e.elementClass==JXG.OBJECT_CLASS_POINT?["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]:e.type==JXG.OBJECT_TYPE_ANGLE?["","&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta;","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"]:["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],e.elementClass!==JXG.OBJECT_CLASS_POINT&&e.elementClass!=JXG.OBJECT_CLASS_LINE&&e.type!=JXG.OBJECT_TYPE_ANGLE&&(r=e.type===JXG.OBJECT_TYPE_POLYGON?"P_{":e.elementClass===JXG.OBJECT_CLASS_CIRCLE?"k_{":e.type===JXG.OBJECT_TYPE_TEXT?"t_{":"s_{",o="}"),i=0;n>i;i++)a[i]=0;for(;a[n-1]<t.length;){for(a[0]=1;a[0]<t.length;a[0]++){for(s=r,i=n;i>0;i--)s+=t[a[i-1]];if(null==this.elementsByName[s+o])return s+o}for(a[0]=t.length,i=1;n>i;i++)a[i-1]==t.length&&(a[i-1]=1,a[i]++)}return""},generateId:function(){for(var e=1;null!=JXG.JSXGraph.boards["jxgBoard"+e];)e=Math.round(65535*Math.random());return"jxgBoard"+e},setId:function(e,t){var i=this.numObjects++,n=e.id;return""!=n&&JXG.exists(n)||(n=this.id+t+i),e.id=n,this.objects[n]=e,e._pos=this.objectsList.length,this.objectsList[this.objectsList.length]=e,n},finalizeAdding:function(e){e.visProp.visible||this.renderer.hide(e)},finalizeLabel:function(e){e.hasLabel&&!e.label.content.visProp.islabel&&!e.label.content.visProp.visible&&this.renderer.hide(e.label.content)},getCoordsTopLeftCorner:function(){var e=this.containerObj,t=JXG.getOffset(e),i=document.documentElement.ownerDocument,n=function(t){var i=parseInt(JXG.getStyle(e,t));return isNaN(i)?0:i};return this.cPos.length>0&&(this.mode===JXG.BOARD_MODE_DRAG||this.mode===JXG.BOARD_MODE_MOVE_ORIGIN)?this.cPos:(!e.currentStyle&&i.defaultView&&(e=document.documentElement,t[0]+=n("margin-left"),t[1]+=n("margin-top"),t[0]+=n("border-left-width"),t[1]+=n("border-top-width"),t[0]+=n("padding-left"),t[1]+=n("padding-top"),e=this.containerObj),t[0]+=n("border-left-width"),t[1]+=n("border-top-width"),"vml"!==this.renderer.type&&(t[0]+=n("padding-left"),t[1]+=n("padding-top")),this.cPos=t,t)},getMousePosition:function(e,t){var i,n=this.getCoordsTopLeftCorner();return i=JXG.getPosition(e,t),[i[0]-n[0],i[1]-n[1]]},initMoveOrigin:function(e,t){this.drag_dx=e-this.origin.scrCoords[1],this.drag_dy=t-this.origin.scrCoords[2],this.mode=this.BOARD_MODE_MOVE_ORIGIN},initMoveObject:function(e,t,i,n){var r,o,a,s=[],l=this.objectsList.length,c={visProp:{layer:-1e4}};for(o=0;l>o;o++)if(r=this.objectsList[o],a=r.hasPoint&&r.hasPoint(e,t),r.visProp.visible&&a&&(r.triggerEventHandlers([n+"down","down"],i),this.downObjects.push(r)),(this.geonextCompatibilityMode&&(r.elementClass==JXG.OBJECT_CLASS_POINT||r.type==JXG.OBJECT_TYPE_TEXT)||!this.geonextCompatibilityMode)&&r.isDraggable&&r.visProp.visible&&!r.visProp.fixed&&!r.visProp.frozen&&a&&r.visProp.layer>=c.visProp.layer){if(JXG.exists(c.label)&&r==c.label.content)continue;c=r,s[0]=c}return s.length>0&&(this.mode=this.BOARD_MODE_DRAG),this.options.takeFirst&&(s.length=1),s},moveObject:function(e,t,i,n,r){var o,a=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(e,t),this),s=i.obj;s.type!=JXG.OBJECT_TYPE_GLIDER?(isNaN(i.targets[0].Xprev+i.targets[0].Yprev)||s.setPositionDirectly(JXG.COORDS_BY_SCREEN,a.scrCoords.slice(1),[i.targets[0].Xprev,i.targets[0].Yprev]),i.targets[0].Xprev=a.scrCoords[1],i.targets[0].Yprev=a.scrCoords[2],this.update(s)):s.type==JXG.OBJECT_TYPE_GLIDER&&(o=s.coords,s.setPositionDirectly(JXG.COORDS_BY_USER,a.usrCoords.slice(1)),s.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE?s.coords=JXG.Math.Geometry.projectPointToCircle(s,s.slideObject,this):s.slideObject.elementClass==JXG.OBJECT_CLASS_LINE&&(s.coords=JXG.Math.Geometry.projectPointToLine(s,s.slideObject,this)),0!=s.group.length?(s.group[s.group.length-1].dX=s.coords.scrCoords[1]-o.scrCoords[1],s.group[s.group.length-1].dY=s.coords.scrCoords[2]-o.scrCoords[2],s.group[s.group.length-1].update(this)):this.update(s)),s.triggerEventHandlers([r+"drag","drag"],n),this.updateInfobox(s),this.update(),s.highlight(!0)},twoFingerMove:function(e,t,i,n){var r,o,a;JXG.exists(i)&&JXG.exists(i.obj)&&(a=i.obj,r=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(e[0],e[1]),this),o=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(t[0],t[1]),this),a.elementClass===JXG.OBJECT_CLASS_LINE||a.type===JXG.OBJECT_TYPE_POLYGON?this.twoFingerTouchObject(r,o,i,a):a.elementClass===JXG.OBJECT_CLASS_CIRCLE&&this.twoFingerTouchCircle(r,o,i,a),a.triggerEventHandlers(["touchdrag","drag"],n),i.targets[0].Xprev=r.scrCoords[1],i.targets[0].Yprev=r.scrCoords[2],i.targets[1].Xprev=o.scrCoords[1],i.targets[1].Yprev=o.scrCoords[2])},twoFingerTouchObject:function(e,t,i,n){var r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y;if(JXG.exists(i.targets[0])&&JXG.exists(i.targets[1])&&!isNaN(i.targets[0].Xprev+i.targets[0].Yprev+i.targets[1].Xprev+i.targets[1].Yprev)){if(r=e.usrCoords,o=t.usrCoords,a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[i.targets[0].Xprev,i.targets[0].Yprev],this).usrCoords,s=new JXG.Coords(JXG.COORDS_BY_SCREEN,[i.targets[1].Xprev,i.targets[1].Yprev],this).usrCoords,c=[1,.5*(a[1]+s[1]),.5*(a[2]+s[2])],l=[1,.5*(r[1]+o[1]),.5*(r[2]+o[2])],d=JXG.Math.crossProduct(a,s),u=JXG.Math.crossProduct(r,o),p=JXG.Math.crossProduct(d,u),Math.abs(p[0])<JXG.Math.eps)return;p[1]/=p[0],p[2]/=p[0],f=JXG.Math.Geometry.rad(c.slice(1),p.slice(1),l.slice(1)),g=this.create("transform",[f,p[1],p[2]],{type:"rotate"}),g.update(),c=JXG.Math.matVecMult(g.matrix,c),c[1]/=c[0],c[2]/=c[0],m=this.create("transform",[l[1]-c[1],l[2]-c[2]],{type:"translate"}),m.update(),g.melt(m),n.visProp.scalable&&(h=JXG.Math.Geometry.distance(r,o)/JXG.Math.Geometry.distance(a,s),b=this.create("transform",[-l[1],-l[2]],{type:"translate"}),v=this.create("transform",[h,h],{type:"scale"}),y=this.create("transform",[l[1],l[2]],{type:"translate"}),g.melt(b).melt(v).melt(y)),n.elementClass===JXG.OBJECT_CLASS_LINE?g.applyOnce([n.point1,n.point2]):n.type===JXG.OBJECT_TYPE_POLYGON&&g.applyOnce(n.vertices.slice(0,-1)),this.update(),n.highlight(!0)}},twoFingerTouchCircle:function(e,t,i,n){var r,o,a,s,l,c,u,d,h,p,f;"pointCircle"!==n.method&&"pointLine"!==n.method&&JXG.exists(i.targets[0])&&JXG.exists(i.targets[1])&&!isNaN(i.targets[0].Xprev+i.targets[0].Yprev+i.targets[1].Xprev+i.targets[1].Yprev)&&(r=e.usrCoords,o=t.usrCoords,a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[i.targets[0].Xprev,i.targets[0].Yprev],this).usrCoords,s=new JXG.Coords(JXG.COORDS_BY_SCREEN,[i.targets[1].Xprev,i.targets[1].Yprev],this).usrCoords,u=this.create("transform",[r[1]-a[1],r[2]-a[2]],{type:"translate"}),c=JXG.Math.Geometry.rad(s.slice(1),r.slice(1),o.slice(1)),d=this.create("transform",[-r[1],-r[2]],{type:"translate"}),h=this.create("transform",[c],{type:"rotate"}),u.melt(d).melt(h),n.visProp.scalable&&(l=JXG.Math.Geometry.distance(r,o)/JXG.Math.Geometry.distance(a,s),p=this.create("transform",[l,l],{type:"scale"}),u.melt(p)),f=this.create("transform",[r[1],r[2]],{type:"translate"}),u.melt(f),u.applyOnce([n.center]),"twoPoints"===n.method?u.applyOnce([n.point2]):"pointRadius"===n.method&&JXG.isNumber(n.updateRadius.origin)&&n.setRadius(n.radius*l),this.update(n.center),n.highlight(!0))},highlightElements:function(e,t,i,n){var r,o,a,s=this.objectsList.length;for(r=0;s>r;r++)o=this.objectsList[r],a=o.id,o.visProp.highlight&&JXG.exists(o.hasPoint)&&o.visProp.visible&&o.hasPoint(e,t)&&(this.updateInfobox(o),JXG.exists(this.highlightedObjects[a])||(this.highlightedObjects[a]=o,o.highlight(),this.triggerEventHandlers(["mousehit","hit"],i,o,n)),o.mouseover?o.triggerEventHandlers(["mousemove","move"],i):(o.triggerEventHandlers(["mouseover","over"],i),o.mouseover=!0));for(r=0;s>r;r++)o=this.objectsList[r],a=o.id,o.mouseover&&(this.highlightedObjects[a]||(o.triggerEventHandlers(["mouseout","out"],i),o.mouseover=!1))},saveStartPos:function(e,t){var i,n,r=[];if(e.elementClass==JXG.OBJECT_CLASS_LINE)r.push(e.point1.coords.usrCoords),r.push(e.point2.coords.usrCoords);else if(e.elementClass==JXG.OBJECT_CLASS_CIRCLE)r.push(e.center.coords.usrCoords);else if(e.type==JXG.OBJECT_TYPE_GLIDER)r.push([e.position,e.position,e.position]);else if(e.type==JXG.OBJECT_TYPE_POLYGON)for(n=e.vertices.length-1,i=0;n>i;i++)r.push(e.vertices[i].coords.usrCoords);else if(e.elementClass==JXG.OBJECT_CLASS_POINT)r.push(e.coords.usrCoords);else try{r.push(e.coords.usrCoords)}catch(o){JXG.debug("JSXGraph+ saveStartPos: obj.coords.usrCoords not available: "+o)}for(n=r.length,i=0;n>i;i++)t.Zstart.push(r[i][0]),t.Xstart.push(r[i][1]),t.Ystart.push(r[i][2])},mouseOriginMoveStart:function(e){var t=this.options.pan.enabled&&(!this.options.pan.needShift||e.shiftKey);if(t){var i=this.getMousePosition(e);this.initMoveOrigin(i[0],i[1])}return t},mouseOriginMove:function(e){var t=this.mode===this.BOARD_MODE_MOVE_ORIGIN;if(t){var i=this.getMousePosition(e);this.moveOrigin(i[0],i[1],!0)}return t},touchOriginMoveStart:function(e){var t=e[JXG.touchProperty],i=2==t.length&&80>JXG.Math.Geometry.distance([t[0].screenX,t[0].screenY],[t[1].screenX,t[1].screenY]),n=this.options.pan.enabled&&(!this.options.pan.needTwoFingers||i);if(n){var r=this.getMousePosition(e,0);this.initMoveOrigin(r[0],r[1])}return n},touchOriginMove:function(e){var t=this.mode===this.BOARD_MODE_MOVE_ORIGIN;if(t){var i=this.getMousePosition(e,0);this.moveOrigin(i[0],i[1],!0)}return t},originMoveEnd:function(){this.mode=this.BOARD_MODE_NONE},addEventHandlers:function(){this.addMouseEventHandlers(),this.addTouchEventHandlers()},addMouseEventHandlers:function(){!this.hasMouseHandlers&&"undefined"!=typeof document&&(JXG.addEvent(this.containerObj,"mousedown",this.mouseDownListener,this),JXG.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),JXG.addEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),JXG.addEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!0,this.containerObj.oncontextmenu=function(e){return JXG.exists(e)&&e.preventDefault(),!1})},addTouchEventHandlers:function(){!this.hasTouchHandlers&&"undefined"!=typeof document&&(JXG.addEvent(this.containerObj,"touchstart",this.touchStartListener,this),JXG.addEvent(this.containerObj,"touchmove",this.touchMoveListener,this),JXG.addEvent(this.containerObj,"gesturestart",this.gestureStartListener,this),JXG.addEvent(this.containerObj,"gesturechange",this.gestureChangeListener,this),this.hasTouchHandlers=!0)},removeMouseEventHandlers:function(){this.hasMouseHandlers&&"undefined"!=typeof document&&(JXG.removeEvent(this.containerObj,"mousedown",this.mouseDownListener,this),JXG.removeEvent(this.containerObj,"mousemove",this.mouseMoveListener,this),this.hasMouseUp&&(JXG.removeEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),JXG.removeEvent(this.containerObj,"mousewheel",this.mouseWheelListener,this),JXG.removeEvent(this.containerObj,"DOMMouseScroll",this.mouseWheelListener,this),this.hasMouseHandlers=!1)},removeTouchEventHandlers:function(){this.hasTouchHandlers&&"undefined"!=typeof document&&(JXG.removeEvent(this.containerObj,"touchstart",this.touchStartListener,this),JXG.removeEvent(this.containerObj,"touchmove",this.touchMoveListener,this),this.hasTouchEnd&&(JXG.removeEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1),JXG.removeEvent(this.containerObj,"gesturestart",this.gestureStartListener,this),JXG.removeEvent(this.containerObj,"gesturechange",this.gestureChangeListener,this),this.hasTouchHandlers=!1)},removeEventHandlers:function(){this.removeMouseEventHandlers(),this.removeTouchEventHandlers()},clickLeftArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]+.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickRightArrow:function(){return this.moveOrigin(this.origin.scrCoords[1]-.1*this.canvasWidth,this.origin.scrCoords[2]),this},clickUpArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]-.1*this.canvasHeight),this},clickDownArrow:function(){return this.moveOrigin(this.origin.scrCoords[1],this.origin.scrCoords[2]+.1*this.canvasHeight),this},gestureChangeListener:function(e){var t,i=this.options.zoom.factorX,n=this.options.zoom.factorY;return this.options.zoom.wheel?(e.preventDefault(),this.mode===this.BOARD_MODE_NONE&&(t=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getMousePosition(e),this),this.options.zoom.factorX=e.scale/this.prevScale,this.options.zoom.factorY=e.scale/this.prevScale,this.zoomIn(t.usrCoords[1],t.usrCoords[2]),this.prevScale=e.scale,this.options.zoom.factorX=i,this.options.zoom.factorY=n),!1):!0},gestureStartListener:function(e){return this.options.zoom.wheel?(e.preventDefault(),this.prevScale=1,!1):!0},touchStartListener:function(e,t){var i,n,r,o,a,s,l,c,u=this.options.precision.touch,d=e[JXG.touchProperty];for(this.hasTouchEnd||(JXG.addEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!0),this.hasMouseHandlers&&this.removeMouseEventHandlers(),document.selection&&"function"==typeof document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.options.precision.hasPoint=this.options.precision.touch,i=0;d.length>i;i++)d[i].jxg_isused=!1;
for(i=0;this.touches.length>i;i++)for(o=0;this.touches[i].targets.length>o;o++){this.touches[i].targets[o].num=-1,u=this.options.precision.touch;do{for(a=0;d.length>a;a++)if(u*u>Math.abs(Math.pow(d[a].screenX-this.touches[i].targets[o].X,2)+Math.pow(d[a].screenY-this.touches[i].targets[o].Y,2))){this.touches[i].targets[o].num=a,this.touches[i].targets[o].X=d[a].screenX,this.touches[i].targets[o].Y=d[a].screenY,d[a].jxg_isused=!0;break}u*=2}while(-1==this.touches[i].targets[o].num&&this.options.precision.touchMax>u);-1===this.touches[i].targets[o].num&&(JXG.debug("i couldn't find a targettouches for target no "+o+" on "+this.touches[i].obj.name+" ("+this.touches[i].obj.id+"). Removed the target."),JXG.debug("eps = "+u+", touchMax = "+JXG.Options.precision.touchMax),this.touches[i].targets.splice(i,1))}for(i=0;d.length>i;i++)if(t||!d[i].jxg_isused){if(n=this.getMousePosition(e,i),t?(r=[t],this.mode=this.BOARD_MODE_DRAG):r=this.initMoveObject(n[0],n[1],e,"touch"),0!=r.length)if(s=r[r.length-1],JXG.isPoint(s)||s.type===JXG.OBJECT_TYPE_TEXT||s.type===JXG.OBJECT_TYPE_TICKS)c=[{num:i,X:d[i].screenX,Y:d[i].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(s,c[0]),this.touches.push({obj:s,targets:c}),this.highlightedObjects[s.id]=s,s.highlight(!0);else if(s.elementClass===JXG.OBJECT_CLASS_LINE||s.elementClass===JXG.OBJECT_CLASS_CIRCLE||s.type===JXG.OBJECT_TYPE_POLYGON){for(l=!1,o=0;this.touches.length>o;o++)if(s.id===this.touches[o].obj.id){if(l=!0,1===this.touches[o].targets.length){var h={num:i,X:d[i].screenX,Y:d[i].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]};this.saveStartPos(s,h),this.touches[o].targets.push(h)}d[i].jxg_isused=!0}l||(c=[{num:i,X:d[i].screenX,Y:d[i].screenY,Xprev:0/0,Yprev:0/0,Xstart:[],Ystart:[],Zstart:[]}],this.saveStartPos(s,c[0]),this.touches.push({obj:s,targets:c}),this.highlightedObjects[s.id]=s,s.highlight(!0))}d[i].jxg_isused=!0}if(this.touches.length>0&&(e.preventDefault(),e.stopPropagation()),this.mode===this.BOARD_MODE_NONE&&this.touchOriginMoveStart(e))return this.triggerEventHandlers(["touchstart","down"],e),!1;if(JXG.isWebkitAndroid()){var p=new Date;this.touchMoveLast=p.getTime()-200}return this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchstart","down"],e),this.touches.length>0},touchMoveListener:function(e){var t,i,n=e[JXG.touchProperty];if(this.mode!==this.BOARD_MODE_NONE&&(e.preventDefault(),e.stopPropagation()),JXG.isWebkitAndroid()){var r=new Date;if(r=r.getTime(),80>r-this.touchMoveLast)return this.updateQuality=this.BOARD_QUALITY_HIGH,this.triggerEventHandlers(["touchmove","move"],e,this.mode),!1;this.touchMoveLast=r}if(this.mode!=this.BOARD_MODE_DRAG&&this.renderer.hide(this.infobox),this.options.precision.hasPoint=this.options.precision.touch,!this.touchOriginMove(e)&&this.mode==this.BOARD_MODE_DRAG)for(t=0;this.touches.length>t;t++)1===this.touches[t].targets.length?n[this.touches[t].targets[0].num]&&(this.touches[t].targets[0].X=n[this.touches[t].targets[0].num].screenX,this.touches[t].targets[0].Y=n[this.touches[t].targets[0].num].screenY,i=this.getMousePosition(e,this.touches[t].targets[0].num),this.moveObject(i[0],i[1],this.touches[t],e,"touch")):2===this.touches[t].targets.length&&this.touches[t].targets[0].num>-1&&this.touches[t].targets[1].num>-1&&n[this.touches[t].targets[0].num]&&n[this.touches[t].targets[1].num]&&(this.touches[t].targets[0].X=n[this.touches[t].targets[0].num].screenX,this.touches[t].targets[0].Y=n[this.touches[t].targets[0].num].screenY,this.touches[t].targets[1].X=n[this.touches[t].targets[1].num].screenX,this.touches[t].targets[1].Y=n[this.touches[t].targets[1].num].screenY,this.twoFingerMove(this.getMousePosition(e,this.touches[t].targets[0].num),this.getMousePosition(e,this.touches[t].targets[1].num),this.touches[t],e));return this.mode!=this.BOARD_MODE_DRAG&&this.renderer.hide(this.infobox),this.options.precision.hasPoint=this.options.precision.mouse,this.triggerEventHandlers(["touchmove","move"],e,this.mode),this.mode===this.BOARD_MODE_NONE},touchEndListener:function(e){var t,i,n,r,o,a=this.options.precision.touch,s=[],l=e[JXG.touchProperty];if(this.triggerEventHandlers(["touchend","up"],e),this.renderer.hide(this.infobox),l.length>0){for(t=0;this.touches.length>t;t++)s[t]=this.touches[t];for(this.touches.length=0,t=0;l.length>t;t++)l[t].jxg_isused=!1;for(t=0;s.length>t;t++){for(r=!1,o=0,i=0;s[t].targets.length>i;i++)for(s[t].targets[i].found=!1,n=0;l.length>n;n++)if(a*a>Math.abs(Math.pow(l[n].screenX-s[t].targets[i].X,2)+Math.pow(l[n].screenY-s[t].targets[i].Y,2))){s[t].targets[i].found=!0,s[t].targets[i].num=n,s[t].targets[i].X=l[n].screenX,s[t].targets[i].Y=l[n].screenY,o++;break}if(JXG.isPoint(s[t].obj)?r=s[t].targets[0]&&s[t].targets[0].found:s[t].obj.elementClass===JXG.OBJECT_CLASS_LINE?r=s[t].targets[0]&&s[t].targets[0].found||s[t].targets[1]&&s[t].targets[1].found:s[t].obj.elementClass===JXG.OBJECT_CLASS_CIRCLE&&(r=1===o||3===o),r)for(this.touches.push({obj:s[t].obj,targets:[]}),i=0;s[t].targets.length>i;i++)s[t].targets[i].found&&this.touches[this.touches.length-1].targets.push({num:s[t].targets[i].num,X:s[t].targets[i].screenX,Y:s[t].targets[i].screenY,Xprev:0/0,Yprev:0/0,Xstart:s[t].targets[i].Xstart,Ystart:s[t].targets[i].Ystart,Zstart:s[t].targets[i].Zstart});else delete this.highlightedObjects[s[t].obj.id],s[t].obj.noHighlight()}}else this.touches.length=0;for(t=0;this.downObjects.length>t;t++){for(r=!1,i=0;this.touches.length>i;i++)this.touches[i].obj.id==this.downObjects[t].id&&(r=!0);r||(this.downObjects[t].triggerEventHandlers(["touchup","up"],e),this.downObjects[t].snapToGrid(),this.downObjects.splice(t,1))}return l&&0!==l.length||(JXG.removeEvent(document,"touchend",this.touchEndListener,this),this.hasTouchEnd=!1,this.dehighlightAll(),this.updateQuality=this.BOARD_QUALITY_HIGH,this.originMoveEnd(),this.update()),!0},mouseDownListener:function(e,t){var i,n,r;return document.selection&&"function"==typeof document.selection.empty?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),this.hasMouseUp||(JXG.addEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!0),i=this.getMousePosition(e),t?(n=[t],this.mode=this.BOARD_MODE_DRAG):n=this.initMoveObject(i[0],i[1],e,"mouse"),0==n.length?(this.mode=this.BOARD_MODE_NONE,r=!0):(this.mouse={obj:null,targets:[{X:i[0],Y:i[1],Xprev:0/0,Yprev:0/0}]},this.mouse.obj=n[n.length-1],this.dehighlightAll(),this.highlightedObjects[this.mouse.obj.id]=this.mouse.obj,this.mouse.obj.highlight(!0),this.mouse.targets[0].Xstart=[],this.mouse.targets[0].Ystart=[],this.mouse.targets[0].Zstart=[],this.saveStartPos(this.mouse.obj,this.mouse.targets[0]),e&&e.preventDefault?e.preventDefault():window.event&&(window.event.returnValue=!1)),this.mode===this.BOARD_MODE_NONE&&(r=this.mouseOriginMoveStart(e)),t||this.triggerEventHandlers(["mousedown","down"],e),r},mouseUpListener:function(e){var t;for(this.triggerEventHandlers(["mouseup","up"],e),this.updateQuality=this.BOARD_QUALITY_HIGH,this.mouse&&this.mouse.obj&&this.mouse.obj.snapToGrid(),this.originMoveEnd(),this.dehighlightAll(),this.update(),t=0;this.downObjects.length>t;t++)this.downObjects[t].triggerEventHandlers(["mouseup","up"],e);this.downObjects.length=0,this.hasMouseUp&&(JXG.removeEvent(document,"mouseup",this.mouseUpListener,this),this.hasMouseUp=!1),this.mouse=null},mouseMoveListener:function(e){var t;t=this.getMousePosition(e),this.updateQuality=this.BOARD_QUALITY_LOW,this.mode!=this.BOARD_MODE_DRAG&&(this.dehighlightAll(),this.renderer.hide(this.infobox)),this.mouseOriginMove(e)||(this.mode==this.BOARD_MODE_DRAG?this.moveObject(t[0],t[1],this.mouse,e,"mouse"):this.highlightElements(t[0],t[1],e,-1)),this.updateQuality=this.BOARD_QUALITY_HIGH,this.triggerEventHandlers(["mousemove","move"],e,this.mode)},mouseWheelListener:function(e){if(!this.options.zoom.wheel||this.options.zoom.needShift&&!e.shiftKey)return!0;e=e||window.event;var t=e.detail?-1*e.detail:e.wheelDelta/40,i=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getMousePosition(e),this);return t>0?this.zoomIn(i.usrCoords[1],i.usrCoords[2]):this.zoomOut(i.usrCoords[1],i.usrCoords[2]),e.preventDefault(),!1},updateInfobox:function(e){var t,i,n,r;return e.visProp.showinfobox?(e.elementClass==JXG.OBJECT_CLASS_POINT&&(n=e.coords.usrCoords[1],r=e.coords.usrCoords[2],this.infobox.setCoords(n+this.infobox.distanceX/this.unitX,r+this.infobox.distanceY/this.unitY),"string"!=typeof e.infoboxText?("auto"===e.visProp.infoboxdigits?(t=JXG.autoDigits(n),i=JXG.autoDigits(r)):JXG.isNumber(e.visProp.infoboxdigits)?(t=n.toFixed(e.visProp.infoboxdigits),i=r.toFixed(e.visProp.infoboxdigits)):(t=n,i=r),this.highlightInfobox(t,i,e)):this.highlightCustomInfobox(e.infoboxText,e),this.renderer.show(this.infobox)),this):this},highlightCustomInfobox:function(e){return this.infobox.setText(e),this},highlightInfobox:function(e,t){return this.highlightCustomInfobox("("+e+", "+t+")"),this},dehighlightAll:function(){var e,t,i=!1;for(e in this.highlightedObjects)t=this.highlightedObjects[e],this.hasMouseHandlers&&t.noHighlight(),i=!0;return this.highlightedObjects={},"canvas"==this.options.renderer&&i&&(this.prepareUpdate(),this.renderer.suspendRedraw(this),this.updateRenderer(),this.renderer.unsuspendRedraw()),this},getScrCoordsOfMouse:function(e,t){return[e,t]},getUsrCoordsOfMouse:function(e){var t=this.getCoordsTopLeftCorner(),i=JXG.getPosition(e),n=i[0]-t[0],r=i[1]-t[1],o=new JXG.Coords(JXG.COORDS_BY_SCREEN,[n,r],this);return o.usrCoords.slice(1)},getAllUnderMouse:function(e){var t=this.getAllObjectsUnderMouse(e);return t.push(this.getUsrCoordsOfMouse(e)),t},getAllObjectsUnderMouse:function(e){var t,i,n=this.getCoordsTopLeftCorner(),r=JXG.getPosition(e),o=r[0]-n[0],a=r[1]-n[1],s=[],l=this.objectsList.length;for(t=0;l>t;t++)i=this.objectsList[t],i.visProp.visible&&i.hasPoint&&i.hasPoint(o,a)&&(s[s.length]=i);return s},moveOrigin:function(e,t,i){var n,r,o=this.objectsList.length;for(JXG.exists(e)&&JXG.exists(t)&&(this.origin.scrCoords[1]=e,this.origin.scrCoords[2]=t,i&&(this.origin.scrCoords[1]-=this.drag_dx,this.origin.scrCoords[2]-=this.drag_dy)),r=0;o>r;r++)n=this.objectsList[r],!n.visProp.frozen&&(n.elementClass==JXG.OBJECT_CLASS_POINT||n.elementClass==JXG.OBJECT_CLASS_CURVE||n.type==JXG.OBJECT_TYPE_AXIS||n.type==JXG.OBJECT_TYPE_TEXT)&&n.elementClass!=JXG.OBJECT_CLASS_CURVE&&n.type!=JXG.OBJECT_TYPE_AXIS&&n.coords.usr2screen();return this.clearTraces(),this.fullUpdate(),this},addConditions:function(e){var t,i,n,r,o,a,s="var el, x, y, c, rgbo;\n",l=e.indexOf("<data>"),c=e.indexOf("</data>");if(!(0>l)){for(;l>=0;){t=e.slice(l+6,c),i=t.indexOf("="),n=t.slice(0,i),r=t.slice(i+1),i=n.indexOf("."),o=n.slice(0,i),a=this.elementsByName[JXG.unescapeHTML(o)];var u=n.slice(i+1).replace(/\s+/g,"").toLowerCase();switch(r=JXG.GeonextParser.geonext2JS(r,this),r=r.replace(/this\.board\./g,"this."),JXG.exists(this.elementsByName[o])||JXG.debug("debug conditions: |"+o+"| undefined"),s+='el = this.objects["'+a.id+'"];\n',u){case"x":s+="var y=el.coords.usrCoords[2];\n",s+="el.setPositionDirectly(JXG.COORDS_BY_USER,["+r+",y]);\n",s+="el.prepareUpdate().update();\n";break;case"y":s+="var x=el.coords.usrCoords[1];\n",s+="el.coords=new JXG.Coords(JXG.COORDS_BY_USER,[x,"+r+"],this);\n",s+="el.setPositionDirectly(JXG.COORDS_BY_USER,[x,"+r+"]);\n",s+="el.prepareUpdate().update();\n";break;case"visible":s+="var c="+r+";\n",s+="el.visProp.visible = c;\n",s+="if (c) {el.showElement();} else {el.hideElement();}\n";break;case"position":s+="el.position = "+r+";\n",s+="el.prepareUpdate().update(true);\n";break;case"stroke":s+="rgbo = JXG.rgba2rgbo("+r+");\n",s+="el.visProp.strokecolor = rgbo[0];\n",s+="el.visProp.strokeopacity = rgbo[1];\n";break;case"style":s+="el.setStyle("+r+");\n";break;case"strokewidth":s+="el.strokeWidth = "+r+";\n";break;case"fill":s+="var rgbo = JXG.rgba2rgbo("+r+");\n",s+="el.visProp.fillcolor = rgbo[0];\n",s+="el.visProp.fillopacity = rgbo[1];\n";break;case"label":break;default:JXG.debug("property '"+u+"' in conditions not yet implemented:"+r)}e=e.slice(c+7),l=e.indexOf("<data>"),c=e.indexOf("</data>")}s+="this.prepareUpdate().updateElements();\n",s+="return true;\n",s=s.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"),s=s.replace(/&amp;/g,"&"),this.updateConditions=Function(s),this.updateConditions()}},updateConditions:function(){return!1},calculateSnapSizes:function(){var e=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this),t=new JXG.Coords(JXG.COORDS_BY_USER,[this.options.grid.gridX,this.options.grid.gridY],this),i=e.scrCoords[1]-t.scrCoords[1],n=e.scrCoords[2]-t.scrCoords[2];for(this.options.grid.snapSizeX=this.options.grid.gridX;Math.abs(i)>25;)this.options.grid.snapSizeX*=2,i/=2;for(this.options.grid.snapSizeY=this.options.grid.gridY;Math.abs(n)>25;)this.options.grid.snapSizeY*=2,n/=2;return this},applyZoom:function(){var e,t,i=this.objectsList.length;for(t=0;i>t;t++)e=this.objectsList[t],!e.visProp.frozen&&(e.elementClass==JXG.OBJECT_CLASS_POINT||e.elementClass==JXG.OBJECT_CLASS_CURVE||e.type==JXG.OBJECT_TYPE_AXIS||e.type==JXG.OBJECT_TYPE_TEXT)&&e.elementClass!=JXG.OBJECT_CLASS_CURVE&&e.type!=JXG.OBJECT_TYPE_AXIS&&e.coords.usr2screen();return this.calculateSnapSizes(),this.clearTraces(),this.fullUpdate(),this},zoomIn:function(e,t){var i=this.getBoundingBox(),n=this.options.zoom.factorX,r=this.options.zoom.factorY,o=(i[2]-i[0])*(1-1/n),a=(i[1]-i[3])*(1-1/r),s=.5,l=.5;return"number"==typeof e&&"number"==typeof t&&(s=(e-i[0])/(i[2]-i[0]),l=(i[1]-t)/(i[1]-i[3])),this.setBoundingBox([i[0]+o*s,i[1]-a*l,i[2]-o*(1-s),i[3]+a*(1-l)],!1),this.zoomX*=n,this.zoomY*=r,this.applyZoom(),this},zoomOut:function(e,t){var i=this.getBoundingBox(),n=this.options.zoom.factorX,r=this.options.zoom.factorY,o=(i[2]-i[0])*(1-n),a=(i[1]-i[3])*(1-r),s=.5,l=.5;return this.zoomX<JXG.Options.zoom.eps||this.zoomY<JXG.Options.zoom.eps?this:("number"==typeof e&&"number"==typeof t&&(s=(e-i[0])/(i[2]-i[0]),l=(i[1]-t)/(i[1]-i[3])),this.setBoundingBox([i[0]+o*s,i[1]-a*l,i[2]-o*(1-s),i[3]+a*(1-l)],!1),this.zoomX/=n,this.zoomY/=r,this.applyZoom(),this)},zoom100:function(){var e=this.getBoundingBox(),t=.5*(e[2]-e[0])*(1-this.zoomX),i=.5*(e[1]-e[3])*(1-this.zoomY);return this.setBoundingBox([e[0]+t,e[1]-i,e[2]-t,e[3]+i],!1),this.zoomX=1,this.zoomY=1,this.applyZoom(),this},zoomAllPoints:function(){var e,t,i,n,r,o=0,a=0,s=0,l=0,c=this.objectsList.length;for(e=0;c>e;e++)r=this.objectsList[e],JXG.isPoint(r)&&r.visProp.visible&&(o>r.coords.usrCoords[1]?o=r.coords.usrCoords[1]:r.coords.usrCoords[1]>a&&(a=r.coords.usrCoords[1]),r.coords.usrCoords[2]>l?l=r.coords.usrCoords[2]:s>r.coords.usrCoords[2]&&(s=r.coords.usrCoords[2]));return t=50,i=t/this.unitX,n=t/this.unitY,this.zoomX=1,this.zoomY=1,this.setBoundingBox([o-i,l+n,a+i,s-n],!0),this.applyZoom(),this},zoomElements:function(e){var t,i,n,r,o=[0,0,0,0],a=[1,-1,-1,1];if(!JXG.isArray(e)||0===e.length)return this;for(t=0;e.length>t;t++)if(n=JXG.getRef(this,e[t]),r=n.bounds(),JXG.isArray(r))if(JXG.isArray(o))for(i=0;4>i;i++)a[i]*r[i]<a[i]*o[i]&&(o[i]=r[i]);else o=r;if(JXG.isArray(o)){for(i=0;4>i;i++)o[i]-=a[i];this.zoomX=1,this.zoomY=1,this.setBoundingBox(o,!0)}return this},setZoom:function(e,t){var i=this.options.zoom.factorX,n=this.options.zoom.factorY;return this.options.zoom.factorX=e/this.zoomX,this.options.zoom.factorY=t/this.zoomY,this.zoomIn(),this.options.zoom.factorX=i,this.options.zoom.factorY=n,this},removeObject:function(e){var t,i;if(JXG.isArray(e)){for(i=0;e.length>i;i++)this.removeObject(e[i]);return this}if(e=JXG.getReference(this,e),!JXG.exists(e))return this;try{for(t in e.childElements)e.childElements[t].board.removeObject(e.childElements[t]);for(t in this.objects)JXG.exists(this.objects[t].childElements)&&(delete this.objects[t].childElements[e.id],delete this.objects[t].descendants[e.id]);if(e._pos>-1)for(this.objectsList.splice(e._pos,1),t=e._pos;this.objectsList.length>t;t++)this.objectsList[t]._pos--;else JXG.debug("object "+e.id+" not found in list.");delete this.objects[e.id],delete this.elementsByName[e.name],e.visProp&&e.visProp.trace&&e.clearTrace(),JXG.exists(e.remove)&&e.remove()}catch(n){JXG.debug(e.id+": Could not be removed: "+n)}return this.update(),this},removeAncestors:function(e){for(var t in e.ancestors)this.removeAncestors(e.ancestors[t]);return this.removeObject(e),this},initGeonextBoard:function(){var e,t,i,n,r;return e=this.create("point",[0,0],{id:this.id+"g00e0",name:"Ursprung",withLabel:!1,visible:!1,fixed:!0}),t=this.create("point",[1,0],{id:this.id+"gX0e0",name:"Punkt_1_0",withLabel:!1,visible:!1,fixed:!0}),i=this.create("point",[0,1],{id:this.id+"gY0e0",name:"Punkt_0_1",withLabel:!1,visible:!1,fixed:!0}),n=this.create("line",[e,t],{id:this.id+"gXLe0",name:"X-Achse",withLabel:!1,visible:!1}),r=this.create("line",[e,i],{id:this.id+"gYLe0",name:"Y-Achse",withLabel:!1,visible:!1}),this},initInfobox:function(){var e=JXG.copyAttributes({},this.options,"infobox");return e.id=this.id+"_infobox",this.infobox=this.create("text",[0,0,"0,0"],e),this.infobox.distanceX=-20,this.infobox.distanceY=25,this.infobox.needsUpdateSize=!1,this.infobox.dump=!1,this.renderer.hide(this.infobox),this},resizeContainer:function(e,t){return this.canvasWidth=parseFloat(e),this.canvasHeight=parseFloat(t),this.containerObj.style.width=this.canvasWidth+"px",this.containerObj.style.height=this.canvasHeight+"px",this.renderer.resize(this.canvasWidth,this.canvasHeight),this},showDependencies:function(){var e,t,i,n,r;t="<p>\n";for(e in this.objects){r=0;for(i in this.objects[e].childElements)r++;r>=0&&(t+="<b>"+this.objects[e].id+":<"+"/b> ");for(i in this.objects[e].childElements)t+=this.objects[e].childElements[i].id+"("+this.objects[e].childElements[i].name+")"+", ";t+="<p>\n"}return t+="</p>\n",n=window.open(),n.document.open(),n.document.write(t),n.document.close(),this},showXML:function(){var e=window.open("");return e.document.open(),e.document.write("<pre>"+JXG.escapeHTML(this.xmlString)+"<"+"/pre>"),e.document.close(),this},prepareUpdate:function(){var e,t,i=this.objectsList.length;for(e=0;i>e;e++)t=this.objectsList[e],t.needsUpdate=t.needsRegularUpdate||this.needsFullUpdate;return this},updateElements:function(e){var t,i;for(e=JXG.getRef(this,e),t=0;this.objectsList.length>t;t++)i=this.objectsList[t],i.update(!JXG.exists(e)||i.id!==e.id);return this},updateRenderer:function(e){var t,i,n=this.objectsList.length;if("canvas"==this.options.renderer)this.updateRendererCanvas(e);else for(t=0;n>t;t++)i=this.objectsList[t],i.updateRenderer();return this},updateRendererCanvas:function(){var e,t,i,n,r,o=this.objectsList.length,a=this.options.layer,s=this.options.layer.numlayers,l=Number.NEGATIVE_INFINITY;for(i=0;s>i;i++){n=Number.POSITIVE_INFINITY;for(r in a)a[r]>l&&n>a[r]&&(n=a[r]);for(l=n,e=0;o>e;e++)t=this.objectsList[e],t.visProp.layer===n&&t.prepareUpdate().updateRenderer()}return this},addHook:function(e,t,i){return t=JXG.def(t,"update"),i=JXG.def(i,this),this.hooks.push([t,e]),this.on(t,e,i),this.hooks.length-1},addEvent:JXG.shortcut(JXG.Board.prototype,"on"),removeHook:function(e){return this.hooks[e]&&(this.off(this.hooks[e][0],this.hooks[e][1]),this.hooks[e]=null),this},removeEvent:JXG.shortcut(JXG.Board.prototype,"off"),updateHooks:function(){return arguments[0]=JXG.def(arguments[0],"update"),this.triggerEventHandlers.apply(this,arguments),this},addChild:function(e){return null!==e&&JXG.exists(e.containerObj)&&(this.dependentBoards.push(e),this.update()),this},removeChild:function(e){var t;for(t=this.dependentBoards.length-1;t>=0;t--)this.dependentBoards[t]==e&&this.dependentBoards.splice(t,1);return this},update:function(e){var t,i,n,r;if(this.inUpdate||this.isSuspendedUpdate)return this;for(this.inUpdate=!0,this.prepareUpdate(e).updateElements(e).updateConditions(),this.renderer.suspendRedraw(this),this.updateRenderer(e),this.renderer.unsuspendRedraw(),this.triggerEventHandlers("update"),i=this.dependentBoards.length,t=0;i>t;t++)n=this.dependentBoards[t].id,r=JXG.JSXGraph.boards[n],r!=this&&(r.updateQuality=this.updateQuality,r.prepareUpdate().updateElements().updateConditions(),r.renderer.suspendRedraw(),r.updateRenderer(),r.renderer.unsuspendRedraw(),r.triggerEventHandlers("update"));return this.inUpdate=!1,this},fullUpdate:function(){return this.needsFullUpdate=!0,this.update(),this.needsFullUpdate=!1,this},addGrid:function(){return this.create("grid",[]),this},removeGrids:function(){var e;for(e=0;this.grids.length>e;e++)this.removeObject(this.grids[e]);return this.grids.length=0,this.update(),this},create:function(e,t,i){var n,r;for(e=e.toLowerCase(),JXG.exists(t)||(t=[]),JXG.exists(i)||(i={}),r=0;t.length>r;r++)("text"!=e||2!=r)&&(t[r]=JXG.getReference(this,t[r]));if(null==JXG.JSXGraph.elements[e])throw Error("JSXGraph: JXG.createElement: Unknown element type given: "+e);return n="function"==typeof JXG.JSXGraph.elements[e]?JXG.JSXGraph.elements[e](this,t,i):JXG.JSXGraph.elements[e].creator(this,t,i),JXG.exists(n)?(n.prepareUpdate&&n.update&&n.updateRenderer&&n.prepareUpdate().update().updateRenderer(),n):(JXG.debug("JSXGraph: JXG.createElement: failure creating "+e),n)},createElement:JXG.shortcut(JXG.Board.prototype,"create"),clearTraces:function(){var e;for(e=0;this.objectsList.length>e;e++)this.objectsList[e].clearTrace();return this.numTraces=0,this},suspendUpdate:function(){return this.isSuspendedUpdate=!0,this},unsuspendUpdate:function(){return this.isSuspendedUpdate=!1,this.update(),this},setBoundingBox:function(e,t){if(!JXG.isArray(e))return this;var i,n,r=JXG.getDimensions(this.container);return this.plainBB=e,this.canvasWidth=parseInt(r.width),this.canvasHeight=parseInt(r.height),n=this.canvasWidth,i=this.canvasHeight,t?(this.unitX=n/(e[2]-e[0]),this.unitY=i/(e[1]-e[3]),Math.abs(this.unitX)<Math.abs(this.unitY)?this.unitY=Math.abs(this.unitX)*this.unitY/Math.abs(this.unitY):this.unitX=Math.abs(this.unitY)*this.unitX/Math.abs(this.unitX)):(this.unitX=n/(e[2]-e[0]),this.unitY=i/(e[1]-e[3])),this.moveOrigin(-this.unitX*e[0],this.unitY*e[1]),this},getBoundingBox:function(){var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this),t=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.canvasWidth,this.canvasHeight],this);return[e.usrCoords[1],e.usrCoords[2],t.usrCoords[1],t.usrCoords[2]]},addAnimation:function(e){var t=this;return this.animationObjects[e.id]=e,this.animationIntervalCode||(this.animationIntervalCode=setInterval(function(){JXG.JSXGraph.boards[t.id].animate()},e.board.options.animationDelay)),this},stopAllAnimation:function(){var e;for(e in this.animationObjects)null!==this.animationObjects[e]&&(this.animationObjects[e]=null,delete this.animationObjects[e]);return clearInterval(this.animationIntervalCode),delete this.animationIntervalCode,this},animate:function(){var e,t,i,n,r,o,a,s=0,l=null;for(e in this.animationObjects)if(null!==this.animationObjects[e]){if(s++,t=this.animationObjects[e],t.animationPath&&(i=JXG.isFunction(t.animationPath)?t.animationPath((new Date).getTime()-t.animationStart):t.animationPath.pop(),!JXG.exists(i)||!JXG.isArray(i)&&isNaN(i)?delete t.animationPath:(t.setPositionDirectly(JXG.COORDS_BY_USER,i),t.prepareUpdate().update().updateRenderer(),l=t)),t.animationData){o=0;for(n in t.animationData)r=t.animationData[n].pop(),JXG.exists(r)?(o++,t.setProperty(n+":"+r)):delete t.animationData[r];0==o&&delete t.animationData}!JXG.exists(t.animationData)&&!JXG.exists(t.animationPath)&&(this.animationObjects[e]=null,delete this.animationObjects[e],JXG.exists(t.animationCallback)&&(a=t.animationCallback,t.animationCallback=null,a()))}return 0==s?(clearInterval(this.animationIntervalCode),delete this.animationIntervalCode):this.update(l),this},migratePoint:function(e,t){var i,n,r,o,a;e=JXG.getRef(this,e),t=JXG.getRef(this,t);for(n in e.childElements){i=e.childElements[n],o=!1;for(r in i)i[r]===e&&(i[r]=t,o=!0);for(o&&delete e.childElements[n],a=0;i.parents.length>a;a++)i.parents[a]===e.id&&(i.parents[a]=t.id);t.addChild(i)}return this.removeObject(e),this.update(),this},emulateColorblindness:function(e){var t,i,n=this;if(JXG.exists(e)||(e="none"),this.currentCBDef==e)return this;for(t in n.objects)i=n.objects[t],"none"!=e?("none"==this.currentCBDef&&(i.visPropOriginal={strokecolor:i.visProp.strokecolor,fillcolor:i.visProp.fillcolor,highlightstrokecolor:i.visProp.highlightstrokecolor,highlightfillcolor:i.visProp.highlightfillcolor}),i.setProperty({strokecolor:JXG.rgb2cb(i.visPropOriginal.strokecolor,e),fillcolor:JXG.rgb2cb(i.visPropOriginal.fillcolor,e),highlightstrokecolor:JXG.rgb2cb(i.visPropOriginal.highlightstrokecolor,e),highlightfillcolor:JXG.rgb2cb(i.visPropOriginal.highlightfillcolor,e)})):JXG.exists(i.visPropOriginal)&&JXG.extend(i.visProp,i.visPropOriginal);return this.currentCBDef=e,this.update(),this},updateCSSTransforms:function(){var e=this.containerObj,t=e,i=e;for(this.cssTransMat=JXG.getCSSTransformMatrix(t);t=t.offsetParent;)for(this.cssTransMat=JXG.Math.matMatMult(JXG.getCSSTransformMatrix(t),this.cssTransMat),i=i.parentNode;i!=t;)this.cssTransMat=JXG.Math.matMatMult(JXG.getCSSTransformMatrix(t),this.cssTransMat),i=i.parentNode;return this.cssTransMat=JXG.Math.inverse(this.cssTransMat),this},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},getPartialConstruction:function(){var e,t;for(t=1;arguments.length>t;t++)e.push(arguments[t])},createRoulette:function(e,t,i,n,r,o,a){var s=this,l=function(){var l,c=0,u=0,d=0,h=i,p=JXG.Math.Numerics.root(function(i){var n=e.X(h),r=e.Y(h),o=t.X(i),a=t.Y(i);return(n-o)*(n-o)+(r-a)*(r-a)},[0,2*Math.PI]),f=0,g=0,m=s.create("transform",[function(){return c}],{type:"rotate"}),b=s.create("transform",[function(){return c},function(){return e.X(h)},function(){return e.Y(h)}],{type:"rotate"}),v=s.create("transform",[function(){return u},function(){return d}],{type:"translate"}),y=function(e,t,i){var n=JXG.Math.Numerics.D(e.X)(t),r=JXG.Math.Numerics.D(e.Y)(t),o=JXG.Math.Numerics.D(e.X)(i),a=JXG.Math.Numerics.D(e.Y)(i),s=JXG.Math.Numerics.D(e.X)(.5*(t+i)),l=JXG.Math.Numerics.D(e.Y)(.5*(t+i)),c=Math.sqrt(n*n+r*r),u=Math.sqrt(o*o+a*a),d=Math.sqrt(s*s+l*l);return(c+4*d+u)*(i-t)/6},x=function(e){return l-y(t,p,e)},C=Math.PI/18,w=9*C,k=null;return this.rolling=function(){f=h+r*n,l=y(e,h,f),g=JXG.Math.Numerics.root(x,p);var i=new JXG.Complex(e.X(f),e.Y(f)),o=new JXG.Complex(t.X(g),t.Y(g)),k=new JXG.Complex(JXG.Math.Numerics.D(e.X)(f),JXG.Math.Numerics.D(e.Y)(f)),_=new JXG.Complex(JXG.Math.Numerics.D(t.X)(g),JXG.Math.Numerics.D(t.Y)(g)),E=JXG.C.div(k,_);c=Math.atan2(E.imaginary,E.real),E.div(JXG.C.abs(E)),E.mult(o),u=i.real-E.real,d=i.imaginary-E.imaginary,-C>c&&c>-w?(c=-C,b.applyOnce(a)):c>C&&w>c?(c=C,b.applyOnce(a)):(m.applyOnce(a),v.applyOnce(a),h=f,p=g),s.update()},this.start=function(){return o>0&&(k=setInterval(this.rolling,o)),this},this.stop=function(){return clearInterval(k),this},this};return new l}}),JXG.Options={showCopyright:!0,showNavigation:!0,takeSizeFromFile:!1,renderer:"svg",takeFirst:!1,animationDelay:35,zoom:{factorX:1.25,factorY:1.25,wheel:!1,needShift:!1,eps:.1},pan:{needShift:!0,needTwoFingers:!0,enabled:!0},jc:{enabled:!0,compile:!0},navbar:{strokeColor:"#aaaaaa",fillColor:"#f5f5f5",padding:"2px",position:"absolute",fontSize:"10px",cursor:"pointer",zIndex:"100",right:"5px",bottom:"5px"},elements:{strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"red",highlightFillColor:"none",strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,strokeWidth:2,highlightStrokeWidth:2,fixed:!1,frozen:!1,withLabel:!1,visible:!0,priv:!1,layer:0,dash:0,shadow:!1,trace:!1,traceAttributes:{},highlight:!0,needsRegularUpdate:!0,snapToGrid:!1,scalable:!0,draft:{draft:!1,strokeColor:"#565656",fillColor:"#565656",strokeOpacity:.8,fillOpacity:.8,strokeWidth:1}},ticks:{drawLabels:!1,label:{},drawZero:!1,insertTicks:!1,minTicksDistance:50,minorHeight:4,majorHeight:10,minorTicks:4,scale:1,scaleSymbol:"",labels:[],ticksDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"black",highlightStrokeColor:"#888888"},precision:{touch:30,touchMax:100,mouse:4,epsilon:1e-4,hasPoint:4},layer:{numlayers:20,text:9,point:9,glider:9,arc:8,line:7,circle:6,curve:5,turtle:5,polygon:3,sector:3,angle:3,integral:3,axis:2,grid:1,image:0,trace:0},angle:{withLabel:!0,radius:.5,type:"sector",orthoType:"square",orthoSensitivity:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:.3,highlightFillOpacity:.3,radiuspoint:{withLabel:!1,visible:!1,name:""},pointsquare:{withLabel:!1,visible:!1,name:""},dot:{visible:!1,strokeColor:"none",fillColor:"black",size:2,face:"o",withLabel:!1,name:""},label:{position:"top",offset:[0,0],strokeColor:"#0000FF"}},arc:{label:{},firstArrow:!1,lastArrow:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",useDirection:!1},inequality:{fillColor:"red",fillOpacity:.2,strokeColor:"none",inverse:!1},axis:{needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeWidth:1,highlightStrokeColor:"#888888",withTicks:!0,straightFirst:!0,straightLast:!0,lastArrow:!0,withLabel:!1,scalable:!1,ticks:{label:{offset:[4,-9]},needsRegularUpdate:!1,strokeWidth:1,strokeColor:"#666666",highlightStrokeColor:"#888888",drawLabels:!0,drawZero:!1,insertTicks:!0,minTicksDistance:10,minorHeight:4,majorHeight:-1,minorTicks:4,ticksDistance:1,strokeOpacity:.25},point1:{needsRegularUpdate:!1},point2:{needsRegularUpdate:!1},label:{position:"lft",offset:[10,-20]}},bisector:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},bisectorlines:{line1:{strokeColor:"black"},line2:{strokeColor:"black"}},chart:{chartStyle:"line",colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"],highlightcolors:null,fillcolor:null,highlightonsector:!1,highlightbysize:!1},circle:{hasInnerPoints:!1,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""},label:{position:"urt"}},circumcircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},circumcirclearc:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,withLabel:!1,fixed:!1,name:""}},circumcirclesector:{useDirection:!0,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},conic:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",foci:{fixed:!1,visible:!1,withLabel:!1,name:""}},curve:{strokeWidth:1,strokeColor:"#0000ff",fillColor:"none",fixed:!0,handDrawing:!1,curveType:null,RDPsmoothing:!1,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:!0,label:{position:"lft"}},glider:{label:{}},grid:{needsRegularUpdate:!1,hasGrid:!1,gridX:1,gridY:1,strokeColor:"#C0C0C0",strokeOpacity:"0.5",strokeWidth:1,dash:0,snapToGrid:!1,snapSizeX:10,snapSizeY:10},image:{imageString:null,fillOpacity:1,cssClass:"JXGimage",highlightCssClass:"JXGimageHighlight",rotate:0},incircle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",center:{visible:!1,fixed:!1,withLabel:!1,name:""}},infobox:{fontSize:12,isLabel:!1,strokeColor:"#bbbbbb",display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGinfobox",rotate:0,visible:!0},integral:{withLabel:!0,strokeWidth:0,strokeOpacity:0,fillOpacity:.8,curveLeft:{visible:!0,layer:9},baseLeft:{visible:!1,fixed:!1,withLabel:!1,name:""},curveRight:{visible:!0,layer:9},baseRight:{visible:!1,fixed:!1,withLabel:!1,name:""},label:{fontSize:20}},intersection:{alwaysIntersect:!0},label:{strokeColor:"#552222",highlightStrokeOpacity:1,highlightStrokeColor:"#C3D9FF",fixed:!0,position:"urt",offset:[10,10]},legend:{style:"vertical",labels:["1","2","3","4","5","6","7","8"],colors:["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"]},line:{firstArrow:!1,lastArrow:!1,straightFirst:!0,straightLast:!0,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",withTicks:!1,point1:{visible:!1,withLabel:!1,fixed:!1,name:""},point2:{visible:!1,withLabel:!1,fixed:!1,name:""},ticks:{drawLabels:!0,label:{offset:[4,-9]},drawZero:!1,insertTicks:!1,minTicksDistance:50,maxTicksDistance:300,minorHeight:4,majorHeight:-1,minorTicks:4,defaultDistance:1,strokeOpacity:.3},label:{position:"llft"}},locus:{translateToOrigin:!1,translateTo10:!1,stretch:!1,toOrigin:null,to10:null},normal:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},orthogonalprojection:{},parallel:{strokeColor:"#000000",point:{visible:!1,fixed:!1,withLabel:!1,name:""}},perpendicular:{strokeColor:"#000000",straightFirst:!0,straightLast:!0},perpendicularsegment:{strokeColor:"#000000",straightFirst:!1,straightLast:!1,point:{visible:!1,fixed:!0,withLabel:!1,name:""}},point:{withLabel:!0,label:{},style:5,face:"o",size:3,fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeWidth:2,strokeColor:"#ff0000",highlightStrokeColor:"#C3D9FF",zoom:!1,showInfobox:!0,infoboxDigits:"auto",draft:!1,attractors:[],attractorDistance:0,snatchDistance:0,snapToGrid:!1,snapSizeX:1,snapSizeY:1,snapToPoints:!1},polygon:{hasInnerPoints:!1,fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,withLines:!0,borders:{withLabel:!1,strokeWidth:1,highlightStrokeWidth:1,layer:5},vertices:{withLabel:!0,strokeColor:"#ff0000",fillColor:"#ff0000",fixed:!0},label:{offset:[0,0]}},prescribedangle:{anglepoint:{size:2,visible:!1,withLabel:!1}},riemannsum:{withLabel:!1,fillOpacity:.3,fillColor:"#ffff00"},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:.3,highlightFillOpacity:.3,label:{offset:[0,0]}},segment:{label:{position:"top"}},semicircle:{midpoint:{visible:!1,withLabel:!1,fixed:!1,name:""}},slider:{snapWidth:-1,precision:2,firstArrow:!1,lastArrow:!1,withTicks:!0,withLabel:!0,layer:9,showInfobox:!1,name:"",visible:!0,strokeColor:"#000000",highlightStrokeColor:"#888888",fillColor:"#ffffff",highlightFillColor:"none",size:6,point1:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},point2:{needsRegularUpdate:!1,showInfobox:!1,withLabel:!1,visible:!1,fixed:!0,name:""},baseline:{needsRegularUpdate:!1,name:"",strokeWidth:1,strokeColor:"#000000",highlightStrokeColor:"#888888"},ticks:{needsRegularUpdate:!1,drawLabels:!1,drawZero:!0,insertTicks:!0,minorHeight:4,majorHeight:10,minorTicks:0,defaultDistance:1,strokeOpacity:1,strokeWidth:1,strokeColor:"#000000"},highline:{strokeWidth:3,name:"",strokeColor:"#000000",highlightStrokeColor:"#888888"},label:{strokeColor:"#000000"}},text:{fontSize:12,digits:2,isLabel:!1,strokeColor:"#552222",useASCIIMathML:!1,useMathJax:!1,display:"html",anchorX:"left",anchorY:"middle",cssClass:"JXGtext",highlightCssClass:"JXGtext",withLabel:!1,rotate:0,visible:!0},tracecurve:{strokeColor:"#000000",fillColor:"none",numberPoints:100},turtle:{strokeWidth:1,fillColor:"none",strokeColor:"#000000",arrow:{strokeWidth:2,withLabel:!1,strokeColor:"#ff0000"}},shortcuts:{color:["strokeColor","fillColor"],opacity:["strokeOpacity","fillOpacity"],highlightColor:["highlightStrokeColor","highlightFillColor"],highlightOpacity:["highlightStrokeOpacity","highlightFillOpacity"],strokeWidth:["strokeWidth","highlightStrokeWidth"]}},JXG.Validator=function(){var e,t=function(e){return/^[0-9]+px$/.test(e)
},i=function(e){return e in{html:0,internal:0}},n=function(e){return JXG.isString(e)},r=function(e){return JXG.exists(JXG.Point.prototype.normalizeFace.call(this,e))},o=function(e){return Math.abs(e-Math.round(e))<JXG.Math.eps},a=function(e){return o(e)&&e>0},s=function(e){return e in{vml:0,svg:0,canvas:0}},l=function(e){return e>0},c=function(e){return!(0>e)},u={},d={attractorDistance:c,color:n,defaultDistance:JXG.isNumber,display:i,doAdvancedPlot:!1,draft:!1,drawLabels:!1,drawZero:!1,face:r,factor:JXG.isNumber,fillColor:n,fillOpacity:JXG.isNumber,firstArrow:!1,fontSize:o,dash:o,gridX:JXG.isNumber,gridY:JXG.isNumber,hasGrid:!1,highlightFillColor:n,highlightFillOpacity:JXG.isNumber,highlightStrokeColor:n,highlightStrokeOpacity:JXG.isNumber,insertTicks:!1,lastArrow:!1,majorHeight:o,maxTicksDistance:a,minorHeight:o,minorTicks:a,minTicksDistance:a,numberPointsHigh:a,numberPointsLow:a,opacity:JXG.isNumber,radius:JXG.isNumber,RDPsmoothing:!1,renderer:s,right:t,showCopyright:!1,showInfobox:!1,showNavigation:!1,size:o,snapSizeX:l,snapSizeY:l,snapWidth:JXG.isNumber,snapToGrid:!1,snatchDistance:c,straightFirst:!1,straightLast:!1,stretch:!1,strokeColor:n,strokeOpacity:JXG.isNumber,strokeWidth:o,takeFirst:!1,takeSizeFromFile:!1,to10:!1,toOrigin:!1,translateTo10:!1,translateToOrigin:!1,useASCIIMathML:!1,useDirection:!1,useMathJax:!1,withLabel:!1,withTicks:!1,zoom:!1};for(e in d)u[e.toLowerCase()]=d[e];return u}(),JXG.useStandardOptions=function(e){var t,i,n,r,o=JXG.Options,a=e.hasGrid;e.options.grid.hasGrid=o.grid.hasGrid,e.options.grid.gridX=o.grid.gridX,e.options.grid.gridY=o.grid.gridY,e.options.grid.gridColor=o.grid.gridColor,e.options.grid.gridOpacity=o.grid.gridOpacity,e.options.grid.gridDash=o.grid.gridDash,e.options.grid.snapToGrid=o.grid.snapToGrid,e.options.grid.snapSizeX=o.grid.SnapSizeX,e.options.grid.snapSizeY=o.grid.SnapSizeY,e.takeSizeFromFile=o.takeSizeFromFile,r=function(e,t){e.visProp.fillcolor=t.fillColor,e.visProp.highlightfillcolor=t.highlightFillColor,e.visProp.strokecolor=t.strokeColor,e.visProp.highlightstrokecolor=t.highlightStrokeColor};for(t in e.objects)if(n=e.objects[t],n.elementClass==JXG.OBJECT_CLASS_POINT)r(n,o.point);else if(n.elementClass==JXG.OBJECT_CLASS_LINE){r(n,o.line);for(i in n.ticks)i.majorTicks=o.line.ticks.majorTicks,i.minTicksDistance=o.line.ticks.minTicksDistance,i.visProp.minorheight=o.line.ticks.minorHeight,i.visProp.majorheight=o.line.ticks.majorHeight}else n.elementClass==JXG.OBJECT_CLASS_CIRCLE?r(n,o.circle):n.type==JXG.OBJECT_TYPE_ANGLE?r(n,o.angle):n.type==JXG.OBJECT_TYPE_ARC?r(n,o.arc):n.type==JXG.OBJECT_TYPE_POLYGON?r(n,o.polygon):n.type==JXG.OBJECT_TYPE_CONIC?r(n,o.conic):n.type==JXG.OBJECT_TYPE_CURVE?r(n,o.curve):n.type==JXG.OBJECT_TYPE_SECTOR&&(n.arc.visProp.fillcolor=o.sector.fillColor,n.arc.visProp.highlightfillcolor=o.sector.highlightFillColor,n.arc.visProp.fillopacity=o.sector.fillOpacity,n.arc.visProp.highlightfillopacity=o.sector.highlightFillOpacity);e.fullUpdate(),a&&!e.hasGrid?e.removeGrids(e):!a&&e.hasGrid&&e.create("grid",[])},JXG.useBlackWhiteOptions=function(e){var t=JXG.Options;t.point.fillColor=JXG.rgb2bw(t.point.fillColor),t.point.highlightFillColor=JXG.rgb2bw(t.point.highlightFillColor),t.point.strokeColor=JXG.rgb2bw(t.point.strokeColor),t.point.highlightStrokeColor=JXG.rgb2bw(t.point.highlightStrokeColor),t.line.fillColor=JXG.rgb2bw(t.line.fillColor),t.line.highlightFillColor=JXG.rgb2bw(t.line.highlightFillColor),t.line.strokeColor=JXG.rgb2bw(t.line.strokeColor),t.line.highlightStrokeColor=JXG.rgb2bw(t.line.highlightStrokeColor),t.circle.fillColor=JXG.rgb2bw(t.circle.fillColor),t.circle.highlightFillColor=JXG.rgb2bw(t.circle.highlightFillColor),t.circle.strokeColor=JXG.rgb2bw(t.circle.strokeColor),t.circle.highlightStrokeColor=JXG.rgb2bw(t.circle.highlightStrokeColor),t.arc.fillColor=JXG.rgb2bw(t.arc.fillColor),t.arc.highlightFillColor=JXG.rgb2bw(t.arc.highlightFillColor),t.arc.strokeColor=JXG.rgb2bw(t.arc.strokeColor),t.arc.highlightStrokeColor=JXG.rgb2bw(t.arc.highlightStrokeColor),t.polygon.fillColor=JXG.rgb2bw(t.polygon.fillColor),t.polygon.highlightFillColor=JXG.rgb2bw(t.polygon.highlightFillColor),t.sector.fillColor=JXG.rgb2bw(t.sector.fillColor),t.sector.highlightFillColor=JXG.rgb2bw(t.sector.highlightFillColor),t.curve.strokeColor=JXG.rgb2bw(t.curve.strokeColor),t.grid.gridColor=JXG.rgb2bw(t.grid.gridColor),JXG.useStandardOptions(e)},JXG.JSXGraph={licenseText:"JSXGraph v0.96 Copyright (C) see http://jsxgraph.org",boards:{},elements:{},rendererType:function(){function e(){document.body&&(document.body.scrollLeft,document.body.scrollTop)}var t=function(e){var t,i;if(JXG.rendererFiles[e]){for(t=JXG.rendererFiles[e].split(","),i=0;t.length>i;i++)(function(e){JXG.require(JXG.requirePath+e+".js")})(t[i]);delete JXG.rendererFiles[e]}};return JXG.Options.renderer="no",JXG.supportsVML()&&(JXG.Options.renderer="vml",document.onmousemove=e,t("vml")),JXG.supportsCanvas()&&(JXG.Options.renderer="canvas",t("canvas")),JXG.supportsSVG()&&(JXG.Options.renderer="svg",t("svg")),JXG.isNode()&&(JXG.Options.renderer="canvas",t("canvas")),JXG.Options.renderer}(),initBoard:function(e,t){var i,n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x;return c=JXG.getDimensions(e),x="undefined"!=typeof document&&null!==e?document.getElementById(e):e,t===void 0&&(t={}),t.boundingbox!==void 0?(u=t.boundingbox,s=parseInt(c.width),l=parseInt(c.height),t.keepaspectratio?(o=s/(u[2]-u[0]),a=l/(-u[3]+u[1]),Math.abs(o)<Math.abs(a)?a=Math.abs(o)*a/Math.abs(a):o=Math.abs(a)*o/Math.abs(o)):(o=s/(u[2]-u[0]),a=l/(-u[3]+u[1])),n=-o*u[0],r=a*u[1]):(n=t.originX===void 0?150:t.originX,r=t.originY===void 0?150:t.originY,o=t.unitX===void 0?50:t.unitX,a=t.unitY===void 0?50:t.unitY),d=t.zoomfactor===void 0?1:t.zoom,h=d*(t.zoomX===void 0?1:t.zoomX),p=d*(t.zoomY===void 0?1:t.zoomY),f=t.showCopyright===void 0?JXG.Options.showCopyright:t.showCopyright,b=t.zoom===void 0?JXG.Options.zoom.wheel:t.zoom,v=t.pan===void 0?JXG.Options.pan:t.pan,i="svg"==JXG.Options.renderer?new JXG.SVGRenderer(x):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(x):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(x,c.width,c.height):"canvas"==JXG.Options.renderer?new JXG.CanvasRenderer(x):new JXG.NoRenderer,m=new JXG.Board(e,i,"",[n,r],h,p,o,a,c.width,c.height,f),this.boards[m.id]=m,m.keepaspectratio=t.keepaspectratio,m.options.zoom.wheel=b,m.options.pan=v,m.suspendUpdate(),m.initInfobox(),t.axis&&(y="object"==typeof t.axis?t.axis:{ticks:{drawZero:!0}},m.defaultAxes={},m.defaultAxes.x=m.create("axis",[[0,0],[1,0]],y),m.defaultAxes.y=m.create("axis",[[0,0],[0,1]],y)),t.grid&&m.create("grid",[],"object"==typeof t.grid?t.grid:{}),t.shownavigation!==void 0&&(t.showNavigation=t.shownavigation),g=t.showNavigation===void 0?m.options.showNavigation:t.showNavigation,g&&m.renderer.drawZoomBar(m),m.unsuspendUpdate(),m},loadBoardFromFile:function(e,t,i){var n,r,o;return n="svg"==JXG.Options.renderer?new JXG.SVGRenderer(document.getElementById(e)):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(document.getElementById(e)):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(document.getElementById(e),o.width,o.height):new JXG.CanvasRenderer(document.getElementById(e)),o=JXG.getDimensions(e),r=new JXG.Board(e,n,"",[150,150],1,1,50,50,o.width,o.height),r.initInfobox(),JXG.FileReader.parseFileContent(t,r,i),r.options.showNavigation&&r.renderer.drawZoomBar(r),this.boards[r.id]=r,r},loadBoardFromString:function(e,t,i){var n,r,o;return n="svg"==JXG.Options.renderer?new JXG.SVGRenderer(document.getElementById(e)):"vml"==JXG.Options.renderer?new JXG.VMLRenderer(document.getElementById(e)):"silverlight"==JXG.Options.renderer?new JXG.SilverlightRenderer(document.getElementById(e),r.width,r.height):new JXG.CanvasRenderer(document.getElementById(e)),r=JXG.getDimensions(e),o=new JXG.Board(e,n,"",[150,150],1,1,50,50,r.width,r.height),o.initInfobox(),JXG.FileReader.parseString(t,o,i,!0),o.options.showNavigation&&o.renderer.drawZoomBar(o),this.boards[o.id]=o,o},freeBoard:function(e){var t;"string"==typeof e&&(e=this.boards[e]),e.removeEventHandlers(),e.suspendUpdate();for(t in e.objects)e.objects[t].remove();for(;e.containerObj.firstChild;)e.containerObj.removeChild(e.containerObj.firstChild);for(t in e.objects)delete e.objects[t];delete e.renderer,delete e.algebra,e.jc.creator.clearCache(),delete e.jc,delete this.boards[e.id]},registerElement:function(e,t){if(e=e.toLowerCase(),this.elements[e]=t,JXG.Board.prototype["_"+e])throw Error("JSXGraph: Can't create wrapper method in JXG.Board because member '_"+e+"' already exists'");JXG.Board.prototype["_"+e]=function(t,i){return this.create(e,t,i)}},unregisterElement:function(e){delete this.elements[e.toLowerCase()],delete JXG.Board.prototype["_"+e.toLowerCase()]}},JXG.extend(JXG,{OBJECT_TYPE_ARC:1,OBJECT_TYPE_ARROW:2,OBJECT_TYPE_AXIS:3,OBJECT_TYPE_AXISPOINT:4,OBJECT_TYPE_TICKS:5,OBJECT_TYPE_CIRCLE:6,OBJECT_TYPE_CONIC:7,OBJECT_TYPE_CURVE:8,OBJECT_TYPE_GLIDER:9,OBJECT_TYPE_IMAGE:10,OBJECT_TYPE_LINE:11,OBJECT_TYPE_POINT:12,OBJECT_TYPE_SLIDER:13,OBJECT_TYPE_CAS:14,OBJECT_TYPE_GXTCAS:15,OBJECT_TYPE_POLYGON:16,OBJECT_TYPE_SECTOR:17,OBJECT_TYPE_TEXT:18,OBJECT_TYPE_ANGLE:19,OBJECT_TYPE_INTERSECTION:20,OBJECT_TYPE_TURTLE:21,OBJECT_TYPE_VECTOR:22,OBJECT_TYPE_OPROJECT:23,OBJECT_TYPE_GRID:24,OBJECT_CLASS_POINT:1,OBJECT_CLASS_LINE:2,OBJECT_CLASS_CIRCLE:3,OBJECT_CLASS_CURVE:4,OBJECT_CLASS_AREA:5,OBJECT_CLASS_OTHER:6}),JXG.GeometryElement=function(e,t,i,n){var r,o;if(this.needsUpdate=!0,this.isDraggable=!1,this.isReal=!0,this.childElements={},this.hasLabel=!1,this.highlighted=!1,this.notExistingParents={},this.traces={},this.numTraces=0,this.transformations=[],this.baseElement=null,this.descendants={},this.ancestors={},this.symbolic={},this.elType="",this.dump=!0,this.subs={},this._pos=-1,this.stdform=[1,0,0,0,1,1,0,0],this.methodMap={setLabel:"setLabelText",getName:"getName",addTransform:"addTransform",setProperty:"setProperty",setAttribute:"setAttribute"},this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]],this.visProp={},JXG.EventEmitter.eventify(this),this.mouseover=!1,arguments.length>0){this.board=e,this.type=i,this.elementClass=n||JXG.OBJECT_CLASS_OTHER,this.id=t.id,r=t.name,JXG.exists(r)||(r=this.board.generateName(this)),this.board.elementsByName[r]=this,this.name=r,this.needsRegularUpdate=t.needsregularupdate,JXG.clearVisPropOld(this),t=this.resolveShortcuts(t);for(o in t)this._set(o,t[o]);this.visProp.draft=t.draft&&t.draft.draft,this.visProp.gradientangle="270",this.visProp.gradientsecondopacity=this.visProp.fillopacity,this.visProp.gradientpositionx=.5,this.visProp.gradientpositiony=.5}},JXG.extend(JXG.GeometryElement.prototype,{addChild:function(e){var t,i;this.childElements[e.id]=e,this.addDescendants(e),e.ancestors[this.id]=this;for(t in this.descendants){this.descendants[t].ancestors[this.id]=this;for(i in this.ancestors)this.descendants[t].ancestors[this.ancestors[i].id]=this.ancestors[i]}for(t in this.ancestors)for(i in this.descendants)this.ancestors[t].descendants[this.descendants[i].id]=this.descendants[i];return this},addDescendants:function(e){var t;this.descendants[e.id]=e;for(t in e.childElements)this.addDescendants(e.childElements[t]);return this},countChildren:function(){var e,t,i=0;t=this.childElements;for(e in t)t.hasOwnProperty(e)&&0>e.indexOf("Label")&&i++;return i},getName:function(){return this.name},addTransform:function(){},draggable:function(){return this.isDraggable&&!this.visProp.fixed&&!this.visProp.frozen&&this.type!=JXG.OBJECT_TYPE_GLIDER},generatePolynomial:function(){return[]},animate:function(e,t,i){i=i||{};var n,r,o,a=this.board.options.animationDelay,s=Math.ceil(t/(1*a)),l=this,c=!1;this.animationData={};var u=function(e,t,i){var n,r,a,c,u;for(n=JXG.rgb2hsv(e),r=JXG.rgb2hsv(t),a=(r[0]-n[0])/(1*s),c=(r[1]-n[1])/(1*s),u=(r[2]-n[2])/(1*s),l.animationData[i]=Array(s),o=0;s>o;o++)l.animationData[i][s-o-1]=JXG.hsv2rgb(n[0]+(o+1)*a,n[1]+(o+1)*c,n[2]+(o+1)*u)},d=function(e,t,i,n){var r;if(e=parseFloat(e),t=parseFloat(t),!isNaN(e)&&!isNaN(t)){var a=(t-e)/(1*s);for(l.animationData[i]=Array(s),o=0;s>o;o++)r=e+(o+1)*a,l.animationData[i][s-o-1]=n?Math.floor(r):r}};for(n in e)switch(r=n.toLowerCase()){case"strokecolor":case"fillcolor":u(this.visProp[r],e[n],r);break;case"size":if(this.elementClass!==JXG.OBJECT_CLASS_POINT)break;c=!0;case"strokeopacity":case"strokewidth":case"fillopacity":d(this.visProp[r],e[n],r,c)}return this.animationCallback=i.callback,this.board.addAnimation(this),this},update:function(){return this.visProp.trace&&this.cloneToBackground(!0),this},updateRenderer:function(){return this},hideElement:function(){return this.visProp.visible=!1,this.board.renderer.hide(this),null!=this.label&&this.hasLabel&&(this.label.hiddenByParent=!0,this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this},showElement:function(){return this.visProp.visible=!0,this.board.renderer.show(this),null!=this.label&&this.hasLabel&&this.label.hiddenByParent&&(this.label.hiddenByParent=!1,this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this},_set:function(e,t){e=e.toLocaleLowerCase(),this.visProp.hasOwnProperty(e)&&e.indexOf("color")>=0&&JXG.isString(t)&&9==t.length&&"#"===t.charAt(0)?(t=JXG.rgba2rgbo(t),this.visProp[e]=t[0],this.visProp[e.replace("color","opacity")]=t[1]):this.visProp[e]=t},resolveShortcuts:function(e){var t,i;for(t in JXG.Options.shortcuts)if(JXG.exists(e[t]))for(i=0;JXG.Options.shortcuts[t].length>i;i++)JXG.exists(e[JXG.Options.shortcuts[t][i]])||(e[JXG.Options.shortcuts[t][i]]=e[t]);return e},setLabelText:function(e){return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),null!==this.label&&this.label.content.setText(e),this},setAttribute:JXG.shortcut(JXG.GeometryElement.prototype,"setProperty"),setProperty:function(){var e,t,i,n,r,o,a,s={};for(e=0;arguments.length>e;e++)n=arguments[e],JXG.isString(n)?(o=n.split(":"),s[JXG.trim(o[0])]=JXG.trim(o[1])):JXG.isArray(n)?s[n[0]]=n[1]:JXG.extend(s,n);s=this.resolveShortcuts(s);for(e in s){switch(t=e.replace(/\s+/g,"").toLowerCase(),i=s[e],a=this.visProp[t],t){case"name":delete this.board.elementsByName[this.name],this.name=i,this.board.elementsByName[this.name]=this;break;case"needsregularupdate":this.needsRegularUpdate="false"!=i&&0!=i,this.board.renderer.setBuffering(this,this.needsRegularUpdate?"auto":"static");break;case"labelcolor":i=JXG.rgba2rgbo(i),r=i[1],i=i[0],0==r&&null!=this.label&&this.hasLabel&&this.label.content.hideElement(),null!=this.label&&this.hasLabel&&(this.label.color=i,this.board.renderer.setObjectStrokeColor(this.label.content,i,r)),this.type==JXG.OBJECT_TYPE_TEXT&&(this.visProp.strokecolor=i,this.visProp.strokeopacity=r,this.board.renderer.setObjectStrokeColor(this,this.visProp.strokecolor,this.visProp.strokeopacity));break;case"infoboxtext":this.infoboxText="string"==typeof i?i:!1;break;case"visible":"false"==i||0==i?(this.visProp.visible=!1,this.hideElement()):("true"==i||1==i)&&(this.visProp.visible=!0,this.showElement());break;case"face":this.elementClass==JXG.OBJECT_CLASS_POINT&&(this.visProp.face=i,this.board.renderer.changePointStyle(this));break;case"trace":"false"==i||0==i?(this.clearTrace(),this.visProp.trace=!1):this.visProp.trace=!0;break;case"gradient":this.visProp.gradient=i,this.board.renderer.setGradient(this);break;case"gradientsecondcolor":i=JXG.rgba2rgbo(i),this.visProp.gradientsecondcolor=i[0],this.visProp.gradientsecondopacity=i[1],this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientsecondopacity=i,this.board.renderer.updateGradient(this);break;case"withlabel":this.visProp.withlabel=i,i?this.label&&this.label.content?this.visProp.visible&&this.label.content.showElement():(this.createLabel(),this.visProp.visible||this.label.content.hideElement()):this.label&&this.label.content&&this.hasLabel&&this.label.content.hideElement(),this.hasLabel=i;break;case"rotate":(this.type===JXG.OBJECT_TYPE_TEXT&&"internal"==this.visProp.display||this.type===JXG.OBJECT_TYPE_IMAGE)&&this.addRotation(i);break;case"ticksdistance":this.type===JXG.OBJECT_TYPE_TICKS&&"number"==typeof i&&(this.ticksFunction=function(e){return function(){return e}}(i));break;default:JXG.exists(this.visProp[t])&&(!JXG.Validator[t]||JXG.Validator[t]&&JXG.Validator[t](i)||JXG.Validator[t]&&JXG.isFunction(i)&&JXG.Validator[t](i()))&&(i=i.toLowerCase&&"false"===i.toLowerCase()?!1:i,this._set(t,i))}this.triggerEventHandlers("attribute:"+t,a)}return this.triggerEventHandlers("attribute",s),this.visProp.needsregularupdate?this.board.update(this):this.board.fullUpdate(),this},getAttribute:JXG.shortcut(JXG.GeometryElement.prototype,"getProperty"),getProperty:function(e){var t;switch(e=e.toLowerCase()){case"needsregularupdate":t=this.needsRegularUpdate;break;case"labelcolor":t=this.label.color;break;case"infoboxtext":t=this.infoboxText;break;case"withlabel":t=this.hasLabel;break;default:t=this.visProp[e]}return t},setDash:function(e){return this.setProperty({dash:e}),this},prepareUpdate:function(){return this.needsUpdate=!0,this},remove:function(){return this.board.renderer.remove(this.board.renderer.getElementById(this.id)),this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.content.id)),this},getTextAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},getLabelAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},setStraight:function(){return this},setArrow:function(e,t){return this.visProp.firstarrow=e,this.visProp.lastarrow=t,this.prepareUpdate().update(),this},createGradient:function(){("linear"===this.visProp.gradient||"radial"===this.visProp.gradient)&&this.board.renderer.setGradient(this)},createLabel:function(){var e={};return e=JXG.deepCopy(this.visProp.label,null),e.id=this.id+"Label",e.isLabel=!0,e.visible=this.visProp.visible,e.anchor=this,e.priv=this.visProp.priv,this.nameHTML=JXG.GeonextParser.replaceSup(JXG.GeonextParser.replaceSub(this.name)),this.label={},this.visProp.withlabel&&(this.label.relativeCoords=[0,0],this.label.content=JXG.createText(this.board,[this.label.relativeCoords[0],-this.label.relativeCoords[1],this.name],e),this.label.content.needsUpdate=!0,this.label.content.update(),this.label.content.dump=!1,this.label.color=this.label.content.visProp.strokecolor,this.visProp.visible||(this.label.hiddenByParent=!0,this.label.content.visProp.visible=!1),this.hasLabel=!0),this},highlight:function(e){return e=JXG.def(e,!1),(!this.highlighted||e)&&(this.highlighted=!0,this.board.renderer.highlight(this)),this},noHighlight:function(){return this.highlighted&&(this.highlighted=!1,this.board.renderer.noHighlight(this)),this},clearTrace:function(){var e;for(e in this.traces)this.board.renderer.remove(this.traces[e]);return this.numTraces=0,this},cloneToBackground:function(){return this},bounds:function(){},normalize:function(){return this.stdform=JXG.Math.normalize(this.stdform),this},toJSON:function(){var e='{"name":'+this.name;e+=', "id":'+this.id;var t=[];for(var i in this.visProp)null!=this.visProp[i]&&t.push('"'+i+'":'+this.visProp[i]);return e+=', "visProp":{'+(""+t)+"}",e+="}"},addRotation:function(e){var t,i,n,r,o,a=this;if((this.type===JXG.OBJECT_TYPE_TEXT&&"internal"===this.visProp.display||this.type===JXG.OBJECT_TYPE_IMAGE)&&0!=e){var t,i,n,r,o,a=this;t=this.board.create("transform",[function(){return-a.X()},function(){return-a.Y()}],{type:"translate"}),i=this.board.create("transform",[function(){return a.X()},function(){return a.Y()}],{type:"translate"}),n=this.board.create("transform",[function(){return a.board.unitX/a.board.unitY},function(){return 1}],{type:"scale"}),r=this.board.create("transform",[function(){return a.board.unitY/a.board.unitX},function(){return 1}],{type:"scale"}),o=this.board.create("transform",[e*Math.PI/180],{type:"rotate"}),t.bindTo(this),n.bindTo(this),o.bindTo(this),r.bindTo(this),i.bindTo(this)}return this},highlightStrokeColor:function(e){return this.setProperty({highlightStrokeColor:e}),this},strokeColor:function(e){return this.setProperty({strokeColor:e}),this},strokeWidth:function(e){return this.setProperty({strokeWidth:e}),this},fillColor:function(e){return this.setProperty({fillColor:e}),this},highlightFillColor:function(e){return this.setProperty({highlightFillColor:e}),this},labelColor:function(e){return this.setProperty({labelColor:e}),this},dash:function(e){return this.setProperty({dash:e}),this},visible:function(e){return this.setProperty({visible:e}),this},shadow:function(e){return this.setProperty({shadow:e}),this},getType:function(){return this.elType},getParents:function(){return this.parents},snapToGrid:function(){return this},getAttributes:function(){var e,t=JXG.deepCopy(this.visProp),i=["attractors","attractordistance","snatchdistance","traceattributes","frozen","shadow","gradientangle","gradientsecondopacity","gradientpositionx","gradientpositiony","needsregularupdate","zoom","layer","offset"];for(t.id=this.id,t.name=this.name,e=0;i.length>e;e++)delete t[i[e]];return t},hasPoint:function(){return!1},addEvent:JXG.shortcut(JXG.GeometryElement.prototype,"on"),removeEvent:JXG.shortcut(JXG.GeometryElement.prototype,"off"),__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){},__evt__:function(){}}),JXG.COORDS_BY_USER=1,JXG.COORDS_BY_SCREEN=2,JXG.Coords=function(e,t,i){this.board=i,this.usrCoords=[],this.scrCoords=[],JXG.EventEmitter.eventify(this),this.setCoordinates(e,t)},JXG.extend(JXG.Coords.prototype,{normalizeUsrCoords:function(){var e=JXG.Math.eps;Math.abs(this.usrCoords[0])>e&&(this.usrCoords[1]/=this.usrCoords[0],this.usrCoords[2]/=this.usrCoords[0],this.usrCoords[0]=1)},usr2screen:function(e){var t=Math.round,i=this.board,n=this.usrCoords,r=i.origin.scrCoords;null===e||e?(this.scrCoords[0]=t(n[0]),this.scrCoords[1]=t(n[0]*r[1]+n[1]*i.unitX),this.scrCoords[2]=t(n[0]*r[2]-n[2]*i.unitY)):(this.scrCoords[0]=n[0],this.scrCoords[1]=n[0]*r[1]+n[1]*i.unitX,this.scrCoords[2]=n[0]*r[2]-n[2]*i.unitY)},screen2usr:function(){var e=this.board.origin.scrCoords,t=this.scrCoords,i=this.board;this.usrCoords[0]=1,this.usrCoords[1]=(t[1]-e[1])/i.unitX,this.usrCoords[2]=(e[2]-t[2])/i.unitY},distance:function(e,t){var i,n,r=0,o=this.usrCoords,a=this.scrCoords;if(e===JXG.COORDS_BY_USER){if(i=t.usrCoords,n=o[0]-i[0],r=n*n,r>JXG.Math.eps)return Number.POSITIVE_INFINITY;n=o[1]-i[1],r+=n*n,n=o[2]-i[2],r+=n*n}else i=t.scrCoords,n=a[1]-i[1],r+=n*n,n=a[2]-i[2],r+=n*n;return Math.sqrt(r)},setCoordinates:function(e,t,i){var n=this.usrCoords,r=this.scrCoords,o=this.usrCoords.slice(0),a=this.scrCoords.slice(0);return e===JXG.COORDS_BY_USER?(2===t.length?(n[0]=1,n[1]=t[0],n[2]=t[1]):(n[0]=t[0],n[1]=t[1],n[2]=t[2],this.normalizeUsrCoords()),this.usr2screen(i)):(r[1]=t[0],r[2]=t[1],this.screen2usr()),this.triggerEventHandlers("update",o,a),this},__evt__:function(){},__evt__:function(){}}),JXG.Point=function(e,t,i){this.constructor(e,i,JXG.OBJECT_TYPE_POINT,JXG.OBJECT_CLASS_POINT),null==t&&(t=[0,0]),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,t,this.board),this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,t,this.board),this.position=null,this.onPolygon=!1,this.slideObject=null,this.Xjc=null,this.Yjc=null,this.methodMap=JXG.deepCopy(this.methodMap,{move:"moveTo",glide:"makeGlider",X:"X",Y:"Y",free:"free",setPosition:"setGliderPosition"}),this.group=[],this.elType="point",this.id=this.board.setId(this,"P"),this.board.renderer.drawPoint(this),this.board.finalizeAdding(this),this.createLabel()},JXG.Point.prototype=new JXG.GeometryElement,JXG.extend(JXG.Point.prototype,{hasPoint:function(e,t){var i,n=this.coords.scrCoords;return i=parseFloat(this.visProp.size)+.5*parseFloat(this.visProp.strokewidth),this.board.options.precision.hasPoint>i&&(i=this.board.options.precision.hasPoint),i+2>Math.abs(n[1]-e)&&i+2>Math.abs(n[2]-t)},updateConstraint:function(){return this},update:function(e){return this.needsUpdate?(e===void 0&&(e=!1),this.type==JXG.OBJECT_TYPE_GLIDER&&(e?this.updateGliderFromParent():this.updateGlider()),(this.type==JXG.OBJECT_TYPE_CAS||this.type==JXG.OBJECT_TYPE_AXISPOINT)&&this.updateConstraint(),this.updateTransform(),this.visProp.trace&&this.cloneToBackground(!0),this):this},updateGlider:function(){var e,t,i,n,r,o,a,s,l,c,u,d,h,p,f,g=this.slideObject;if(g.elementClass==JXG.OBJECT_CLASS_CIRCLE)this.coords=JXG.Math.Geometry.projectPointToCircle(this,g,this.board),this.position=JXG.Math.Geometry.rad([g.center.X()+1,g.center.Y()],g.center,this);else if(g.elementClass==JXG.OBJECT_CLASS_LINE){if(this.onPolygon)if(t=g.point1.coords.usrCoords,i=g.point2.coords.usrCoords,e=1,n=i[e]-t[e],Math.abs(n)<JXG.Math.eps&&(e=2,n=i[e]-t[e]),a=JXG.Math.Geometry.projectPointToLine(this,g,this.board),s=(a.usrCoords[e]-t[e])/n,o=g.parentPolygon,0>s){for(e=0;o.borders.length>e;e++)if(g==o.borders[e]){g=o.borders[(e-1+o.borders.length)%o.borders.length];break}}else if(s>1)for(e=0;o.borders.length>e;e++)if(g==o.borders[e]){g=o.borders[(e+1+o.borders.length)%o.borders.length];break}t=g.point1.coords,i=g.point2.coords,n=t.distance(JXG.COORDS_BY_USER,i),t=t.usrCoords.slice(0),i=i.usrCoords.slice(0),JXG.Math.eps>n?(this.coords.setCoordinates(JXG.COORDS_BY_USER,t),this.position=0):(this.coords=JXG.Math.Geometry.projectPointToLine(this,g,this.board),Math.abs(i[0])<JXG.Math.eps?(e=1,n=i[e],Math.abs(n)<JXG.Math.eps&&(e=2,n=i[e]),n=(this.coords.usrCoords[e]-t[e])/n,l=n>=0?1:-1,n=Math.abs(n),this.position=l*n/(n+1)):Math.abs(t[0])<JXG.Math.eps?(e=1,n=t[e],Math.abs(n)<JXG.Math.eps&&(e=2,n=t[e]),n=(this.coords.usrCoords[e]-i[e])/n,this.position=0>n?(1-2*n)/(1-n):1/(n+1)):(e=1,n=i[e]-t[e],Math.abs(n)<JXG.Math.eps&&(e=2,n=i[e]-t[e]),this.position=(this.coords.usrCoords[e]-t[e])/n)),this.visProp.snapwidth>0&&Math.abs(this._smax-this._smin)>=JXG.Math.eps&&(0>this.position&&(this.position=0),this.position>1&&(this.position=1),r=this.position*(this._smax-this._smin)+this._smin,r=Math.round(r/this.visProp.snapwidth)*this.visProp.snapwidth,this.position=(r-this._smin)/(this._smax-this._smin),this.update(!0)),t=g.point1.coords.usrCoords,!g.visProp.straightfirst&&Math.abs(t[0])>JXG.Math.eps&&0>this.position&&(this.coords.setCoordinates(JXG.COORDS_BY_USER,t),this.position=0),i=g.point2.coords.usrCoords,!g.visProp.straightlast&&Math.abs(i[0])>JXG.Math.eps&&this.position>1&&(this.coords.setCoordinates(JXG.COORDS_BY_USER,i),this.position=1)}else g.type==JXG.OBJECT_TYPE_TURTLE?(this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToTurtle(this,g,this.board)):g.elementClass==JXG.OBJECT_CLASS_CURVE?g.type==JXG.OBJECT_TYPE_ARC||g.type==JXG.OBJECT_TYPE_SECTOR?(this.coords=JXG.Math.Geometry.projectPointToCircle(this,g,this.board),d=JXG.Math.Geometry.rad(g.radiuspoint,g.center,this),c=0,u=JXG.Math.Geometry.rad(g.radiuspoint,g.center,g.anglepoint),this.position=d,("minor"==g.visProp.type&&u>Math.PI||"major"==g.visProp.type&&Math.PI>u)&&(c=u,u=2*Math.PI),(c>d||d>u)&&(this.position=u,(c>d&&d>.5*c||d>u&&d>.5*u+Math.PI)&&(this.position=c),this.updateGliderFromParent())):(this.updateConstraint(),g.transformations.length>0?(g.updateTransformMatrix(),f=JXG.Math.inverse(g.transformMat),p=JXG.Math.matVecMult(f,this.coords.usrCoords),h=new JXG.Coords(JXG.COORDS_BY_USER,p,this.board).usrCoords,p=JXG.Math.Geometry.projectCoordsToCurve(h[1],h[2],this.position||0,g,this.board),this.position=p[1],this.coords=p[0]):this.coords=JXG.Math.Geometry.projectPointToCurve(this,g,this.board)):g.elementClass==JXG.OBJECT_CLASS_POINT&&(this.coords=JXG.Math.Geometry.projectPointToPoint(this,g,this.board))},updateGliderFromParent:function(){var e,t,i,n,r,o=this.slideObject;o.elementClass==JXG.OBJECT_CLASS_CIRCLE?(i=o.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[o.center.X()+i*Math.cos(this.position),o.center.Y()+i*Math.sin(this.position)])):o.elementClass==JXG.OBJECT_CLASS_LINE?(e=o.point1.coords.usrCoords,t=o.point2.coords.usrCoords,Math.abs(t[0])<JXG.Math.eps?(n=Math.min(Math.abs(this.position),1-JXG.Math.eps),n/=1-n,0>this.position&&(n*=-1),this.coords.setCoordinates(JXG.COORDS_BY_USER,[e[0]+n*t[0],e[1]+n*t[1],e[2]+n*t[2]])):Math.abs(e[0])<JXG.Math.eps?(n=Math.max(this.position,JXG.Math.eps),n=Math.min(n,2-JXG.Math.eps),n=n>1?(n-1)/(n-2):(1-n)/n,this.coords.setCoordinates(JXG.COORDS_BY_USER,[t[0]+n*e[0],t[1]+n*e[1],t[2]+n*e[2]])):(n=this.position,this.coords.setCoordinates(JXG.COORDS_BY_USER,[e[0]+n*(t[0]-e[0]),e[1]+n*(t[1]-e[1]),e[2]+n*(t[2]-e[2])]))):o.type==JXG.OBJECT_TYPE_TURTLE?(this.coords.setCoordinates(JXG.COORDS_BY_USER,[o.Z(this.position),o.X(this.position),o.Y(this.position)]),this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToTurtle(this,o,this.board)):o.elementClass==JXG.OBJECT_CLASS_CURVE?(this.coords.setCoordinates(JXG.COORDS_BY_USER,[o.Z(this.position),o.X(this.position),o.Y(this.position)]),o.type==JXG.OBJECT_TYPE_ARC||o.type==JXG.OBJECT_TYPE_SECTOR?(r=JXG.Math.Geometry.rad([o.center.X()+1,o.center.Y()],o.center,o.radiuspoint),i=o.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[o.center.X()+i*Math.cos(this.position+r),o.center.Y()+i*Math.sin(this.position+r)])):(this.updateConstraint(),this.coords=JXG.Math.Geometry.projectPointToCurve(this,o,this.board))):o.elementClass==JXG.OBJECT_CLASS_POINT&&(this.coords=JXG.Math.Geometry.projectPointToPoint(this,o,this.board))},updateRenderer:function(){if(!this.needsUpdate)return this;if(this.visProp.visible&&this.visProp.size>0){var e=this.isReal;this.isReal=!isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]),this.isReal=Math.abs(this.coords.usrCoords[0])>JXG.Math.eps?this.isReal:!1,this.isReal?(e!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updatePoint(this)):e!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content))}return this.hasLabel&&this.visProp.visible&&this.label.content&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content)),this.needsUpdate=!1,this},X:function(){return this.coords.usrCoords[1]},Y:function(){return this.coords.usrCoords[2]},Z:function(){return this.coords.usrCoords[0]},XEval:function(){return this.coords.usrCoords[1]},YEval:function(){return this.coords.usrCoords[2]},ZEval:function(){return this.coords.usrCoords[0]},bounds:function(){return this.coords.usrCoords.slice(1).concat(this.coords.usrCoords.slice(1))},Dist:function(e){var t,i,n=e.coords.usrCoords,r=this.coords.usrCoords;return i=r[0]-n[0],t=i*i,i=r[1]-n[1],t+=i*i,i=r[2]-n[2],t+=i*i,Math.sqrt(t)},snapToGrid:function(){return this.handleSnapToGrid()},handleSnapToGrid:function(){var e,t,i=this.visProp.snapsizex,n=this.visProp.snapsizey;return this.visProp.snaptogrid&&(e=this.coords.usrCoords[1],t=this.coords.usrCoords[2],0>=i&&this.board.defaultAxes&&this.board.defaultAxes.x.defaultTicks&&(i=this.board.defaultAxes.x.defaultTicks.ticksDelta*(this.board.defaultAxes.x.defaultTicks.visProp.minorticks+1)),0>=n&&this.board.defaultAxes&&this.board.defaultAxes.y.defaultTicks&&(n=this.board.defaultAxes.y.defaultTicks.ticksDelta*(this.board.defaultAxes.y.defaultTicks.visProp.minorticks+1)),i>0&&n>0&&this.coords.setCoordinates(JXG.COORDS_BY_USER,[Math.round(e/i)*i,Math.round(t/n)*n])),this},handleSnapToPoints:function(){var e,t,i,n=0,r=1/0,o=null;if(this.visProp.snaptopoints){for(e in this.board.objects)t=this.board.objects[e],t.elementClass==JXG.OBJECT_CLASS_POINT&&t!==this&&t.visProp.visible&&(i=JXG.Math.Geometry.projectPointToPoint(this,t,this.board),n=i.distance(JXG.COORDS_BY_USER,this.coords),this.visProp.attractordistance>n&&r>n&&(r=n,o=i));null!=o&&this.coords.setCoordinates(JXG.COORDS_BY_USER,o.usrCoords)
}return this},handleAttractors:function(){var e,t,i,n=this.visProp.attractors.length,r=0;if(0!=this.visProp.attractordistance){for(e=0;n>e;e++)if(t=JXG.getRef(this.board,this.visProp.attractors[e]),JXG.exists(t)&&t!==this){if(t.elementClass==JXG.OBJECT_CLASS_POINT?i=JXG.Math.Geometry.projectPointToPoint(this,t,this.board):t.elementClass==JXG.OBJECT_CLASS_LINE?i=JXG.Math.Geometry.projectPointToLine(this,t,this.board):t.elementClass==JXG.OBJECT_CLASS_CIRCLE?i=JXG.Math.Geometry.projectPointToCircle(this,t,this.board):t.elementClass==JXG.OBJECT_CLASS_CURVE?i=JXG.Math.Geometry.projectPointToCurve(this,t,this.board):t.type==JXG.OBJECT_TYPE_TURTLE&&(i=JXG.Math.Geometry.projectPointToTurtle(this,t,this.board)),r=i.distance(JXG.COORDS_BY_USER,this.coords),this.visProp.attractordistance>r){found=!0,(this.type!=JXG.OBJECT_TYPE_GLIDER||this.slideObject!=t)&&this.makeGlider(t);break}t==this.slideObject&&r>=this.visProp.snatchdistance&&(this.type=JXG.OBJECT_TYPE_POINT)}return this}},setPositionDirectly:function(e,t){var i,n;if(this.coords,this.coords.setCoordinates(e,t),this.handleSnapToGrid(),this.handleSnapToPoints(),this.handleAttractors(),!(this.group.length>0)){for(i=this.transformations.length-1;i>=0;i--)e===JXG.COORDS_BY_SCREEN?n=new JXG.Coords(e,t,this.board).usrCoords:(2===t.length&&(t=[1].concat(t)),n=t),this.initialCoords.setCoordinates(JXG.COORDS_BY_USER,JXG.Math.matVecMult(JXG.Math.inverse(this.transformations[i].matrix),n));this.update()}return this},setPositionByTransform:function(e,t){var i;return t=new JXG.Coords(e,t,this.board),i=this.board.create("transform",t.usrCoords.slice(1),{type:"translate"}),this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(i):this.addTransform(this,i),this.update(),this},setPosition:function(e,t){return this.setPositionDirectly(e,t)},setGliderPosition:function(e){return(this.type=JXG.OBJECT_TYPE_GLIDER)&&(this.position=e,this.board.update()),this},makeGlider:function(e){return this.slideObject=JXG.getRef(this.board,e),this.type=JXG.OBJECT_TYPE_GLIDER,this.elType="glider",this.visProp.snapwidth=-1,this.slideObject.addChild(this),this.isDraggable=!0,this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)},this.updateGlider(),this},free:function(){var e,t;if(this.type!==JXG.OBJECT_TYPE_GLIDER){if(this.isDraggable)return;this.isDraggable=!0,this.type=JXG.OBJECT_TYPE_POINT,this.XEval=function(){return this.coords.usrCoords[1]},this.YEval=function(){return this.coords.usrCoords[2]},this.ZEval=function(){return this.coords.usrCoords[0]},this.Xjc=null,this.Yjc=null}for(e in this.ancestors){this.ancestors[e].descendants[this.id]&&delete this.ancestors[e].descendants[this.id],this.ancestors[e].childElements[this.id]&&delete this.ancestors[e].childElements[this.id];for(t in this.descendants)this.ancestors[e].descendants[t]&&delete this.ancestors[e].descendants[t],this.ancestors[e].childElements[t]&&delete this.ancestors[e].childElements[t]}this.ancestors=[],this.slideObject=null,this.elType="point",this.type=JXG.OBJECT_TYPE_POINT},addConstraint:function(e){this.type=JXG.OBJECT_TYPE_CAS;var t,i,n,r=[],o=["X","Y"];for(this.isDraggable=!1,i=0;e.length>i;i++)n=e[i],"string"==typeof n?(r[i]=this.board.jc.snippet(n,!0,null,!0),2===e.length&&(this[o[i]+"jc"]=e[i])):"function"==typeof n?r[i]=n:"number"==typeof n?r[i]=function(e){return function(){return e}}(n):"object"==typeof n&&"function"==typeof n.Value&&(r[i]=function(e){return function(){return e.Value()}}(n)),r[i].origin=n;return 1==e.length?this.updateConstraint=function(){var e=r[0]();JXG.isArray(e)?this.coords.setCoordinates(JXG.COORDS_BY_USER,e):this.coords=e}:2==e.length?(this.XEval=r[0],this.YEval=r[1],t="this.coords.setCoordinates("+JXG.COORDS_BY_USER+",[this.XEval(),this.YEval()]);",this.updateConstraint=Function("",t)):(this.ZEval=r[0],this.XEval=r[1],this.YEval=r[2],t="this.coords.setCoordinates("+JXG.COORDS_BY_USER+",[this.ZEval(),this.XEval(),this.YEval()]);",this.updateConstraint=Function("",t)),this.board.isSuspendedUpdate||this.prepareUpdate().update().updateRenderer(),this},updateTransform:function(){if(0==this.transformations.length||null==this.baseElement)return this;var e,t;for(e=this===this.baseElement?this.transformations[0].apply(this.baseElement,"self"):this.transformations[0].apply(this.baseElement),this.coords.setCoordinates(JXG.COORDS_BY_USER,e),t=1;this.transformations.length>t;t++)this.coords.setCoordinates(JXG.COORDS_BY_USER,this.transformations[t].apply(this));return this},addTransform:function(e,t){var i,n=JXG.isArray(t)?t:[t],r=n.length;for(0===this.transformations.length&&(this.baseElement=e),i=0;r>i;i++)this.transformations.push(n[i]);return this},startAnimation:function(e,t){return this.type==JXG.OBJECT_TYPE_GLIDER&&this.intervalCode===void 0&&(this.intervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].objects['"+this.id+"']._anim("+e+", "+t+")",250),this.intervalCount===void 0&&(this.intervalCount=0)),this},stopAnimation:function(){return this.intervalCode!==void 0&&(window.clearInterval(this.intervalCode),delete this.intervalCode),this},moveAlong:function(e,t,i){i=i||{};var n,r,o=[],a=this.board.options.animationDelay,s=function(t,i){return function(){return e[t][i]}},l=[],c=t/a;if(JXG.isArray(e)){for(n=0;e.length>n;n++)l[n]=JXG.isPoint(e[n])?e[n]:{elementClass:JXG.OBJECT_CLASS_POINT,X:s(n,0),Y:s(n,1)};if(t=t||0,0===t)return this.setPosition(JXG.COORDS_BY_USER,[l[l.length-1].X(),l[l.length-1].Y()]),this.board.update(this);for(r=JXG.Math.Numerics.Neville(l),n=0;c>n;n++)o[n]=[],o[n][0]=r[0]((c-n)/c*r[3]()),o[n][1]=r[1]((c-n)/c*r[3]());this.animationPath=o}else JXG.isFunction(e)&&(this.animationPath=e,this.animationStart=(new Date).getTime());return this.animationCallback=i.callback,this.board.addAnimation(this),this},moveTo:function(e,t,i){if(e=new JXG.Coords(JXG.COORDS_BY_USER,e,this.board),t===void 0||0==t||Math.abs(e.usrCoords[0]-this.coords.usrCoords[0])>JXG.Math.eps)return this.setPosition(JXG.COORDS_BY_USER,e.usrCoords),this.board.update(this);i=i||{};var n,r=this.board.options.animationDelay,o=Math.ceil(t/(1*r)),a=Array(o+1),s=this.coords.usrCoords[1],l=this.coords.usrCoords[2],c=e.usrCoords[1]-s,u=e.usrCoords[2]-l,d=function(e){return i.effect&&"<>"==i.effect?Math.pow(Math.sin(e/(1*o)*Math.PI/2),2):e/o};if(Math.abs(c)<JXG.Math.eps&&Math.abs(u)<JXG.Math.eps)return this;for(n=o;n>=0;n--)a[o-n]=[e.usrCoords[0],s+c*d(n),l+u*d(n)];return this.animationPath=a,this.animationCallback=i.callback,this.board.addAnimation(this),this},visit:function(e,t,i){"number"==typeof i?i={repeat:i}:(i=i||{},i.repeat===void 0&&(i.repeat=1));var n,r,o=this.board.options.animationDelay,a=Math.ceil(t/(o*i.repeat)),s=Array(i.repeat*(a+1)),l=this.coords.usrCoords[1],c=this.coords.usrCoords[2],u=e[0]-l,d=e[1]-c,h=function(e){var t=a/2>e?2*e/a:2*(a-e)/a;return i.effect&&"<>"==i.effect?Math.pow(Math.sin(t*Math.PI/2),2):t};for(r=0;i.repeat>r;r++)for(n=a;n>=0;n--)s[r*(a+1)+a-n]=[e[0],l+u*h(n),c+d*h(n)];return this.animationPath=s,this.animationCallback=i.callback,this.board.addAnimation(this),this},_anim:function(e,t){var i,n,r,o,a,s,l,c,u=1;return this.intervalCount++,this.intervalCount>t&&(this.intervalCount=0),this.slideObject.elementClass==JXG.OBJECT_CLASS_LINE?(i=this.slideObject.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.slideObject.point2.coords),n=this.slideObject.getSlope(),"INF"!=n?(a=Math.atan(n),r=Math.round(this.intervalCount/t*i*Math.cos(a)),o=Math.round(this.intervalCount/t*i*Math.sin(a))):(r=0,o=Math.round(this.intervalCount/t*i)),0>e?(s=this.slideObject.point2,this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0?u=-1:0==this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]&&this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0&&(u=-1)):(s=this.slideObject.point1,this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0?u=-1:0==this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]&&this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0&&(u=-1)),this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[s.coords.scrCoords[1]+u*r,s.coords.scrCoords[2]+u*o])):this.slideObject.elementClass==JXG.OBJECT_CLASS_CURVE?(l=e>0?Math.round(this.intervalCount/t*this.board.canvasWidth):Math.round((t-this.intervalCount)/t*this.board.canvasWidth),this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[l,0]),this.coords=JXG.Math.Geometry.projectPointToCurve(this,this.slideObject,this.board)):this.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE&&(a=0>e?2*(this.intervalCount/t)*Math.PI:2*((t-this.intervalCount)/t)*Math.PI,c=this.slideObject.Radius(),this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.center.coords.usrCoords[1]+c*Math.cos(a),this.slideObject.center.coords.usrCoords[2]+c*Math.sin(a)])),this.board.update(this),this},setStyle:function(e){var t=["cross","cross","cross","circle","circle","circle","circle","square","square","square","plus","plus","plus"],i=[2,3,4,1,2,3,4,2,3,4,2,3,4];return this.visProp.face=t[e],this.visProp.size=i[e],this.board.renderer.changePointStyle(this),this},normalizeFace:function(e){var t={cross:"x",x:"x",circle:"o",o:"o",square:"[]","[]":"[]",plus:"+","+":"+",diamond:"<>","<>":"<>",triangleup:"^",a:"^","^":"^",triangledown:"v",v:"v",triangleleft:"<","<":"<",triangleright:">",">":">"};return t[e]},remove:function(){this.hasLabel&&this.board.renderer.remove(this.board.renderer.getElementById(this.label.content.id)),this.board.renderer.remove(this.board.renderer.getElementById(this.id))},getTextAnchor:function(){return this.coords},getLabelAnchor:function(){return this.coords},face:function(e){this.setProperty({face:e})},size:function(e){this.setProperty({size:e})},cloneToBackground:function(){var e={};return e.id=this.id+"T"+this.numTraces,this.numTraces++,e.coords=this.coords,e.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),e.visProp.layer=this.board.options.layer.trace,e.elementClass=JXG.OBJECT_CLASS_POINT,e.board=this.board,JXG.clearVisPropOld(e),this.board.renderer.drawPoint(e),this.traces[e.id]=e.rendNode,this},getParents:function(){var e=[this.Z(),this.X(),this.Y()];return this.parents&&(e=this.parents),this.type==JXG.OBJECT_TYPE_GLIDER&&(e=[this.X(),this.Y(),this.slideObject.id]),e}}),JXG.createPoint=function(e,t,i){var n,r,o,a=!1;for(o=JXG.copyAttributes(i,e.options,"point"),r=0;t.length>r;r++)("function"==typeof t[r]||"string"==typeof t[r])&&(a=!0);if(a)n=new JXG.Point(e,[0/0,0/0],o),n.addConstraint(t);else if(JXG.isNumber(t[0])&&JXG.isNumber(t[1]))n=new JXG.Point(e,t,o),JXG.exists(o.slideobject)?n.makeGlider(o.slideobject):n.baseElement=n,n.isDraggable=!0;else{if("object"!=typeof t[0]||"object"!=typeof t[1])throw Error("JSXGraph: Can't create point with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [x,y], [z,x,y], [point,transformation]");n=new JXG.Point(e,[0,0],o),n.addTransform(t[0],t[1]),n.isDraggable=!1,n.parents=[t[0].id]}return n},JXG.createGlider=function(e,t,i){var n,r=JXG.copyAttributes(i,e.options,"glider");return n=1===t.length?e.create("point",[0,0],r):e.create("point",t.slice(0,2),r),n.makeGlider(t[t.length-1]),n},JXG.createIntersectionPoint=function(e,t,i){var n,r,o=JXG.copyAttributes(i,e.options,"intersection");t.push(0,0),n=e.create("point",[0,0,0],o),r=new e.intersection(t[0],t[1],t[2],t[3],{point:n}),n.addConstraint([r]);try{t[0].addChild(n),t[1].addChild(n)}catch(a){throw Error("JSXGraph: Can't create 'intersection' with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'.")}return n.elType="intersection",n.parents=[t[0].id,t[1].id,t[2]],null!=t[3]&&n.parents.push(t[3]),n.generatePolynomial=function(){var e=t[0].generatePolynomial(n),i=t[1].generatePolynomial(n);return 0==e.length||0==i.length?[]:[e[0],i[0]]},n},JXG.createOtherIntersectionPoint=function(e,t,i){var n;if(3!=t.length||!JXG.isPoint(t[2])||t[0].elementClass!=JXG.OBJECT_CLASS_LINE&&t[0].elementClass!=JXG.OBJECT_CLASS_CIRCLE||t[1].elementClass!=JXG.OBJECT_CLASS_LINE&&t[1].elementClass!=JXG.OBJECT_CLASS_CIRCLE)throw Error("JSXGraph: Can't create 'other intersection point' with parent types '"+typeof t[0]+"',  '"+typeof t[1]+"'and  '"+typeof t[2]+"'."+"\nPossible parent types: [circle|line,circle|line,point]");return n=e.create("point",[e.otherIntersection(t[0],t[1],t[2])],i),n.elType="otherintersection",n.parents=[t[0].id,t[1].id,t[2]],t[0].addChild(n),t[1].addChild(n),n.generatePolynomial=function(){var e=t[0].generatePolynomial(n),i=t[1].generatePolynomial(n);return 0==e.length||0==i.length?[]:[e[0],i[0]]},n},JXG.JSXGraph.registerElement("point",JXG.createPoint),JXG.JSXGraph.registerElement("glider",JXG.createGlider),JXG.JSXGraph.registerElement("intersection",JXG.createIntersectionPoint),JXG.JSXGraph.registerElement("otherintersection",JXG.createOtherIntersectionPoint),JXG.Line=function(e,t,i,n){this.constructor(e,n,JXG.OBJECT_TYPE_LINE,JXG.OBJECT_CLASS_LINE),this.point1=JXG.getReference(this.board,t),this.point2=JXG.getReference(this.board,i),this.ticks=[],this.defaultTicks=null,this.parentPolygon=null,this.id=this.board.setId(this,"L"),this.board.renderer.drawLine(this),this.board.finalizeAdding(this),this.elType="line",this.point1.addChild(this),this.point2.addChild(this),this.updateStdform(),this.createLabel()},JXG.Line.prototype=new JXG.GeometryElement,JXG.extend(JXG.Line.prototype,{hasPoint:function(e,t){var i,n,r,o,a,s,l,c=[],u=[1,e,t];return c[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.unitX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.unitY,c[1]=this.stdform[1]/this.board.unitX,c[2]=this.stdform[2]/-this.board.unitY,i=JXG.Math.Geometry.distPointLine(u,c),isNaN(i)||i>this.board.options.precision.hasPoint?!1:this.visProp.straightfirst&&this.visProp.straightlast?!0:(r=this.point1.coords,o=this.point2.coords,n=[0,c[1],c[2]],n=JXG.Math.crossProduct(n,u),n=JXG.Math.crossProduct(n,c),n[1]/=n[0],n[2]/=n[0],n[0]=1,n=new JXG.Coords(JXG.COORDS_BY_SCREEN,n.slice(1),this.board).usrCoords,a=r.distance(JXG.COORDS_BY_USER,o),r=r.usrCoords.slice(0),o=o.usrCoords.slice(0),JXG.Math.eps>a?s=0:(a==Number.POSITIVE_INFINITY&&(a=1/JXG.Math.eps,Math.abs(o[0])<JXG.Math.eps?(a/=JXG.Math.Geometry.distance([0,0,0],o),o=[1,r[1]+o[1]*a,r[2]+o[2]*a]):(a/=JXG.Math.Geometry.distance([0,0,0],r),r=[1,o[1]+r[1]*a,o[2]+r[2]*a])),l=1,a=o[l]-r[l],Math.abs(a)<JXG.Math.eps&&(l=2,a=o[l]-r[l]),s=(n[l]-r[l])/a),!this.visProp.straightfirst&&0>s?!1:!this.visProp.straightlast&&s>1?!1:!0)},update:function(){var e;return this.needsUpdate?(this.constrained&&(this.funps!==void 0?(e=this.funps(),e&&e.length&&2===e.length&&(this.point1=e[0],this.point2=e[1])):("function"==typeof this.funp1&&(e=this.funp1(),JXG.isPoint(e)?this.point1=e:e&&e.length&&2===e.length&&this.point1.setPositionDirectly(JXG.COORDS_BY_USER,e)),"function"==typeof this.funp2&&(e=this.funp2(),JXG.isPoint(e)?this.point2=e:e&&e.length&&2===e.length&&this.point2.setPositionDirectly(JXG.COORDS_BY_USER,e)))),this.updateSegmentFixedLength(),this.updateStdform(),this.visProp.trace&&this.cloneToBackground(!0),this):this},updateSegmentFixedLength:function(){var e,t,i,n,r,o,a,s;return this.hasFixedLength?(e=this.point1.Dist(this.point2),t=this.fixedLength(),i=this.fixedLengthOldCoords[0].distance(JXG.COORDS_BY_USER,this.point1.coords),n=this.fixedLengthOldCoords[1].distance(JXG.COORDS_BY_USER,this.point2.coords),(i>JXG.Math.eps||n>JXG.Math.eps||e!=t)&&(r=this.point1.isDraggable&&this.point1.type!=JXG.OBJECT_TYPE_GLIDER&&!this.point1.visProp.fixed,o=this.point2.isDraggable&&this.point2.type!=JXG.OBJECT_TYPE_GLIDER&&!this.point2.visProp.fixed,e>JXG.Math.eps?i>n&&o||n>=i&&o&&!r?(this.point2.setPositionDirectly(JXG.COORDS_BY_USER,[this.point1.X()+(this.point2.X()-this.point1.X())*t/e,this.point1.Y()+(this.point2.Y()-this.point1.Y())*t/e]),this.point2.prepareUpdate().updateRenderer()):(n>=i&&r||i>n&&r&&!o)&&(this.point1.setPositionDirectly(JXG.COORDS_BY_USER,[this.point2.X()+(this.point1.X()-this.point2.X())*t/e,this.point2.Y()+(this.point1.Y()-this.point2.Y())*t/e]),this.point1.prepareUpdate().updateRenderer()):(a=Math.random()-.5,s=Math.random()-.5,e=Math.sqrt(a*a+s*s),o?(this.point2.setPositionDirectly(JXG.COORDS_BY_USER,[this.point1.X()+a*t/e,this.point1.Y()+s*t/e]),this.point2.prepareUpdate().updateRenderer()):r&&(this.point1.setPositionDirectly(JXG.COORDS_BY_USER,[this.point2.X()+a*t/e,this.point2.Y()+s*t/e]),this.point1.prepareUpdate().updateRenderer())),this.fixedLengthOldCoords[0].setCoordinates(JXG.COORDS_BY_USER,this.point1.coords.usrCoords),this.fixedLengthOldCoords[1].setCoordinates(JXG.COORDS_BY_USER,this.point2.coords.usrCoords)),this):this},updateStdform:function(){var e=JXG.Math.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=e[0],this.stdform[1]=e[1],this.stdform[2]=e[2],this.stdform[3]=0,this.normalize()},updateRenderer:function(){var e;return this.needsUpdate&&this.visProp.visible&&(e=this.isReal,this.isReal=!isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2])&&JXG.Math.innerProduct(this.stdform,this.stdform,3)>=JXG.Math.eps*JXG.Math.eps,this.isReal?(e!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updateLine(this)):e!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this.needsUpdate=!1),this.hasLabel&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content)),this},generatePolynomial:function(e){var t=this.point1.symbolic.x,i=this.point1.symbolic.y,n=this.point2.symbolic.x,r=this.point2.symbolic.y,o=e.symbolic.x,a=e.symbolic.y;return[["(",i,")*(",o,")-(",i,")*(",n,")+(",a,")*(",n,")-(",t,")*(",a,")+(",t,")*(",r,")-(",o,")*(",r,")"].join("")]},getRise:function(){return Math.abs(this.stdform[2])>=JXG.Math.eps?-this.stdform[0]/this.stdform[2]:1/0},getSlope:function(){return Math.abs(this.stdform[2])>=JXG.Math.eps?-this.stdform[1]/this.stdform[2]:1/0},getAngle:function(){return Math.atan2(this.point2.Y()-this.point1.Y(),this.point2.X()-this.point1.X())},setStraight:function(e,t){return this.visProp.straightfirst=e,this.visProp.straightlast=t,this.board.renderer.updateLine(this),this},getTextAnchor:function(){return new JXG.Coords(JXG.COORDS_BY_USER,[.5*(this.point2.X()+this.point1.X()),.5*(this.point2.Y()+this.point1.Y())],this.board)},setLabelRelativeCoords:function(e){JXG.exists(this.label.content)&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e[0],-e[1]],this.board))},getLabelAnchor:function(){var e,t,i=0,n=0,r=0,o=new JXG.Coords(JXG.COORDS_BY_USER,this.point1.coords.usrCoords,this.board),a=new JXG.Coords(JXG.COORDS_BY_USER,this.point2.coords.usrCoords,this.board);if((this.visProp.straightfirst||this.visProp.straightlast)&&JXG.Math.Geometry.calcStraight(this,o,a,0),o=o.scrCoords,a=a.scrCoords,!JXG.exists(this.label.content))return new JXG.Coords(JXG.COORDS_BY_SCREEN,[0/0,0/0],this.board);switch(this.label.content.visProp.position){case"lft":case"llft":case"ulft":o[1]<=a[1]?(e=o[1],t=o[2]):(e=a[1],t=a[2]);break;case"rt":case"lrt":case"urt":o[1]>a[1]?(e=o[1],t=o[2]):(e=a[1],t=a[2]);break;default:e=.5*(o[1]+a[1]),t=.5*(o[2]+a[2])}return(this.visProp.straightfirst||this.visProp.straightlast)&&(JXG.exists(this.label.content)&&(n=parseFloat(this.label.content.visProp.offset[0]),r=parseFloat(this.label.content.visProp.offset[1]),i=this.label.content.visProp.fontsize),Math.abs(e)<JXG.Math.eps?e=n:this.board.canvasWidth+JXG.Math.eps>e&&e>this.board.canvasWidth-i-JXG.Math.eps?e=this.board.canvasWidth-n-i:e+=n,JXG.Math.eps+i>t&&t>-JXG.Math.eps?t=r+i:this.board.canvasHeight+JXG.Math.eps>t&&t>this.board.canvasHeight-i-JXG.Math.eps?t=this.board.canvasHeight-r:t+=r),new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board)},cloneToBackground:function(){var e,t,i,n={};return n.id=this.id+"T"+this.numTraces,n.elementClass=JXG.OBJECT_CLASS_LINE,this.numTraces++,n.point1=this.point1,n.point2=this.point2,n.stdform=this.stdform,n.board=this.board,n.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),n.visProp.layer=this.board.options.layer.trace,JXG.clearVisPropOld(n),t=this.getSlope(),e=this.getRise(),n.getSlope=function(){return t},n.getRise=function(){return e},i=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawLine(n),this.board.renderer.enhancedRendering=i,this.traces[n.id]=n.rendNode,delete n,this},addTransform:function(e){var t,i=JXG.isArray(e)?e:[e],n=i.length;for(t=0;n>t;t++)this.point1.transformations.push(i[t]),this.point2.transformations.push(i[t]);return this},setPosition:function(e,t){var i;return t=new JXG.Coords(e,t,this.board),i=this.board.create("transform",t.usrCoords.slice(1),{type:"translate"}),this.point1.transformations.length>0&&this.point1.transformations[this.point1.transformations.length-1].isNumericMatrix?this.point1.transformations[this.point1.transformations.length-1].melt(i):this.point1.addTransform(this.point1,i),this.point2.transformations.length>0&&this.point2.transformations[this.point2.transformations.length-1].isNumericMatrix?this.point2.transformations[this.point2.transformations.length-1].melt(i):this.point2.addTransform(this.point2,i),this},setPositionDirectly:function(e,t,i){var n,r,o=new JXG.Coords(e,t,this.board),a=new JXG.Coords(e,i,this.board);return this.point1.draggable()&&this.point2.draggable()?(n=JXG.Math.Statistics.subtract(o.usrCoords,a.usrCoords),r=this.board.create("transform",n.slice(1),{type:"translate"}),r.applyOnce([this.point1,this.point2]),this):this},snapToGrid:function(){return this.visProp.snaptogrid&&(this.point1.snapToGrid(),this.point2.snapToGrid()),this},X:function(e){var t,i=this.stdform[2];return t=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[1]:this.point2.coords.usrCoords[1],e=2*(e-.5),0>e?(e*=-1,(1-e)*t+e*i):(1-e)*t-e*i},Y:function(e){var t,i=this.stdform[1];return t=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[2]:this.point2.coords.usrCoords[2],e=2*(e-.5),0>e?(e*=-1,(1-e)*t-e*i):(1-e)*t+e*i},Z:function(e){var t=Math.abs(this.point1.coords.usrCoords[0])>JXG.Math.eps?this.point1.coords.usrCoords[0]:this.point2.coords.usrCoords[0];return e=2*(e-.5),0>e&&(e*=-1),(1-e)*t},L:function(){return this.point1.Dist(this.point2)},minX:function(){return 0},maxX:function(){return 1},bounds:function(){var e=this.point1.coords.usrCoords,t=this.point2.coords.usrCoords;return[Math.min(e[1],t[1]),Math.max(e[2],t[2]),Math.max(e[1],t[1]),Math.min(e[2],t[2])]},addTicks:function(e){return(""==e.id||e.id===void 0)&&(e.id=this.id+"_ticks_"+(this.ticks.length+1)),this.board.renderer.drawTicks(e),this.ticks.push(e),e.id},remove:function(){this.removeAllTicks(),JXG.GeometryElement.prototype.remove.call(this)},removeAllTicks:function(){var e;for(e=this.ticks.length;e>0;e--)this.removeTicks(this.ticks[e-1]);this.ticks=[],this.board.update()},removeTicks:function(e){var t,i;for(null!=this.defaultTicks&&this.defaultTicks==e&&(this.defaultTicks=null),t=this.ticks.length;t>0;t--)if(this.ticks[t-1]==e){if(this.board.removeObject(this.ticks[t-1]),this.ticks[t-1].ticks)for(i=0;this.ticks[t-1].ticks.length>i;i++)null!=this.ticks[t-1].labels[i]&&this.board.removeObject(this.ticks[t-1].labels[i]);delete this.ticks[t-1];break}},hideElement:function(){var e;for(JXG.GeometryElement.prototype.hideElement.call(this),e=0;this.ticks.length>e;e++)this.ticks[e].hideElement()},showElement:function(){var e;for(JXG.GeometryElement.prototype.showElement.call(this),e=0;this.ticks.length>e;e++)this.ticks[e].showElement()}}),JXG.createLine=function(e,t,i){var n,r,o,a,s,l,c=[],u=!1;if(2==t.length){if(JXG.isArray(t[0])&&t[0].length>1)s=JXG.copyAttributes(i,e.options,"line","point1"),r=e.create("point",t[0],s);else if(JXG.isString(t[0])||t[0].elementClass==JXG.OBJECT_CLASS_POINT)r=JXG.getReference(e,t[0]);else if("function"==typeof t[0]&&t[0]().elementClass==JXG.OBJECT_CLASS_POINT)r=t[0](),u=!0;else{if("function"!=typeof t[0]||!t[0]().length||2!==t[0]().length)throw Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");s=JXG.copyAttributes(i,e.options,"line","point1"),r=JXG.createPoint(e,t[0](),s),u=!0}if(JXG.isArray(t[1])&&t[1].length>1)s=JXG.copyAttributes(i,e.options,"line","point2"),o=e.create("point",t[1],s);else if(JXG.isString(t[1])||t[1].elementClass==JXG.OBJECT_CLASS_POINT)o=JXG.getReference(e,t[1]);else if("function"==typeof t[1]&&t[1]().elementClass==JXG.OBJECT_CLASS_POINT)o=t[1](),u=!0;else{if("function"!=typeof t[1]||!t[1]().length||2!==t[1]().length)throw Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");s=JXG.copyAttributes(i,e.options,"line","point2"),o=JXG.createPoint(e,t[1](),s),u=!0}s=JXG.copyAttributes(i,e.options,"line"),n=new JXG.Line(e,r,o,s),u?(n.constrained=!0,n.funp1=t[0],n.funp2=t[1]):n.isDraggable=!0,n.constrained||(n.parents=[r.id,o.id])}else if(3==t.length){for(l=!0,a=0;3>a;a++)if("number"==typeof t[a])c[a]=function(e){return function(){return e}}(t[a]);else{if("function"!=typeof t[a])throw Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");c[a]=t[a],l=!1}s=JXG.copyAttributes(i,e.options,"line","point1"),r=l?e.create("point",[c[2]()*c[2]()+c[1]()*c[1](),c[2]()-c[1]()*c[0]()+c[2](),-c[1]()-c[2]()*c[0]()-c[1]()],s):e.create("point",[function(){return.5*(0+c[2]()*c[2]()+c[1]()*c[1]())},function(){return.5*(c[2]()-c[1]()*c[0]()+c[2]())},function(){return.5*(-c[1]()-c[2]()*c[0]()-c[1]())}],s),s=JXG.copyAttributes(i,e.options,"line","point2"),o=l?e.create("point",[c[2]()*c[2]()+c[1]()*c[1](),-c[1]()*c[0]()+c[2](),-c[2]()*c[0]()-c[1]()],s):e.create("point",[function(){return c[2]()*c[2]()+c[1]()*c[1]()},function(){return-c[1]()*c[0]()+c[2]()},function(){return-c[2]()*c[0]()-c[1]()}],s),r.prepareUpdate().update(),o.prepareUpdate().update(),s=JXG.copyAttributes(i,e.options,"line"),n=new JXG.Line(e,r,o,s),n.isDraggable=l,l&&(n.parents=[c[0](),c[1](),c[2]()])}else if(1==t.length&&"function"==typeof t[0]&&2==t[0]().length&&t[0]()[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[0]()[1].elementClass==JXG.OBJECT_CLASS_POINT){var d=t[0]();s=JXG.copyAttributes(i,e.options,"line"),n=new JXG.Line(e,d[0],d[1],s),n.constrained=!0,n.funps=t[0]}else{if(1!=t.length||"function"!=typeof t[0]||3!=t[0]().length||"number"!=typeof t[0]()[0]||"number"!=typeof t[0]()[1]||"number"!=typeof t[0]()[2])throw Error("JSXGraph: Can't create line with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point], [[x1,y1],[x2,y2]], [a,b,c]");d=t[0],s=JXG.copyAttributes(i,e.options,"line","point1"),r=e.create("point",[function(){var e=d();return[.5*(0+e[2]*e[2]+e[1]*e[1]),.5*(e[2]-e[1]*e[0]+e[2]),.5*(-e[1]-e[2]*e[0]-e[1])]}],s),s=JXG.copyAttributes(i,e.options,"line","point2"),o=e.create("point",[function(){var e=d();return[e[2]*e[2]+e[1]*e[1],-e[1]*e[0]+e[2],-e[2]*e[0]-e[1]]}],s),s=JXG.copyAttributes(i,e.options,"line"),n=new JXG.Line(e,r,o,s),n.constrained=!0,n.funps=t[0]}return n},JXG.JSXGraph.registerElement("line",JXG.createLine),JXG.createSegment=function(e,t,i){var n,r;if(i.straightFirst=!1,i.straightLast=!1,r=JXG.copyAttributes(i,e.options,"segment"),n=e.create("line",t.slice(0,2),r),3==t.length){if(n.hasFixedLength=!0,JXG.isNumber(t[2]))n.fixedLength=function(){return t[2]};else{if(!JXG.isFunction(t[2]))throw Error("JSXGraph: Can't create segment with third parent type '"+typeof t[2]+"'."+"\nPossible third parent types: number or function");n.fixedLength=t[2]}n.fixedLengthOldCoords=[],n.fixedLengthOldCoords[0]=new JXG.Coords(JXG.COORDS_BY_USER,n.point1.coords.usrCoords.slice(1,3),e),n.fixedLengthOldCoords[1]=new JXG.Coords(JXG.COORDS_BY_USER,n.point2.coords.usrCoords.slice(1,3),e)}return n.elType="segment",n},JXG.JSXGraph.registerElement("segment",JXG.createSegment),JXG.createArrow=function(e,t,i){var n;return i.firstArrow=!1,i.lastArrow=!0,n=e.create("line",t,i).setStraight(!1,!1),n.type=JXG.OBJECT_TYPE_VECTOR,n.elType="arrow",n},JXG.JSXGraph.registerElement("arrow",JXG.createArrow),JXG.createAxis=function(e,t,i){var n,r,o;if(!JXG.isArray(t[0])&&!JXG.isPoint(t[0])||!JXG.isArray(t[1])&&!JXG.isPoint(t[1]))throw Error("JSXGraph: Can't create axis with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point], [[x1,y1],[x2,y2]]");n=JXG.copyAttributes(i,e.options,"axis"),r=e.create("line",t,n),r.type=JXG.OBJECT_TYPE_AXIS,r.isDraggable=!1,r.point1.isDraggable=!1,r.point2.isDraggable=!1;for(var a in r.ancestors)r.ancestors[a].type=JXG.OBJECT_TYPE_AXISPOINT;return n=JXG.copyAttributes(i,e.options,"axis","ticks"),o=JXG.exists(n.ticksdistance)?n.ticksdistance:JXG.isArray(n.ticks)?n.ticks:1,r.defaultTicks=e.create("ticks",[r,o],n),r.defaultTicks.dump=!1,r.elType="axis",r.subs={ticks:r.defaultTicks},r},JXG.JSXGraph.registerElement("axis",JXG.createAxis),JXG.createTangent=function(e,t,i){var n,r,o,a,s,l,c,u;if(1==t.length)n=t[0],r=n.slideObject;else{if(2!=t.length)throw Error("JSXGraph: Can't create tangent with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [glider], [point,line|curve|circle|conic]");if(JXG.isPoint(t[0]))n=t[0],r=t[1];else{if(!JXG.isPoint(t[1]))throw Error("JSXGraph: Can't create tangent with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [glider], [point,line|curve|circle|conic]");r=t[0],n=t[1]}}if(r.elementClass==JXG.OBJECT_CLASS_LINE?u=e.create("line",[r.point1,r.point2],i):r.elementClass==JXG.OBJECT_CLASS_CURVE&&r.type!=JXG.OBJECT_TYPE_CONIC?"plot"!=r.visProp.curvetype?(o=r.X,a=r.Y,u=e.create("line",[function(){return-n.X()*e.D(a)(n.position)+n.Y()*e.D(o)(n.position)},function(){return e.D(a)(n.position)},function(){return-e.D(o)(n.position)}],i),n.addChild(u),u.glider=n):(u=e.create("line",[function(){return s=Math.floor(n.position),s==r.numberPoints-1&&s--,0>s?1:r.Y(s)*r.X(s+1)-r.X(s)*r.Y(s+1)},function(){return s=Math.floor(n.position),s==r.numberPoints-1&&s--,0>s?0:r.Y(s+1)-r.Y(s)},function(){return s=Math.floor(n.position),s==r.numberPoints-1&&s--,0>s?0:r.X(s)-r.X(s+1)}],i),n.addChild(u),u.glider=n):r.type==JXG.OBJECT_TYPE_TURTLE?(u=e.create("line",[function(){for(s=Math.floor(n.position),l=0;r.objects.length>l;l++)if(c=r.objects[l],c.type==JXG.OBJECT_TYPE_CURVE){if(c.numberPoints>s)break;s-=c.numberPoints}return s==c.numberPoints-1&&s--,0>s?1:c.Y(s)*c.X(s+1)-c.X(s)*c.Y(s+1)},function(){for(s=Math.floor(n.position),l=0;r.objects.length>l;l++)if(c=r.objects[l],c.type==JXG.OBJECT_TYPE_CURVE){if(c.numberPoints>s)break;s-=c.numberPoints,moveTo(funps)}return s==c.numberPoints-1&&s--,0>s?0:c.Y(s+1)-c.Y(s)},function(){for(s=Math.floor(n.position),l=0;r.objects.length>l;l++)if(c=r.objects[l],c.type==JXG.OBJECT_TYPE_CURVE){if(c.numberPoints>s)break;s-=c.numberPoints}return s==c.numberPoints-1&&s--,0>s?0:c.X(s)-c.X(s+1)}],i),n.addChild(u),u.glider=n):(r.elementClass==JXG.OBJECT_CLASS_CIRCLE||r.type==JXG.OBJECT_TYPE_CONIC)&&(u=e.create("line",[function(){return JXG.Math.matVecMult(r.quadraticform,n.coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(r.quadraticform,n.coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(r.quadraticform,n.coords.usrCoords)[2]}],i),n.addChild(u),u.glider=n),!JXG.exists(u))throw Error("JSXGraph: Couldn't create tangent with the given parents.");
for(u.elType="tangent",u.parents=[],s=0;t.length>s;s++)u.parents.push(t[s].id);return u},JXG.JSXGraph.registerElement("tangent",JXG.createTangent),JXG.JSXGraph.registerElement("polar",JXG.createTangent),JXG.Group=function(e,t,i){var n,r,o,a;for(this.board=e,this.objects={},n=this.board.numObjects,this.board.numObjects++,this.id=""!=t&&JXG.exists(t)?t:this.board.id+"Group"+n,this.board.groups[this.id]=this,this.type=JXG.OBJECT_TYPE_POINT,this.elementClass=JXG.OBJECT_CLASS_POINT,this.name=""!=i&&JXG.exists(i)?i:"group_"+this.board.generateName(this),delete this.type,r=4==arguments.length&&JXG.isArray(arguments[3])?arguments[3]:Array.prototype.slice.call(arguments,3),o=0;r.length>o;o++)a=JXG.getReference(this.board,r[o]),!a.visProp.fixed&&(a.type==JXG.OBJECT_TYPE_POINT||a.type==JXG.OBJECT_TYPE_GLIDER)&&(0!=a.group.length?this.addGroup(a.group[a.group.length-1]):this.addPoint(a));this.suspendUpdate=!1,this.dX=0,this.dY=0},JXG.extend(JXG.Group.prototype,{ungroup:function(){var e;for(e in this.objects)JXG.isArray(this.objects[e].point.group)&&this.objects[e].point.group[this.objects[e].point.group.length-1]==this&&this.objects[e].point.group.pop(),this.removePoint(this.objects[e].point)},suspendUpdate:function(){this.suspendUpdate=!0},unsuspendUpdate:function(){this.suspendUpdate=!1},update:function(e,t,i){var n,r=null;if(!this.suspendUpdate){this.suspendUpdate=!0;for(n in this.objects)JXG.exists(this.board.objects[n])?(r=this.objects[n].point,r.id!=e.id&&r.coords.setCoordinates(JXG.COORDS_BY_USER,[r.coords.usrCoords[1]+t,r.coords.usrCoords[2]+i]),this.objects[n].point.prepareUpdate().update(!1).updateRenderer()):delete this.objects[n];this.suspendUpdate=!1}return this},addPoint:function(e){this.objects[e.id]={point:e,handler:function(t){this.update(e,e.coords.usrCoords[1]-t[1],e.coords.usrCoords[2]-t[2],e.coords.usrCoords[0]-t[0])}},e.coords.on("update",this.objects[e.id].handler,this)},addPoints:function(e){var t;for(t=0;e.length>t;t++)this.addPoint(e[t])},addGroup:function(e){var t;for(t in e.objects)this.addPoint(e.objects[t].point)},removePoint:function(e){this.objects[e.id].point.coords.off("update",this.objects[e.id].handler),delete this.objects[e.id]},setProperty:function(){var e;for(e in this.objects)this.objects[e].point.setProperty.apply(this.objects[e].point,arguments)}}),JXG.createGroup=function(e,t,i){var n,r=new JXG.Group(e,i.id,i.name,t);for(r.elType="group",r.parents=[],n=0;t.length>n;n++)r.parents.push(t[n].id);return r},JXG.JSXGraph.registerElement("group",JXG.createGroup),JXG.Circle=function(e,t,i,n,r){this.constructor(e,r,JXG.OBJECT_TYPE_CIRCLE,JXG.OBJECT_CLASS_CIRCLE),this.method=t,this.midpoint=JXG.getReference(this.board,i),this.center=JXG.getReference(this.board,i),this.point2=null,this.radius=0,this.line=null,this.circle=null,"twoPoints"==t?(this.point2=JXG.getReference(e,n),this.radius=this.Radius()):"pointRadius"==t?(this.gxtterm=n,this.updateRadius=JXG.createFunction(n,this.board,null,!0),this.updateRadius()):"pointLine"==t?(this.line=JXG.getReference(e,n),this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)):"pointCircle"==t&&(this.circle=JXG.getReference(e,n),this.radius=this.circle.Radius()),this.id=this.board.setId(this,"C"),this.board.renderer.drawEllipse(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="circle",this.createLabel(),this.center.addChild(this),"pointRadius"==t?this.notifyParents(n):"pointLine"==t?this.line.addChild(this):"pointCircle"==t?this.circle.addChild(this):"twoPoints"==t&&this.point2.addChild(this),this.methodMap=JXG.deepCopy(this.methodMap,{setRadius:"setRadius",getRadius:"getRadius",radius:"Radius"})},JXG.Circle.prototype=new JXG.GeometryElement,JXG.extend(JXG.Circle.prototype,{hasPoint:function(e,t){var i=this.board.options.precision.hasPoint/this.board.unitX,n=this.center.coords.usrCoords,r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),o=this.Radius(),a=Math.sqrt((n[1]-r.usrCoords[1])*(n[1]-r.usrCoords[1])+(n[2]-r.usrCoords[2])*(n[2]-r.usrCoords[2]));return this.visProp.hasinnerpoints?o+i>a:i>Math.abs(a-o)},generatePolynomial:function(e){var t=this.center.symbolic.x,i=this.center.symbolic.y,n=e.symbolic.x,r=e.symbolic.y,o=this.generateRadiusSquared();if(""==o)return[];var a="(("+n+")-("+t+"))^2 + (("+r+")-("+i+"))^2 - ("+o+")";return[a]},generateRadiusSquared:function(){var e,t,i,n,r,o,a="";return"twoPoints"==this.method?(e=this.center.symbolic.x,t=this.center.symbolic.y,i=this.point2.symbolic.x,n=this.point2.symbolic.y,a="(("+i+")-("+e+"))^2 + (("+n+")-("+t+"))^2"):"pointRadius"==this.method?"number"==typeof this.radius&&(a=""+this.radius*this.radius):"pointLine"==this.method?(i=this.line.point1.symbolic.x,n=this.line.point1.symbolic.y,r=this.line.point2.symbolic.x,o=this.line.point2.symbolic.y,a="(("+i+")-("+r+"))^2 + (("+n+")-("+o+"))^2"):"pointCircle"==this.method&&(a=this.circle.Radius()),a},update:function(){return this.needsUpdate&&(this.visProp.trace&&this.cloneToBackground(!0),"pointLine"==this.method?this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords):"pointCircle"==this.method?this.radius=this.circle.Radius():"pointRadius"==this.method&&(this.radius=this.updateRadius()),this.updateStdform(),this.updateQuadraticform()),this},updateQuadraticform:function(){var e=this.center,t=e.X(),i=e.Y(),n=this.Radius();this.quadraticform=[[t*t+i*i-n*n,-t,-i],[-t,1,0],[-i,0,1]]},updateStdform:function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],this.normalize()},updateRenderer:function(){if(this.needsUpdate&&this.visProp.visible){var e=this.isReal;this.isReal=!isNaN(this.center.coords.usrCoords[1]+this.center.coords.usrCoords[2]+this.Radius())&&this.center.isReal,this.isReal?(e!=this.isReal&&(this.board.renderer.show(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)),this.board.renderer.updateEllipse(this)):e!=this.isReal&&(this.board.renderer.hide(this),this.hasLabel&&this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content)),this.needsUpdate=!1}this.hasLabel&&this.label.content.visProp.visible&&this.isReal&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))},notifyParents:function(e){"string"==typeof e&&JXG.GeonextParser.findDependencies(this,e+"",this.board)},setRadius:function(e){return this.updateRadius=JXG.createFunction(e,this.board,null,!0),this.board.update(),this},Radius:function(e){return JXG.exists(e)?(this.setRadius(e),this.Radius()):"twoPoints"==this.method?0==JXG.Math.Geometry.distance(this.point2.coords.usrCoords,[0,0,0])||0==JXG.Math.Geometry.distance(this.center.coords.usrCoords,[0,0,0])?0/0:this.center.Dist(this.point2):"pointLine"==this.method||"pointCircle"==this.method?this.radius:"pointRadius"==this.method?this.updateRadius():void 0},getRadius:function(){return this.Radius()},getTextAnchor:function(){return this.center.coords},getLabelAnchor:function(){var e,t,i=this.Radius(),n=this.center.coords.usrCoords;switch(this.visProp.label.position){case"lft":e=n[1]-i,t=n[2];break;case"llft":e=n[1]-Math.sqrt(.5)*i,t=n[2]-Math.sqrt(.5)*i;break;case"rt":e=n[1]+i,t=n[2];break;case"lrt":e=n[1]+Math.sqrt(.5)*i,t=n[2]-Math.sqrt(.5)*i;break;case"urt":e=n[1]+Math.sqrt(.5)*i,t=n[2]+Math.sqrt(.5)*i;break;case"top":e=n[1],t=n[2]+i;break;case"bot":e=n[1],t=n[2]-i;break;case"ulft":default:e=n[1]-Math.sqrt(.5)*i,t=n[2]+Math.sqrt(.5)*i}return new JXG.Coords(JXG.COORDS_BY_USER,[e,t],this.board)},cloneToBackground:function(){var e,t,i={};return i.id=this.id+"T"+this.numTraces,i.elementClass=JXG.OBJECT_CLASS_CIRCLE,this.numTraces++,i.center={},i.center.coords=this.center.coords,e=this.Radius(),i.Radius=function(){return e},i.getRadius=function(){return e},i.board=this.board,i.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),i.visProp.layer=this.board.options.layer.trace,JXG.clearVisPropOld(i),t=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawEllipse(i),this.board.renderer.enhancedRendering=t,this.traces[i.id]=i.rendNode,this},addTransform:function(e){var t,i=JXG.isArray(e)?e:[e],n=i.length;for(t=0;n>t;t++)this.center.transformations.push(i[t]),"twoPoints"===this.method&&this.point2.transformations.push(i[t]);return this},snapToGrid:function(){return this.visProp.snaptogrid&&(this.center.snapToGrid(),"twoPoints"===this.method&&this.point2.snapToGrid()),this},setPosition:function(e,t){var i;return t=new JXG.Coords(e,t,this.board),i=this.board.create("transform",t.usrCoords.slice(1),{type:"translate"}),this.addTransform(i),this},setPositionDirectly:function(e,t,i){t=new JXG.Coords(e,t,this.board),i=new JXG.Coords(e,i,this.board);var n,r,o=JXG.Math.Statistics.subtract(t.usrCoords,i.usrCoords),a=this.parents.length;for(n=0;a>n;n++)if(!JXG.getRef(this.board,this.parents[n]).draggable())return this;for(n=0;a>n;n++)r=JXG.getRef(this.board,this.parents[n]),r.coords.setCoordinates(JXG.COORDS_BY_USER,JXG.Math.Statistics.add(r.coords.usrCoords,o));return this.update(),this},X:function(e){return this.Radius()*Math.cos(2*e*Math.PI)+this.center.coords.usrCoords[1]},Y:function(e){return this.Radius()*Math.sin(2*e*Math.PI)+this.center.coords.usrCoords[2]},Z:function(){return 1},minX:function(){return 0},maxX:function(){return 1},Area:function(){var e=this.Radius();return e*e*Math.PI},bounds:function(){var e=this.center.coords.usrCoords,t=this.Radius();return[e[1]-t,e[2]+t,e[1]+t,e[2]-t]}}),JXG.createCircle=function(e,t,i){var n,r,o,a,s=!0;for(r=[],o=0;t.length>o;o++)JXG.isPoint(t[o])?r[o]=t[o]:JXG.isArray(t[o])&&t[o].length>1?(a=JXG.copyAttributes(i,e.options,"circle","center"),r[o]=e.create("point",t[o],a)):r[o]=t[o];if(a=JXG.copyAttributes(i,e.options,"circle"),2==t.length&&JXG.isPoint(r[0])&&JXG.isPoint(r[1]))n=new JXG.Circle(e,"twoPoints",r[0],r[1],a);else if((JXG.isNumber(r[0])||JXG.isFunction(r[0])||JXG.isString(r[0]))&&JXG.isPoint(r[1]))n=new JXG.Circle(e,"pointRadius",r[1],r[0],a);else if((JXG.isNumber(r[1])||JXG.isFunction(r[1])||JXG.isString(r[1]))&&JXG.isPoint(r[0]))n=new JXG.Circle(e,"pointRadius",r[0],r[1],a);else if(r[0].elementClass==JXG.OBJECT_CLASS_CIRCLE&&JXG.isPoint(r[1]))n=new JXG.Circle(e,"pointCircle",r[1],r[0],a);else if(r[1].elementClass==JXG.OBJECT_CLASS_CIRCLE&&JXG.isPoint(r[0]))n=new JXG.Circle(e,"pointCircle",r[0],r[1],a);else if(r[0].elementClass==JXG.OBJECT_CLASS_LINE&&JXG.isPoint(r[1]))n=new JXG.Circle(e,"pointLine",r[1],r[0],a);else if(r[1].elementClass==JXG.OBJECT_CLASS_LINE&&JXG.isPoint(r[0]))n=new JXG.Circle(e,"pointLine",r[0],r[1],a);else{if(!(3==t.length&&JXG.isPoint(r[0])&&JXG.isPoint(r[1])&&JXG.isPoint(r[2])))throw Error("JSXGraph: Can't create circle with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point], [point,number], [point,function], [point,circle], [point,point,point]");n=JXG.createCircumcircle(e,r,i)}for(n.isDraggable=s,n.parents=[],o=0;t.length>o;o++)t[o].id&&n.parents.push(t[o].id);return n.elType="circle",n},JXG.JSXGraph.registerElement("circle",JXG.createCircle),JXG.createEllipse=function(e,t,i){var n,r,o,a,s=[],l=JXG.copyAttributes(i,e.options,"conic","foci"),c=JXG.copyAttributes(i,e.options,"conic");for(o=0;2>o;o++)if(t[o].length>1)s[o]=e.create("point",t[o],l);else if(JXG.isPoint(t[o]))s[o]=JXG.getReference(e,t[o]);else if("function"==typeof t[o]&&t[o]().elementClass===JXG.OBJECT_CLASS_POINT)s[o]=t[o]();else{if(!JXG.isString(t[o]))throw Error("JSXGraph: Can't create Ellipse with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point,point], [point,point,number|function]");s[o]=JXG.getReference(e,t[o])}if(JXG.isNumber(t[2]))r=JXG.createFunction(t[2],e);else if("function"==typeof t[2]&&JXG.isNumber(t[2]()))r=t[2];else{if(JXG.isPoint(t[2]))n=JXG.getReference(e,t[2]);else if(t[2].length>1)n=e.create("point",t[2],l);else if("function"==typeof t[2]&&t[2]().elementClass==JXG.OBJECT_CLASS_POINT)n=t[2]();else{if(!JXG.isString(t[2]))throw Error("JSXGraph: Can't create Ellipse with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point], [point,point,number|function]");n=JXG.getReference(e,t[2])}r=function(){return n.Dist(s[0])+n.Dist(s[1])}}t[4]===void 0&&(t[4]=1.0001*Math.PI),t[3]===void 0&&(t[3]=-1.0001*Math.PI);var u=e.create("point",[function(){return.5*(s[0].X()+s[1].X())},function(){return.5*(s[0].Y()+s[1].Y())}],l),d=function(){var e,t,i,n=s[0].X(),r=s[0].Y(),o=s[1].X(),a=s[1].Y(),l=o-n>0?1:-1;e=Math.abs(o-n)>1e-7?Math.atan2(a-r,o-n)+(0>l?Math.PI:0):(a-r>0?.5:-.5)*Math.PI,t=Math.cos(e),i=Math.sin(e);var c=[[1,0,0],[u.X(),t,-i],[u.Y(),i,t]];return c},h=e.create("curve",[function(){return 0},function(){return 0},t[3],t[4]],c),p=function(e,t){var i,n,o=.5*r(),l=o*o,c=.5*s[1].Dist(s[0]),p=l-c*c,f=Math.sqrt(p),g=[[1,0,0],[0,1,0],[0,0,1]];return t||(a=d(),i=u.X(),n=u.Y(),g[0][0]=a[0][0],g[0][1]=0,g[0][2]=0,g[1][0]=i*(1-a[1][1])+n*a[1][2],g[1][1]=a[1][1],g[1][2]=a[2][1],g[2][0]=n*(1-a[1][1])-i*a[1][2],g[2][1]=a[1][2],g[2][2]=a[2][2],h.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(g),JXG.Math.matMatMult([[-1+i*i/(o*o)+n*n/p,-i/l,-i/p],[-i/l,1/l,0],[-n/p,0,1/p]],g))),JXG.Math.matVecMult(a,[1,o*Math.cos(e),f*Math.sin(e)])};for(h.X=function(e,t){return p(e,t)[1]},h.Y=function(e,t){return p(e,t)[2]},h.midpoint=u,h.type=JXG.OBJECT_TYPE_CONIC,u.addChild(h),o=0;2>o;o++)JXG.isPoint(s[o])&&s[o].addChild(h);for(JXG.isPoint(n)&&n.addChild(h),h.parents=[],o=0;t.length>o;o++)t[o].id&&h.parents.push(t[o].id);return h},JXG.createHyperbola=function(e,t,i){var n,r,o,a,s=[],l=JXG.copyAttributes(i,e.options,"conic","foci"),c=JXG.copyAttributes(i,e.options,"conic");for(o=0;2>o;o++)if(t[o].length>1)s[o]=e.create("point",t[o],attr_focu);else if(JXG.isPoint(t[o]))s[o]=JXG.getReference(e,t[o]);else if("function"==typeof t[o]&&t[o]().elementClass==JXG.OBJECT_CLASS_POINT)s[o]=t[o]();else{if(!JXG.isString(t[o]))throw Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point,point], [point,point,number|function]");s[o]=JXG.getReference(e,t[o])}if(JXG.isNumber(t[2]))r=JXG.createFunction(t[2],e);else if("function"==typeof t[2]&&JXG.isNumber(t[2]()))r=t[2];else{if(JXG.isPoint(t[2]))n=JXG.getReference(e,t[2]);else if(t[2].length>1)n=e.create("point",t[2],l);else if("function"==typeof t[2]&&t[2]().elementClass==JXG.OBJECT_CLASS_POINT)n=t[2]();else{if(!JXG.isString(t[2]))throw Error("JSXGraph: Can't create Hyperbola with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point], [point,point,number|function]");n=JXG.getReference(e,t[2])}r=function(){return n.Dist(s[0])-n.Dist(s[1])}}t[4]===void 0&&(t[4]=1.0001*Math.PI),t[3]===void 0&&(t[3]=-1.0001*Math.PI);var u=e.create("point",[function(){return.5*(s[0].X()+s[1].X())},function(){return.5*(s[0].Y()+s[1].Y())}],l),d=function(){var e,t=s[0].X(),i=s[0].Y(),n=s[1].X(),r=s[1].Y(),o=n-t>0?1:-1;e=Math.abs(n-t)>1e-7?Math.atan2(r-i,n-t)+(0>o?Math.PI:0):(r-i>0?.5:-.5)*Math.PI;var a=[[1,0,0],[u.X(),Math.cos(e),-Math.sin(e)],[u.Y(),Math.sin(e),Math.cos(e)]];return a},h=e.create("curve",[function(){return 0},function(){return 0},t[3],t[4]],c),p=function(e,t){var i,n,o=.5*r(),l=o*o,c=.5*s[1].Dist(s[0]),p=Math.sqrt(-o*o+c*c),f=p*p,g=[[1,0,0],[0,1,0],[0,0,1]];return t||(a=d(),i=u.X(),n=u.Y(),g[0][0]=a[0][0],g[0][1]=0,g[0][2]=0,g[1][0]=i*(1-a[1][1])+n*a[1][2],g[1][1]=a[1][1],g[1][2]=a[2][1],g[2][0]=n*(1-a[1][1])-i*a[1][2],g[2][1]=a[1][2],g[2][2]=a[2][2],h.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(g),JXG.Math.matMatMult([[-1+i*i/l+n*n/f,-i/l,n/f],[-i/l,1/l,0],[n/f,0,-1/f]],g))),JXG.Math.matVecMult(a,[1,o/Math.cos(e),p*Math.tan(e)])};for(h.X=function(e,t){return p(e,t)[1]},h.Y=function(e,t){return p(e,t)[2]},h.midpoint=u,h.type=JXG.OBJECT_TYPE_CONIC,u.addChild(h),o=0;2>o;o++)JXG.isPoint(s[o])&&s[o].addChild(h);for(JXG.isPoint(n)&&n.addChild(h),h.parents=[],o=0;t.length>o;o++)t[o].id&&h.parents.push(t[o].id);return h},JXG.createParabola=function(e,t,n){var r,o=t[0],a=t[1],s=JXG.copyAttributes(n,e.options,"conic","foci"),l=JXG.copyAttributes(n,e.options,"conic");if(t[0].length>1)o=e.create("point",t[0],s);else if(JXG.isPoint(t[0]))o=JXG.getReference(e,t[0]);else if("function"==typeof t[0]&&t[0]().elementClass==JXG.OBJECT_CLASS_POINT)o=t[0]();else{if(!JXG.isString(t[0]))throw Error("JSXGraph: Can't create Parabola with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line]");o=JXG.getReference(e,t[0])}t[3]===void 0&&(t[3]=10),t[2]===void 0&&(t[2]=-10);var c=e.create("point",[function(){var t=[0,a.stdform[1],a.stdform[2]];return t=JXG.Math.crossProduct(t,o.coords.usrCoords),JXG.Math.Geometry.meetLineLine(t,a.stdform,0,e).usrCoords}],s),u=function(){var e=Math.atan(a.getSlope()),t=.5*(c.X()+o.X()),i=.5*(c.Y()+o.Y());e+=0>o.Y()-c.Y()||o.Y()==c.Y()&&o.X()>c.X()?Math.PI:0;var n=[[1,0,0],[t*(1-Math.cos(e))+i*Math.sin(e),Math.cos(e),-Math.sin(e)],[i*(1-Math.cos(e))-t*Math.sin(e),Math.sin(e),Math.cos(e)]];return n},d=e.create("curve",[function(){return 0},function(){return 0},t[2],t[3]],l),h=function(e,t){var i=.5*c.Dist(o),n=[[1,0,0],[0,1,0],[0,0,1]],a=.5*(c.X()+o.X()),s=.5*(c.Y()+o.Y());return t||(r=u(),n[0][0]=r[0][0],n[0][1]=0,n[0][2]=0,n[1][0]=a*(1-r[1][1])+s*r[1][2],n[1][1]=r[1][1],n[1][2]=r[2][1],n[2][0]=s*(1-r[1][1])-a*r[1][2],n[2][1]=r[1][2],n[2][2]=r[2][2],d.quadraticform=JXG.Math.matMatMult(JXG.Math.transpose(n),JXG.Math.matMatMult([[4*-s*i-a*a,a,2*i],[a,-1,0],[2*i,0,0]],n))),JXG.Math.matVecMult(r,[1,e+a,e*e/(4*i)+s])};for(d.X=function(e,t){return h(e,t)[1]},d.Y=function(e,t){return h(e,t)[2]},d.type=JXG.OBJECT_TYPE_CONIC,c.addChild(d),JXG.isPoint(F[1])&&F[1].addChild(d),a.addChild(d),d.parents=[],i=0;t.length>i;i++)t[i].id&&d.parents.push(t[i].id);return d},JXG.createConic=function(e,t,i){var n,r,o,a,s,l,c,u,d,h=[[1,0,0],[0,1,0],[0,0,1]],p=[[1,0,0],[0,1,0],[0,0,1]],f=[],g=[],m=JXG.copyAttributes(i,e.options,"conic","foci"),b=JXG.copyAttributes(i,e.options,"conic");if(5==t.length)d=!0;else{if(6!=t.length)throw Error("JSXGraph: Can't create generic Conic with "+parent.length+" parameters.");d=!1}if(d)for(c=0;5>c;c++)if(t[c].length>1)f[c]=e.create("point",t[c],m);else if(JXG.isPoint(t[c]))f[c]=JXG.getReference(e,t[c]);else if("function"==typeof t[c]&&t[c]().elementClass==JXG.OBJECT_CLASS_POINT)f[c]=t[c]();else{if(!JXG.isString(t[c]))throw Error("JSXGraph: Can't create Conic section with parent types '"+typeof t[c]+"'."+"\nPossible parent types: [point,point,point,point,point], [a00,a11,a22,a01,a02,a12]");f[c]=JXG.getReference(e,t[c])}else u=[[0,0,0],[0,0,0],[0,0,0]],u[0][0]=JXG.isFunction(t[2])?function(){return t[2]()}:function(){return t[2]},u[0][1]=JXG.isFunction(t[4])?function(){return t[4]()}:function(){return t[4]},u[0][2]=JXG.isFunction(t[5])?function(){return t[5]()}:function(){return t[5]},u[1][1]=JXG.isFunction(t[0])?function(){return t[0]()}:function(){return t[0]},u[1][2]=JXG.isFunction(t[3])?function(){return t[3]()}:function(){return t[3]},u[2][2]=JXG.isFunction(t[1])?function(){return t[1]()}:function(){return t[1]};var v=function(e){var t,i;for(t=0;3>t;t++)for(i=t;3>i;i++)e[t][i]+=e[i][t];for(t=0;3>t;t++)for(i=0;t>i;i++)e[t][i]=e[i][t];return e},y=function(e,t){var i,n,r=[[0,0,0],[0,0,0],[0,0,0]];for(i=0;3>i;i++)for(n=0;3>n;n++)r[i][n]=e[i]*t[n];return v(r)},x=function(e,t,i){var n,r,o,a,s,l=[[0,0,0],[0,0,0],[0,0,0]];for(o=JXG.Math.matVecMult(t,i),n=JXG.Math.innerProduct(i,o),o=JXG.Math.matVecMult(e,i),r=JXG.Math.innerProduct(i,o),a=0;3>a;a++)for(s=0;3>s;s++)l[a][s]=n*e[a][s]-r*t[a][s];return l},C=e.create("curve",[function(){return 0},function(){return 0},0,2*Math.PI],b),w=function(e,t){var i,c,m,b;if(!t){if(d){for(i=0;5>i;i++)g[i]=f[i].coords.usrCoords;s=y(JXG.Math.crossProduct(g[0],g[1]),JXG.Math.crossProduct(g[2],g[3])),l=y(JXG.Math.crossProduct(g[0],g[2]),JXG.Math.crossProduct(g[1],g[3])),p=x(s,l,g[4])}else for(i=0;3>i;i++)for(c=i;3>c;c++)p[i][c]=u[i][c](),c>i&&(p[c][i]=p[i][c]);for(C.quadraticform=p,n=JXG.Math.Numerics.Jacobi(p),0>n[0][0][0]&&(n[0][0][0]*=-1,n[0][1][1]*=-1,n[0][2][2]*=-1),i=0;3>i;i++){for(m=0,c=0;3>c;c++)m+=n[1][c][i]*n[1][c][i];for(m=Math.sqrt(m),c=0;3>c;c++);}h=n[1],a=Math.sqrt(Math.abs(n[0][0][0])),r=Math.sqrt(Math.abs(n[0][1][1])),o=Math.sqrt(Math.abs(n[0][2][2]))}return 0>=n[0][1][1]&&0>=n[0][2][2]?b=JXG.Math.matVecMult(h,[1/a,Math.cos(e)/r,Math.sin(e)/o]):0>=n[0][1][1]&&n[0][2][2]>0?b=JXG.Math.matVecMult(h,[Math.cos(e)/a,1/r,Math.sin(e)/o]):0>n[0][2][2]&&(b=JXG.Math.matVecMult(h,[Math.sin(e)/a,Math.cos(e)/r,1/o])),b[1]/=b[0],b[2]/=b[0],b[0]=1,b};if(C.X=function(e,t){return w(e,t)[1]},C.Y=function(e,t){return w(e,t)[2]},C.midpoint=e.create("point",[function(){var e=C.quadraticform;return[e[1][1]*e[2][2]-e[1][2]*e[1][2],e[1][2]*e[0][2]-e[2][2]*e[0][1],e[0][1]*e[1][2]-e[1][1]*e[0][2]]}],m),C.type=JXG.OBJECT_TYPE_CONIC,d){for(c=0;5>c;c++)JXG.isPoint(f[c])&&f[c].addChild(C);for(C.parents=[],c=0;t.length>c;c++)t[c].id&&C.parents.push(t[c].id)}return C.addChild(C.midpoint),C},JXG.JSXGraph.registerElement("ellipse",JXG.createEllipse),JXG.JSXGraph.registerElement("hyperbola",JXG.createHyperbola),JXG.JSXGraph.registerElement("parabola",JXG.createParabola),JXG.JSXGraph.registerElement("conic",JXG.createConic),JXG.Polygon=function(e,t,i){this.constructor(e,i,JXG.OBJECT_TYPE_POLYGON,JXG.OBJECT_CLASS_AREA);var n,r,o,a=JXG.copyAttributes(i,e.options,"polygon","borders");for(this.withLines=i.withlines,this.attr_line=a,this.vertices=[],n=0;t.length>n;n++)r=JXG.getRef(this.board,t[n]),this.vertices[n]=r;if(this.vertices[this.vertices.length-1]!=this.vertices[0]&&this.vertices.push(this.vertices[0]),this.borders=[],this.withLines)for(n=0;this.vertices.length-1>n;n++)a.id=a.ids&&a.ids[n],a.strokecolor=JXG.isArray(a.colors)&&a.colors[n%a.colors.length]||a.strokecolor,a.strokecolor===!1&&(a.strokecolor="none"),o=JXG.createSegment(e,[this.vertices[n],this.vertices[n+1]],a),o.dump=!1,this.borders[n]=o,o.parentPolygon=this;for(n=0;this.vertices.length-1>n;n++)r=JXG.getReference(this.board,this.vertices[n]),r.addChild(this);this.id=this.board.setId(this,"Py"),this.board.renderer.drawPolygon(this),this.board.finalizeAdding(this),this.elType="polygon",this.createLabel(),this.methodMap.borders="borders",this.methodMap.vertices="vertices"},JXG.Polygon.prototype=new JXG.GeometryElement,JXG.extend(JXG.Polygon.prototype,{hasPoint:function(e,t){var i,n,r,o=!1;if(this.visProp.hasinnerpoints)for(r=this.vertices.length,i=0,n=r-2;r-1>i;n=i++)this.vertices[i].coords.scrCoords[2]>t!=this.vertices[n].coords.scrCoords[2]>t&&(this.vertices[n].coords.scrCoords[1]-this.vertices[i].coords.scrCoords[1])*(t-this.vertices[i].coords.scrCoords[2])/(this.vertices[n].coords.scrCoords[2]-this.vertices[i].coords.scrCoords[2])+this.vertices[i].coords.scrCoords[1]>e&&(o=!o);else for(r=this.borders.length,i=0;r>i;i++)if(this.borders[i].hasPoint(e,t)){o=!0;break}return o},updateRenderer:function(){this.needsUpdate&&(this.board.renderer.updatePolygon(this),this.needsUpdate=!1),this.hasLabel&&this.label.content.visProp.visible&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))},getTextAnchor:function(){var e,t=this.vertices[0].X(),i=this.vertices[0].Y(),n=t,r=i;for(e=0;this.vertices.length>e;e++)t>this.vertices[e].X()&&(t=this.vertices[e].X()),this.vertices[e].X()>n&&(n=this.vertices[e].X()),this.vertices[e].Y()>i&&(i=this.vertices[e].Y()),r>this.vertices[e].Y()&&(r=this.vertices[e].Y());return new JXG.Coords(JXG.COORDS_BY_USER,[.5*(t+n),.5*(i+r)],this.board)},getLabelAnchor:JXG.shortcut(JXG.Polygon.prototype,"getTextAnchor"),cloneToBackground:function(){var e,t={};return t.id=this.id+"T"+this.numTraces,this.numTraces++,t.vertices=this.vertices,t.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),t.visProp.layer=this.board.options.layer.trace,t.board=this.board,JXG.clearVisPropOld(t),e=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawPolygon(t),this.board.renderer.enhancedRendering=e,this.traces[t.id]=t.rendNode,this},hideElement:function(){var e;for(this.visProp.visible=!1,this.board.renderer.hide(this),e=0;this.borders.length>e;e++)this.borders[e].hideElement();this.hasLabel&&JXG.exists(this.label)&&(this.label.hiddenByParent=!0,this.label.content.visProp.visible&&this.board.renderer.hide(this.label.content))},showElement:function(){var e;for(this.visProp.visible=!0,this.board.renderer.show(this),e=0;this.borders.length>e;e++)this.borders[e].showElement();this.hasLabel&&JXG.exists(this.label)&&this.label.content.visProp.visible&&this.board.renderer.show(this.label.content)},Area:function(){var e,t=0;for(e=0;this.vertices.length-1>e;e++)t+=this.vertices[e].X()*this.vertices[e+1].Y()-this.vertices[e+1].X()*this.vertices[e].Y();return t/=2,Math.abs(t)},remove:function(){var e;for(e=0;this.borders.length>e;e++)this.board.removeObject(this.borders[e]);JXG.GeometryElement.prototype.remove.call(this)},findPoint:function(e){var t;if(!JXG.isPoint(e))return-1;for(t=0;this.vertices.length>t;t++)if(this.vertices[t].id===e.id)return t;return-1},addPoints:function(){var e=Array.prototype.slice.call(arguments);return this.insertPoints.apply(this,[this.vertices.length-2].concat(e))},insertPoints:function(){var e,t,i,n=[];if(0===arguments.length)return this;if(e=arguments[0],0>e||e>this.vertices.length-2)return this;for(t=1;arguments.length>t;t++)JXG.isPoint(arguments[t])&&n.push(arguments[t]);if(i=this.vertices.slice(0,e+1).concat(n),this.vertices=i.concat(this.vertices.slice(e+1)),this.withLines){for(i=this.borders.slice(0,e),this.board.removeObject(this.borders[e]),t=0;n.length>t;t++)i.push(JXG.createSegment(this.board,[this.vertices[e+t],this.vertices[e+t+1]],this.attr_line));i.push(JXG.createSegment(this.board,[this.vertices[e+n.length],this.vertices[e+n.length+1]],this.attr_line)),this.borders=i.concat(this.borders.slice(e))}return this.board.update(),this},removePoints:function(){var e,t,i,n=[],r=[],o=[],a=[];for(this.vertices=this.vertices.slice(0,this.vertices.length-1),e=0;arguments.length>e;e++)JXG.isPoint(arguments[e])&&(i=this.findPoint(arguments[e])),JXG.isNumber(i)&&i>-1&&this.vertices.length>i&&-1===JXG.indexOf(o,i)&&o.push(i);for(o=o.sort(),n=this.vertices.slice(),r=this.borders.slice(),this.withLines&&a.push([o[o.length-1]]),e=o.length-1;e>-1;e--)n[o[e]]=-1,this.withLines&&o[e]-1>o[e-1]&&(a[a.length-1][1]=o[e],a.push([o[e-1]]));for(this.withLines&&(a[a.length-1][1]=o[0]),this.vertices=[],e=0;n.length>e;e++)JXG.isPoint(n[e])&&this.vertices.push(n[e]);if(this.vertices[this.vertices.length-1].id!==this.vertices[0].id&&this.vertices.push(this.vertices[0]),this.withLines){for(e=0;a.length>e;e++){for(t=a[e][1]-1;a[e][0]+1>t;t++)0>t?(t=0,this.board.removeObject(this.borders[r.length-1]),r[r.length-1]=-1):t>r.length-1&&(t=r.length-1),this.board.removeObject(this.borders[t]),r[t]=-1;0!==a[e][1]&&a[e][0]!==n.length-1&&(r[a[e][0]-1]=JXG.createSegment(this.board,[n[Math.max(a[e][1]-1,0)],n[Math.min(a[e][0]+1,this.vertices.length-1)]],this.attr_line))}for(this.borders=[],e=0;r.length>e;e++)-1!==r[e]&&this.borders.push(r[e]);(5===a[0][1]||0===a[a.length-1][1])&&this.borders.push(JXG.createSegment(this.board,[this.vertices[0],this.vertices[this.vertices.length-2]],this.attr_line))}return this.board.update(),this},getParents:function(){var e,t=[];for(e=0;this.vertices.length>e;e++)t.push(this.vertices[e].id);return t},getAttributes:function(){var e,t=JXG.GeometryElement.prototype.getAttributes.call(this);if(this.withLines)for(t.lines=t.lines||{},t.lines.ids=[],t.lines.colors=[],e=0;this.borders.length>e;e++)t.lines.ids.push(this.borders[e].id),t.lines.colors.push(this.borders[e].visProp.strokecolor);return t},setPositionDirectly:function(e,t,i){var n,r,o,a,s=new JXG.Coords(e,t,this.board),l=new JXG.Coords(e,i,this.board);for(a=this.vertices.length-1,o=0;a>o;o++)if(!this.vertices[o].draggable())return this;return n=JXG.Math.Statistics.subtract(s.usrCoords,l.usrCoords),r=this.board.create("transform",n.slice(1),{type:"translate"}),r.applyOnce(this.vertices.slice(0,-1)),this}}),JXG.createPolygon=function(e,t,i){var n,r,o=JXG.copyAttributes(i,e.options,"polygon");for(r=0;t.length>r;r++)if(t[r]=JXG.getReference(e,t[r]),!JXG.isPoint(t[r]))throw Error("JSXGraph: Can't create polygon with parent types other than 'point'.");return n=new JXG.Polygon(e,t,o),n.isDraggable=!0,n},JXG.createRegularPolygon=function(e,t,i){var n,r,o,a,s,l,c,u=[];if(JXG.isNumber(t[t.length-1])&&3!=t.length)throw Error("JSXGraph: A regular polygon needs two points and a number as input.");if(s=t.length,o=t[s-1],!JXG.isNumber(o)&&!JXG.isPoint(JXG.getReference(e,o))||3>o)throw Error("JSXGraph: The third parameter has to be number greater than 2 or a point.");for(JXG.isPoint(JXG.getReference(e,o))?(o=s,l=!0):(s--,l=!1),r=0;s>r;r++)if(t[r]=JXG.getReference(e,t[r]),!JXG.isPoint(t[r]))throw Error("JSXGraph: Can't create regular polygon if the first two parameters aren't points.");for(u[0]=t[0],u[1]=t[1],c=JXG.copyAttributes(i,e.options,"polygon","vertices"),r=2;o>r;r++)a=e.create("transform",[Math.PI*(2-(o-2)/o),u[r-1]],{type:"rotate"}),l?(u[r]=t[r],u[r].addTransform(t[r-2],a)):(JXG.isArray(c.ids)&&c.ids.length>=o-2&&(c.id=c.ids[r-2]),u[r]=e.create("point",[u[r-2],a],c),u[r].type=JXG.OBJECT_TYPE_CAS,u[r].isDraggable=!0,u[r].visProp.fixed=!1);return c=JXG.copyAttributes(i,e.options,"polygon"),n=e.create("polygon",u,c),n.elType="regularpolygon",n},JXG.JSXGraph.registerElement("polygon",JXG.createPolygon),JXG.JSXGraph.registerElement("regularpolygon",JXG.createRegularPolygon),JXG.Curve=function(e,t,i){this.constructor(e,i,JXG.OBJECT_TYPE_CURVE,JXG.OBJECT_CLASS_CURVE),this.points=[],this.numberPoints=this.visProp.numberpointshigh,this.bezierDegree=1,this.dataX=null,this.dataY=null,this.varname=null!=t[0]?t[0]:"x",this.xterm=t[1],this.yterm=t[2],this.generateTerm(this.varname,this.xterm,this.yterm,t[3],t[4]),this.updateCurve(),this.id=this.board.setId(this,"G"),this.board.renderer.drawCurve(this),this.board.finalizeAdding(this),this.createGradient(),this.elType="curve",this.createLabel(),"string"==typeof this.xterm&&this.notifyParents(this.xterm),"string"==typeof this.yterm&&this.notifyParents(this.yterm)},JXG.Curve.prototype=new JXG.GeometryElement,JXG.extend(JXG.Curve.prototype,{minX:function(){if("polar"==this.visProp.curvetype)return 0;var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board);return e.usrCoords[1]},maxX:function(){var e;return"polar"==this.visProp.curvetype?2*Math.PI:(e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board),e.usrCoords[1])},Z:function(){return 1},hasPoint:function(e,t,i){var n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x=1/0,C=this.visProp.numberpointslow,w=(this.maxX()-this.minX())/C,k=this.board.options.precision.hasPoint/this.board.unitX,_=!0;if(k*=k,m=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),e=m.usrCoords[1],t=m.usrCoords[2],this.transformations.length>0&&(this.updateTransformMatrix(),v=JXG.Math.inverse(this.transformMat),y=JXG.Math.matVecMult(v,[1,e,t]),e=y[1],t=y[2]),"parameter"==this.visProp.curvetype||"polar"==this.visProp.curvetype||"functiongraph"==this.visProp.curvetype)for(r=0,n=this.minX();C>r;r++){if(o=this.X(n,_),a=this.Y(n,_),x=(e-o)*(e-o)+(t-a)*(t-a),k>x)return!0;n+=w}else if("plot"==this.visProp.curvetype){for((!JXG.exists(i)||0>i)&&(i=0),b=this.numberPoints,r=i;b-1>r;r++)if(s=this.X(r),l=this.Y(r),c=e-s,u=t-l,d=this.X(r+1)-s,h=this.Y(r+1)-l,f=d*d+h*h,x=c*c+u*u,f>=JXG.Math.eps?(p=c*d+u*h,g=p/f,x-=g*p):g=0,g>=0&&1>=g&&k>x)return!0;return!1}return k>x},allocatePoints:function(){var e,t;if(t=this.numberPoints,this.points.length<this.numberPoints)for(e=this.points.length;t>e;e++)this.points[e]=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)},update:function(){return this.needsUpdate&&(this.visProp.trace&&this.cloneToBackground(!0),this.updateCurve()),this
},updateRenderer:function(){return this.needsUpdate&&this.visProp.visible&&(this.board.renderer.updateCurve(this),this.needsUpdate=!1,this.hasLabel&&this.label.content.visProp.visible&&(this.label.content.update(),this.board.renderer.updateText(this.label.content))),this},updateDataArray:function(){},updateCurve:function(){var e,t,i,n,r,o,a=!1;if(this.updateTransformMatrix(),this.updateDataArray(),t=this.minX(),i=this.maxX(),null!=this.dataX)for(this.numberPoints=this.dataX.length,e=this.numberPoints,this.allocatePoints(),o=0;e>o;o++)n=o,null!=this.dataY?(r=o,this.points[o].setCoordinates(JXG.COORDS_BY_USER,[this.dataX[o],this.dataY[o]],!1)):(r=this.X(n),this.points[o].setCoordinates(JXG.COORDS_BY_USER,[this.dataX[o],this.Y(r,a)],!1)),this.updateTransform(this.points[o]),a=!0;else for(this.visProp.doadvancedplot?this.updateParametricCurve(t,i,e):(this.numberPoints=this.board.updateQuality==this.board.BOARD_QUALITY_HIGH?this.visProp.numberpointshigh:this.visProp.numberpointslow,this.allocatePoints(),this.updateParametricCurveNaive(t,i,this.numberPoints)),e=this.numberPoints,o=0;e>o;o++)this.updateTransform(this.points[o]);return this},updateTransformMatrix:function(){var e,t,i=this.transformations.length;for(this.transformMat=[[1,0,0],[0,1,0],[0,0,1]],t=0;i>t;t++)e=this.transformations[t],e.update(),this.transformMat=JXG.Math.matMatMult(e.matrix,this.transformMat);return this},updateParametricCurveNaive:function(e,t,i){var n,r,o=!1,a=(t-e)/i;for(n=0;i>n;n++)r=e+n*a,this.points[n].setCoordinates(JXG.COORDS_BY_USER,[this.X(r,o),this.Y(r,o)],!1),o=!0;return this},updateParametricCurve:function(e,t){var i,n,r,o,a,s,l,c,u,d,h,p,f,g=!1,m=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board),b=[],v=[],y=[],x=[],C=!1,w=0,k=function(e,t,i){var n,r,o=i[1]-e[1],a=i[2]-e[2],s=t[0]-e[1],l=t[1]-e[2],c=s*s+l*l;return c>=JXG.Math.eps&&(n=(o*s+a*l)/c,n>0&&(1>=n?(o-=n*s,a-=n*l):(o-=s,a-=l))),r=o*o+a*a,Math.sqrt(r)};for(this.board.updateQuality==this.board.BOARD_QUALITY_LOW?(d=15,h=10,p=10):(d=21,h=.7,p=.7),x[0]=t-e,i=1;d>i;i++)x[i]=.5*x[i-1];i=1,b[0]=1,v[0]=0,n=e,m.setCoordinates(JXG.COORDS_BY_USER,[this.X(n,g),this.Y(n,g)],!1),g=!0,s=m.scrCoords[1],l=m.scrCoords[2],r=n,n=t,m.setCoordinates(JXG.COORDS_BY_USER,[this.X(n,g),this.Y(n,g)],!1),o=m.scrCoords[1],a=m.scrCoords[2],y[0]=[o,a],c=1,u=0,this.points=[],this.points[w++]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[s,l],this.board);do{for(C=this.isDistOK(o-s,a-l,h,p)||this.isSegmentOutside(s,l,o,a);d>u&&(!C||6>u)&&(7>=u||this.isSegmentDefined(s,l,o,a));)b[c]=i,v[c]=u,y[c]=[o,a],c++,i=2*i-1,u++,n=e+i*x[u],m.setCoordinates(JXG.COORDS_BY_USER,[this.X(n,g),this.Y(n,g)],!1),o=m.scrCoords[1],a=m.scrCoords[2],C=this.isDistOK(o-s,a-l,h,p)||this.isSegmentOutside(s,l,o,a);w>1&&(f=k(this.points[w-2].scrCoords,[o,a],this.points[w-1].scrCoords),.015>f&&w--),this.points[w]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[o,a],this.board),w++,s=o,l=a,r=n,c--,o=y[c][0],a=y[c][1],u=v[c]+1,i=2*b[c]}while(c>0&&5e5>w);return this.numberPoints=this.points.length,this},isSegmentOutside:function(e,t,i,n){return 0>t&&0>n||t>this.board.canvasHeight&&n>this.board.canvasHeight||0>e&&0>i||e>this.board.canvasWidth&&i>this.board.canvasWidth},isDistOK:function(e,t,i,n){return i>Math.abs(e)&&n>Math.abs(t)&&!isNaN(e+t)},isSegmentDefined:function(e,t,i,n){return!isNaN(e+t)||!isNaN(i+n)},updateTransform:function(e){var t,i=this.transformations.length;return i>0&&(t=JXG.Math.matVecMult(this.transformMat,e.usrCoords),e.setCoordinates(JXG.COORDS_BY_USER,[t[1],t[2]])),e},addTransform:function(e){var t,i=JXG.isArray(e)?e:[e],n=i.length;for(t=0;n>t;t++)this.transformations.push(i[t]);return this},setPosition:function(e,t){var i,n,r,o=0;for(JXG.exists(this.parents)&&(o=this.parents.length),r=0;o>r;r++)if(n=JXG.getRef(this.board,this.parents[r]),!n.draggable())return this;if(t=new JXG.Coords(e,t,this.board),i=this.board.create("transform",t.usrCoords.slice(1),{type:"translate"}),o>0)for(r=0;o>r;r++)n=JXG.getRef(this.board,this.parents[r]),i.applyOnce(n);else this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix?this.transformations[this.transformations.length-1].melt(i):this.addTransform(i);return this},setPositionDirectly:function(e,t,i){var n=new JXG.Coords(e,t,this.board),r=new JXG.Coords(e,i,this.board),o=JXG.Math.Statistics.subtract(n.usrCoords,r.usrCoords);return this.setPosition(JXG.COORDS_BY_USER,o),this},interpolationFunctionFromArray:function(e){var t="data"+e;return function(e){var i,n,r,o,a=this[t],s=a.length,l=[];if(isNaN(e))return 0/0;if(0>e)return JXG.isFunction(a[0])?a[0]():a[0];if(3==this.bezierDegree){if(s/=3,e>=s)return JXG.isFunction(a[a.length-1])?a[a.length-1]():a[a.length-1];for(i=3*Math.floor(e),n=e%1,r=1-n,o=0;4>o;o++)l[o]=JXG.isFunction(a[i+o])?a[i+o]():a[i+o];return r*r*(r*l[0]+3*n*l[1])+(3*r*l[2]+n*l[3])*n*n}if(i=e>s-2?s-2:parseInt(Math.floor(e)),i==e)return JXG.isFunction(a[i])?a[i]():a[i];for(o=0;2>o;o++)l[o]=JXG.isFunction(a[i+o])?a[i+o]():a[i+o];return l[0]+(l[1]-l[0])*(e-i)}},generateTerm:function(e,t,i,n,r){var o,a;JXG.isArray(t)?(this.dataX=t,this.numberPoints=this.dataX.length,this.X=this.interpolationFunctionFromArray("X"),this.visProp.curvetype="plot",this.isDraggable=!0):(this.X=JXG.createFunction(t,this.board,e),JXG.isString(t)?this.visProp.curvetype="functiongraph":(JXG.isFunction(t)||JXG.isNumber(t))&&(this.visProp.curvetype="parameter"),this.isDraggable=!0),JXG.isArray(i)?(this.dataY=i,this.Y=this.interpolationFunctionFromArray("Y")):this.Y=JXG.createFunction(i,this.board,e),JXG.isFunction(t)&&JXG.isArray(i)&&(o=JXG.createFunction(i[0],this.board,""),a=JXG.createFunction(i[1],this.board,""),this.X=function(e){return t(e)*Math.cos(e)+o()},this.Y=function(e){return t(e)*Math.sin(e)+a()},this.visProp.curvetype="polar"),null!=n&&(this.minX=JXG.createFunction(n,this.board,"")),null!=r&&(this.maxX=JXG.createFunction(r,this.board,""))},notifyParents:function(e){JXG.GeonextParser.findDependencies(this,e,this.board)},getLabelAnchor:function(){var e,t,i,n=.05*this.board.canvasWidth,r=.05*this.board.canvasHeight,o=.95*this.board.canvasWidth,a=.95*this.board.canvasHeight;switch(this.visProp.label.position){case"ulft":t=n,i=r;break;case"llft":t=n,i=a;break;case"rt":t=o,i=.5*a;break;case"lrt":t=o,i=a;break;case"urt":t=o,i=r;break;case"top":t=.5*o,i=r;break;case"bot":t=.5*o,i=a;break;case"lft":default:t=n,i=.5*a}return e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[t,i],this.board),JXG.Math.Geometry.projectCoordsToCurve(e.usrCoords[1],e.usrCoords[2],0,this,this.board)[0]},cloneToBackground:function(){var e,t={};return t.id=this.id+"T"+this.numTraces,t.elementClass=JXG.OBJECT_CLASS_CURVE,this.numTraces++,t.points=this.points.slice(0),t.numberPoints=this.numberPoints,t.board=this.board,t.visProp=JXG.deepCopy(this.visProp,this.visProp.traceattributes,!0),t.visProp.layer=this.board.options.layer.trace,t.visProp.curvetype=this.visProp.curvetype,JXG.clearVisPropOld(t),e=this.board.renderer.enhancedRendering,this.board.renderer.enhancedRendering=!0,this.board.renderer.drawCurve(t),this.board.renderer.enhancedRendering=e,this.traces[t.id]=t.rendNode,this},bounds:function(){var e,t=1/0,i=-1/0,n=1/0,r=-1/0,o=this.points.length;for(e=0;o>e;e++)t>this.points[e].usrCoords[1]&&(t=this.points[e].usrCoords[1]),this.points[e].usrCoords[1]>i&&(i=this.points[e].usrCoords[1]),n>this.points[e].usrCoords[2]&&(n=this.points[e].usrCoords[2]),this.points[e].usrCoords[2]>r&&(r=this.points[e].usrCoords[2]);return[t,r,i,n]}}),JXG.createCurve=function(e,t,i){var n=JXG.copyAttributes(i,e.options,"curve");return new JXG.Curve(e,["x"].concat(t),n)},JXG.JSXGraph.registerElement("curve",JXG.createCurve),JXG.createFunctiongraph=function(e,t,i){var n,r=["x","x"].concat(t);return n=JXG.copyAttributes(i,e.options,"curve"),n.curvetype="functiongraph",new JXG.Curve(e,r,n)},JXG.JSXGraph.registerElement("functiongraph",JXG.createFunctiongraph),JXG.JSXGraph.registerElement("plot",JXG.createFunctiongraph),JXG.createSpline=function(e,t,i){var n;return n=function(){var e,i=[],n=[],r=function(r,o){var a;if(!o){if(i=[],n=[],2==t.length&&JXG.isArray(t[0])&&JXG.isArray(t[1])&&t[0].length==t[1].length)for(a=0;t[0].length>a;a++)"function"==typeof t[0][a]?i.push(t[0][a]()):i.push(t[0][a]),"function"==typeof t[1][a]?n.push(t[1][a]()):n.push(t[1][a]);else for(a=0;t.length>a;a++)if(JXG.isPoint(t[a]))i.push(t[a].X()),n.push(t[a].Y());else if(JXG.isArray(t[a])&&2==t[a].length)for(a=0;t.length>a;a++)"function"==typeof t[a][0]?i.push(t[a][0]()):i.push(t[a][0]),"function"==typeof t[a][1]?n.push(t[a][1]()):n.push(t[a][1]);e=JXG.Math.Numerics.splineDef(i,n)}return JXG.Math.Numerics.splineEval(r,i,n,e)};return r},e.create("curve",["x",n()],i)},JXG.JSXGraph.registerElement("spline",JXG.createSpline),JXG.createRiemannsum=function(e,t,i){var n,r,o,a,s,l;if(l=JXG.copyAttributes(i,e.options,"riemannsum"),l.curvetype="plot",o=t[0],n=JXG.createFunction(t[1],e,""),null==n)throw Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");if(r=JXG.createFunction(t[2],e,"",!1),null==r)throw Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.\nPossible parent types: [function,n:number|function,type,start:number|function,end:number|function]");return a=[[0],[0]].concat(t.slice(3)),s=e.create("curve",a,l),s.sum=0,s.Value=function(){return this.sum},s.updateDataArray=function(){var e=JXG.Math.Numerics.riemann(o,n(),r(),this.minX(),this.maxX());this.dataX=e[0],this.dataY=e[1],this.sum=e[2]},s},JXG.JSXGraph.registerElement("riemannsum",JXG.createRiemannsum),JXG.createTracecurve=function(e,t,i){var n,r,o,a;if(2!=t.length)throw Error("JSXGraph: Can't create trace curve with given parent'\nPossible parent types: [glider, point]");if(r=JXG.getRef(this.board,t[0]),o=JXG.getRef(this.board,t[1]),r.type!=JXG.OBJECT_TYPE_GLIDER||!JXG.isPoint(o))throw Error("JSXGraph: Can't create trace curve with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [glider, point]");return a=JXG.copyAttributes(i,e.options,"tracecurve"),a.curvetype="plot",n=e.create("curve",[[0],[0]],a),n.updateDataArray=function(){var e,t,i,n,s,l,c,u,d,h=a.numberpoints,p=r.position,f=r.slideObject,g=f.minX(),m=f.maxX();for(t=(m-g)/h,this.dataX=[],this.dataY=[],f.elementClass!=JXG.OBJECT_CLASS_CURVE&&h++,e=0;h>e;e++){i=g+e*t,l=f.X(i)/f.Z(i),c=f.Y(i)/f.Z(i),r.setPositionDirectly(JXG.COORDS_BY_USER,[l,c]),u=!1;for(n in this.board.objects)if(s=this.board.objects[n],s==r&&(u=!0),u&&s.needsRegularUpdate&&(d=s.visProp.trace,s.visProp.trace=!1,s.needsUpdate=!0,s.update(!0),s.visProp.trace=d,s==o))break;this.dataX[e]=o.X(),this.dataY[e]=o.Y()}r.position=p,u=!1;for(n in this.board.objects)if(s=this.board.objects[n],s==r&&(u=!0),u&&s.needsRegularUpdate&&(d=s.visProp.trace,s.visProp.trace=!1,s.needsUpdate=!0,s.update(!0),s.visProp.trace=d,s==o))break},n},JXG.JSXGraph.registerElement("tracecurve",JXG.createTracecurve),JXG.createArc=function(e,t,i){var n,r,o;if(!(t=JXG.checkParents("arc",t,[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]])))throw Error("JSXGraph: Can't create Arc with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]");for(r=JXG.copyAttributes(i,e.options,"arc"),n=e.create("curve",[[0],[0]],r),n.elType="arc",n.parents=[],o=0;t.length>o;o++)t[o].id&&n.parents.push(t[o].id);return n.type=JXG.OBJECT_TYPE_ARC,n.center=JXG.getReference(e,t[0]),n.radiuspoint=JXG.getReference(e,t[1]),n.point2=n.radiuspoint,n.anglepoint=JXG.getReference(e,t[2]),n.point3=n.anglepoint,n.center.addChild(n),n.radiuspoint.addChild(n),n.anglepoint.addChild(n),n.useDirection=r.usedirection,n.updateDataArray=function(){var e,i,n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w=this.radiuspoint,k=this.center,_=this.anglepoint,E=k.X(),T=k.Y(),S=k.Z(),A=1,P=.5*Math.PI;for(o=JXG.Math.Geometry.rad(w,k,_),("minor"==this.visProp.type&&o>Math.PI||"major"==this.visProp.type&&Math.PI>o)&&(o=2*Math.PI-o,A=-1),this.useDirection&&(l=t[1].coords.usrCoords,c=t[3].coords.usrCoords,u=t[2].coords.usrCoords,s=(l[1]-u[1])*(l[2]-c[2])-(l[2]-u[2])*(l[1]-c[1]),0>s?(this.radiuspoint=t[1],this.anglepoint=t[2]):(this.radiuspoint=t[2],this.anglepoint=t[1])),d=[w.Z(),w.X(),w.Y()],f=d.slice(0),C=k.Dist(w),E/=S,T/=S,this.dataX=[d[1]/d[0]],this.dataY=[d[2]/d[0]];o>JXG.Math.eps;)o>=P?(e=P,o-=P):(e=o,o=0),i=Math.cos(A*e),n=Math.sin(A*e),r=[[1,0,0],[E*(1-i)+T*n,i,-n],[T*(1-i)-E*n,n,i]],a=JXG.Math.matVecMult(r,d),f=[a[0]/a[0],a[1]/a[0],a[2]/a[0]],m=d[1]-E,b=d[2]-T,v=f[1]-E,y=f[2]-T,x=Math.sqrt((m+v)*(m+v)+(b+y)*(b+y)),g=Math.abs(y-b)>JXG.Math.eps?8*((m+v)*(C/x-.5)/(y-b))/3:8*((b+y)*(C/x-.5)/(m-v))/3,h=[1,d[1]-g*b,d[2]+g*m],p=[1,f[1]+g*y,f[2]-g*v],this.dataX=this.dataX.concat([h[1],p[1],f[1]]),this.dataY=this.dataY.concat([h[2],p[2],f[2]]),d=f.slice(0);this.bezierDegree=3,this.updateStdform(),this.updateQuadraticform()},n.Radius=function(){return this.radiuspoint.Dist(this.center)},n.getRadius=function(){return this.Radius()},n.hasPoint=function(e,t){var i,n,r,o,a,s,l,c,u=this.board.options.precision.hasPoint/this.board.unitX,d=this.Radius();return n=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),this.transformations.length>0&&(this.updateTransformMatrix(),l=JXG.Math.inverse(this.transformMat),c=JXG.Math.matVecMult(l,n.usrCoords),n=new JXG.Coords(JXG.COORDS_BY_USER,c,this.board)),i=this.center.coords.distance(JXG.COORDS_BY_USER,n),r=u>Math.abs(i-d),r&&(o=JXG.Math.Geometry.rad(this.radiuspoint,this.center,n.usrCoords.slice(1)),a=0,s=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&s>Math.PI||"major"==this.visProp.type&&Math.PI>s)&&(a=s,s=2*Math.PI),(a>o||o>s)&&(r=!1)),r},n.hasPointSector=function(e,t){var i,n,r,o=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),a=this.Radius(),s=this.center.coords.distance(JXG.COORDS_BY_USER,o),l=a>s;return l&&(i=JXG.Math.Geometry.rad(this.radiuspoint,this.center,o.usrCoords.slice(1)),n=0,r=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&r>Math.PI||"major"==this.visProp.type&&Math.PI>r)&&(n=r,r=2*Math.PI),(n>i||i>r)&&(l=!1)),l},n.getTextAnchor=function(){return this.center.coords},n.getLabelAnchor=function(){var e,t,i,n,r,o=10/this.board.unitX,a=10/this.board.unitY,s=this.point2.coords.usrCoords,l=this.center.coords.usrCoords,c=s[1]-l[1],u=s[2]-l[2];return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),e=JXG.Math.Geometry.rad(this.radiuspoint,this.center,this.anglepoint),("minor"==this.visProp.type&&e>Math.PI||"major"==this.visProp.type&&Math.PI>e)&&(e=-(2*Math.PI-e)),t=new JXG.Coords(JXG.COORDS_BY_USER,[l[1]+Math.cos(.5*e)*c-Math.sin(.5*e)*u,l[2]+Math.sin(.5*e)*c+Math.cos(.5*e)*u],this.board),i=t.usrCoords[1]-l[1],n=t.usrCoords[2]-l[2],r=Math.sqrt(i*i+n*n),i=i*(r+o)/r,n=n*(r+a)/r,new JXG.Coords(JXG.COORDS_BY_USER,[l[1]+i,l[2]+n],this.board)},n.updateQuadraticform=function(){var e=this.center,t=e.X(),i=e.Y(),n=this.Radius();this.quadraticform=[[t*t+i*i-n*n,-t,-i],[-t,1,0],[-i,0,1]]},n.updateStdform=function(){this.stdform[3]=.5,this.stdform[4]=this.Radius(),this.stdform[1]=-this.center.coords.usrCoords[1],this.stdform[2]=-this.center.coords.usrCoords[2],this.normalize()},n.prepareUpdate().update(),n},JXG.JSXGraph.registerElement("arc",JXG.createArc),JXG.createSemicircle=function(e,t,i){var n,r,o;if(!JXG.isPoint(t[0])||!JXG.isPoint(t[1]))throw Error("JSXGraph: Can't create Semicircle with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point]");return o=JXG.copyAttributes(i,e.options,"semicircle","midpoint"),r=e.create("midpoint",[t[0],t[1]],o),r.dump=!1,o=JXG.copyAttributes(i,e.options,"semicircle"),n=e.create("arc",[r,t[1],t[0]],o),n.elType="semicircle",n.parents=[t[0].id,t[1].id],n.subs={midpoint:r},n.midpoint=n.center=r,n},JXG.JSXGraph.registerElement("semicircle",JXG.createSemicircle),JXG.createCircumcircleArc=function(e,t,i){var n,r,o;if(!(JXG.isPoint(t[0])&&JXG.isPoint(t[1])&&JXG.isPoint(t[2])))throw Error("JSXGraph: create Circumcircle Arc with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]");return o=JXG.copyAttributes(i,e.options,"circumcirclearc","center"),r=e.create("circumcenter",[t[0],t[1],t[2]],o),r.dump=!1,o=JXG.copyAttributes(i,e.options,"circumcirclearc"),o.usedirection=!0,n=e.create("arc",[r,t[0],t[2],t[1]],o),n.elType="circumcirclearc",n.parents=[t[0].id,t[1].id,t[2].id],n.subs={center:r},n.center=r,n},JXG.JSXGraph.registerElement("circumcirclearc",JXG.createCircumcircleArc),JXG.createMinorArc=function(e,t,i){return i.type="minor",JXG.createArc(e,t,i)},JXG.JSXGraph.registerElement("minorarc",JXG.createMinorArc),JXG.createMajorArc=function(e,t,i){return i.type="major",JXG.createArc(e,t,i)},JXG.JSXGraph.registerElement("majorarc",JXG.createMajorArc),JXG.createSector=function(e,t,i){var n,r;if(!(JXG.isPoint(t[0])&&JXG.isPoint(t[1])&&JXG.isPoint(t[2])))throw Error("JSXGraph: Can't create Sector with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'.");return r=JXG.copyAttributes(i,e.options,"sector"),n=e.create("curve",[[0],[0]],r),n.type=JXG.OBJECT_TYPE_SECTOR,n.elType="sector",n.parents=[t[0].id,t[1].id,t[2].id],n.point1=JXG.getReference(e,t[0]),n.center=n.point1,n.point2=JXG.getReference(e,t[1]),n.radiuspoint=n.point2,n.point3=JXG.getReference(e,t[2]),n.anglepoint=n.point3,n.point1.addChild(n),n.point2.addChild(n),n.point3.addChild(n),n.useDirection=i.usedirection,n.updateDataArray=function(){var e,i,n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C=this.point2,w=this.point1,k=this.point3,_=JXG.Math.Geometry.rad(C,w,k),E=w.X(),T=w.Y(),S=w.Z(),A=.5*Math.PI;for(this.useDirection&&(s=t[1].coords.usrCoords,l=t[3].coords.usrCoords,c=t[2].coords.usrCoords,a=(s[1]-c[1])*(s[2]-l[2])-(s[2]-c[2])*(s[1]-l[1]),0>a?(this.point2=t[1],this.point3=t[2]):(this.point2=t[2],this.point3=t[1])),x=w.Dist(C),u=[C.Z(),C.X(),C.Y()],u[1]/=u[0],u[2]/=u[0],u[0]/=u[0],p=u.slice(0),E/=S,T/=S,this.dataX=[E,E+.333*(u[1]-E),E+.666*(u[1]-E),u[1]],this.dataY=[T,T+.333*(u[2]-T),T+.666*(u[2]-T),u[2]];_>JXG.Math.eps;)_>=A?(e=A,_-=A):(e=_,_=0),i=Math.cos(e),n=Math.sin(e),r=[[1,0,0],[E*(1-i)+T*n,i,-n],[T*(1-i)-E*n,n,i]],o=JXG.Math.matVecMult(r,u),p=[o[0]/o[0],o[1]/o[0],o[2]/o[0]],g=u[1]-E,m=u[2]-T,b=p[1]-E,v=p[2]-T,y=Math.sqrt((g+b)*(g+b)+(m+v)*(m+v)),f=Math.abs(v-m)>JXG.Math.eps?8*((g+b)*(x/y-.5)/(v-m))/3:8*((m+v)*(x/y-.5)/(g-b))/3,d=[1,u[1]-f*m,u[2]+f*g],h=[1,p[1]+f*v,p[2]-f*b],this.dataX=this.dataX.concat([d[1],h[1],p[1]]),this.dataY=this.dataY.concat([d[2],h[2],p[2]]),u=p.slice(0);this.dataX=this.dataX.concat([p[1]+.333*(E-p[1]),p[1]+.666*(E-p[1]),E]),this.dataY=this.dataY.concat([p[2]+.333*(T-p[2]),p[2]+.666*(T-p[2]),T]),this.bezierDegree=3},n.Radius=function(){return this.point2.Dist(this.point1)},n.getRadius=function(){return this.Radius()},n.hasPoint=function(e,t){var i,n,r,o=this.board.options.precision.hasPoint/this.board.unitX,a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),s=this.Radius(),l=this.center.coords.distance(JXG.COORDS_BY_USER,a),c=o>Math.abs(l-s);return c&&(i=JXG.Math.Geometry.rad(this.point2,this.center,a.usrCoords.slice(1)),n=0,r=JXG.Math.Geometry.rad(this.point2,this.center,this.point3),(n>i||i>r)&&(c=!1)),c},n.hasPointSector=function(e,t){var i,n=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),r=this.Radius(),o=this.point1.coords.distance(JXG.COORDS_BY_USER,n),a=r>o;return a&&(i=JXG.Math.Geometry.rad(this.point2,this.point1,n.usrCoords.slice(1)),i>JXG.Math.Geometry.rad(this.point2,this.point1,this.point3)&&(a=!1)),a},n.getTextAnchor=function(){return this.point1.coords},n.getLabelAnchor=function(){var e,t,i,n,r=JXG.Math.Geometry.rad(this.point2,this.point1,this.point3),o=13/this.board.unitX,a=13/this.board.unitY,s=this.point2.coords.usrCoords,l=this.point1.coords.usrCoords,c=s[1]-l[1],u=s[2]-l[2];return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),e=new JXG.Coords(JXG.COORDS_BY_USER,[l[1]+Math.cos(.5*r)*c-Math.sin(.5*r)*u,l[2]+Math.sin(.5*r)*c+Math.cos(.5*r)*u],this.board),t=e.usrCoords[1]-l[1],i=e.usrCoords[2]-l[2],n=Math.sqrt(t*t+i*i),t=t*(n+o)/n,i=i*(n+a)/n,new JXG.Coords(JXG.COORDS_BY_USER,[l[1]+t,l[2]+i],this.board)},n.prepareUpdate().update(),n},JXG.JSXGraph.registerElement("sector",JXG.createSector),JXG.createCircumcircleSector=function(e,t,i){var n,r,o;if(!(JXG.isPoint(t[0])&&JXG.isPoint(t[1])&&JXG.isPoint(t[2])))throw Error("JSXGraph: Can't create circumcircle sector with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'.");return o=JXG.copyAttributes(i,e.options,"circumcirclesector","center"),r=e.create("circumcenter",[t[0],t[1],t[2]],o),r.dump=!1,o=JXG.copyAttributes(i,e.options,"circumcirclesector"),n=e.create("sector",[r,t[0],t[2],t[1]],o),n.elType="circumcirclesector",n.parents=[t[0].id,t[1].id,t[2].id],n.center=r,n.subs={center:r},n},JXG.JSXGraph.registerElement("circumcirclesector",JXG.createCircumcircleSector),JXG.createAngle=function(e,t,i){var n,r,o,a,s,l,c,u;if(!(JXG.isPoint(t[0])&&JXG.isPoint(t[1])&&JXG.isPoint(t[2])))throw Error("JSXGraph: Can't create angle with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"' and '"+typeof t[2]+"'.");for(s=JXG.copyAttributes(i,e.options,"angle"),a=s.name,(a===void 0||""==a)&&(a=e.generateName({type:JXG.OBJECT_TYPE_ANGLE}),s.name=a),l=JXG.copyAttributes(i,e.options,"angle","radiuspoint"),r=e.create("point",[0,1,0],l),r.dump=!1,l=JXG.copyAttributes(i,e.options,"angle","pointsquare"),o=e.create("point",[0,1,1],l),o.dump=!1,n=e.create("sector",[t[1],r,t[2]],s),n.elType="angle",n.parents=[t[0].id,t[1].id,t[2].id],n.subs={point:r,pointsquare:o},n.updateDataArraySquare=function(){var e,i,n,a,s=t[1];e=JXG.Math.crossProduct(o.coords.usrCoords,s.coords.usrCoords),i=[-r.X()*e[1]-r.Y()*e[2],r.Z()*e[1],r.Z()*e[2]],e=JXG.Math.crossProduct(r.coords.usrCoords,s.coords.usrCoords),n=[-o.X()*e[1]-o.Y()*e[2],o.Z()*e[1],o.Z()*e[2]],a=JXG.Math.crossProduct(i,n),a[1]/=a[0],a[2]/=a[0],this.dataX=[s.X(),r.X(),a[1],o.X(),s.X()],this.dataY=[s.Y(),r.Y(),a[2],o.Y(),s.Y()],this.bezierDegree=1},n.updateDataArrayNone=function(){this.dataX=[0/0],this.dataY=[0/0],this.bezierDegree=1},n.updateDataArraySector=n.updateDataArray,n.updateDataArray=function(){var e=this.visProp.type,i=JXG.Math.Geometry.trueAngle(t[0],t[1],t[2]);Math.abs(i-90)<this.visProp.orthosensitivity&&(e=this.visProp.orthotype),"none"==e?this.updateDataArrayNone():"square"===e?this.updateDataArraySquare():"sector"===e?this.updateDataArraySector():"sectordot"===e&&(this.updateDataArraySector(),this.dot.visProp.visible===!1&&this.dot.setProperty({visible:!0})),"sectordot"!==e&&this.dot.visProp.visible===!0&&this.dot.setProperty({visible:!1})},r.addConstraint([function(){var e=t[0],i=t[1],r=JXG.evaluate(n.visProp.radius),o=i.Dist(e);return[i.X()+(e.X()-i.X())*r/o,i.Y()+(e.Y()-i.Y())*r/o]}]),o.addConstraint([function(){var e=t[2],i=t[1],r=JXG.evaluate(n.visProp.radius),o=i.Dist(e);return[i.X()+(e.X()-i.X())*r/o,i.Y()+(e.Y()-i.Y())*r/o]}]),n.radiuspoint=r,n.point=r,n.pointsquare=o,u=JXG.copyAttributes(i,e.options,"angle","dot"),n.dot=e.create("point",[function(){if(JXG.exists(n.dot)&&n.dot.visProp.visible===!1)return[0,0];var e=r.coords.usrCoords,i=.5*JXG.Math.Geometry.rad(t[0],t[1],t[2]),o=t[1].X(),a=t[1].Y(),s=[[1,0,0],[o-.5*o*Math.cos(i)+.5*a*Math.sin(i),.5*Math.cos(i),.5*-Math.sin(i)],[a-.5*o*Math.sin(i)-.5*a*Math.cos(i),.5*Math.sin(i),.5*Math.cos(i)]];return JXG.Math.matVecMult(s,e)}],u),n.dot.dump=!1,n.subs.dot=n.dot,c=0;3>c;c++)JXG.getRef(e,t[c]).addChild(r),JXG.getRef(e,t[c]).addChild(n.dot);return n.type=JXG.OBJECT_TYPE_ANGLE,JXG.getRef(e,t[0]).addChild(n),n.rot=e.create("transform",[function(){return.5*JXG.Math.Geometry.rad(n.point2,n.point1,n.point3)},n.point1],{type:"rotate"}),n.getLabelAnchor=function(){var e,t,i,n,r=12,o=12,a=this.point1.coords.usrCoords;return null!=this.label.content&&(this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board)),JXG.exists(this.visProp.label.fontSize)&&(r=this.visProp.label.fontSize,o=this.visProp.label.fontSize),r/=this.board.unitX,o/=this.board.unitY,this.rot.update(),n=JXG.Math.matVecMult(this.rot.matrix,this.point2.coords.usrCoords),e=n[1]-a[1],t=n[2]-a[2],i=Math.sqrt(e*e+t*t),e=e*(i+r)/i,t=t*(i+o)/i,new JXG.Coords(JXG.COORDS_BY_USER,[a[1]+e,a[2]+t],this.board)},n.Value=function(){return JXG.Math.Geometry.rad(this.point2,this.point1,this.point3)},n.methodMap=JXG.deepCopy(n.methodMap,{Value:"Value"}),n.setAngle=function(e){var t,i,n;return t=this.anglepoint,i=this.radiuspoint,t.draggable()&&(n=this.board.create("transform",[e,this.center],{type:"rotate"}),t.addTransform(i,n),t.isDraggable=!1,t.parents=[i]),this},n.free=function(){var e=this.anglepoint;return e.transformations.length>0&&(e.transformations.pop(),e.isDraggable=!0,e.parents=[]),this},n},JXG.JSXGraph.registerElement("angle",JXG.createAngle),JXG.Composition=function(e){var t,i=["setProperty","prepareUpdate","updateRenderer","update","highlight","noHighlight"],n=function(e){return function(){var t;for(t in r.elements)JXG.exists(r.elements[t][e])&&r.elements[t][e].apply(r.elements[t],arguments);return r}},r=this;for(t=0;i.length>t;t++)this[i[t]]=n(i[t]);this.elements={};for(t in e)e.hasOwnProperty(t)&&this.add(t,e[t]);this.dump=!0,this.subs={}},JXG.extend(JXG.Composition.prototype,{add:function(e,t){return!JXG.exists(this[e])&&JXG.exists(t)?(JXG.exists(t.id)?this.elements[t.id]=t:this.elements[e]=t,this[e]=t,!0):!1},remove:function(e){var t,i=!1;for(t in this.elements)if(this.elements[t].id===this[e].id){i=!0;break}return i&&(delete this.elements[this[e].id],delete this[e]),i},getParents:function(){return this.parents},getType:function(){return this.elType},getAttributes:function(){var e,t={};for(e in this.subs)t[e]=this.subs[e].visProp;return this.attr}}),JXG.createOrthogonalProjection=function(e,t,i){var n,r,o;if(JXG.isPoint(t[0])&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)r=t[0],n=t[1];else{if(!JXG.isPoint(t[1])||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line]");r=t[1],n=t[0]}return attr=JXG.copyAttributes(i,e.options,"orthogonalprojection"),o=e.create("point",[function(){return JXG.Math.Geometry.projectPointToLine(r,n,e)}],i),r.addChild(o),n.addChild(o),o.elType="orthogonalprojection",o.parents=[r.id,o.id],o.update(),o.generatePolynomial=function(){var e=n.point1.symbolic.x,t=n.point1.symbolic.y,i=n.point2.symbolic.x,a=n.point2.symbolic.y,s=r.symbolic.x,l=r.symbolic.y,c=o.symbolic.x,u=o.symbolic.y,d="("+t+")*("+c+")-("+t+")*("+i+")+("+u+")*("+i+")-("+e+")*("+u+")+("+e+")*("+a+")-("+c+")*("+a+")",h="("+l+")*("+t+")-("+l+")*("+a+")-("+u+")*("+t+")+("+u+")*("+a+")+("+s+")*("+e+")-("+s+")*("+i+")-("+c+")*("+e+")+("+c+")*("+i+")";return[d,h]},o},JXG.createPerpendicular=function(e,t,i){var n,r,o,a;if(t[0]=JXG.getReference(e,t[0]),t[1]=JXG.getReference(e,t[1]),JXG.isPoint(t[0])&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)r=t[1],n=t[0];else{if(!JXG.isPoint(t[1])||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create perpendicular with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [line,point]");r=t[0],n=t[1]}return a=JXG.copyAttributes(i,e.options,"perpendicular"),o=JXG.createLine(e,[function(){return r.stdform[2]*n.X()-r.stdform[1]*n.Y()},function(){return-r.stdform[2]*n.Z()},function(){return r.stdform[1]*n.Z()}],a),o.elType="perpendicular",o.parents=[r.id,n.id],o},JXG.createPerpendicularPoint=function(e,t,i){var n,r,o;if(JXG.isPoint(t[0])&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)r=t[0],n=t[1];else{if(!JXG.isPoint(t[1])||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create perpendicular point with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line]");r=t[1],n=t[0]}return o=e.create("point",[function(){return JXG.Math.Geometry.perpendicular(n,r,e)[0]}],i),r.addChild(o),n.addChild(o),o.elType="perpendicularpoint",o.parents=[r.id,n.id],o.update(),o.generatePolynomial=function(){var e=n.point1.symbolic.x,t=n.point1.symbolic.y,i=n.point2.symbolic.x,a=n.point2.symbolic.y,s=r.symbolic.x,l=r.symbolic.y,c=o.symbolic.x,u=o.symbolic.y,d="("+t+")*("+c+")-("+t+")*("+i+")+("+u+")*("+i+")-("+e+")*("+u+")+("+e+")*("+a+")-("+c+")*("+a+")",h="("+l+")*("+t+")-("+l+")*("+a+")-("+u+")*("+t+")+("+u+")*("+a+")+("+s+")*("+e+")-("+s+")*("+i+")-("+c+")*("+e+")+("+c+")*("+i+")";return[d,h]},o},JXG.createPerpendicularSegment=function(e,t,i){var n,r,o,a,s;if(t[0]=JXG.getReference(e,t[0]),t[1]=JXG.getReference(e,t[1]),JXG.isPoint(t[0])&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)r=t[1],n=t[0];else{if(!JXG.isPoint(t[1])||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create perpendicular with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [line,point]");r=t[0],n=t[1]}return s=JXG.copyAttributes(i,e.options,"perpendicularsegment","point"),a=JXG.createPerpendicularPoint(e,[r,n],s),a.dump=!1,JXG.exists(i.layer)||(i.layer=e.options.layer.line),s=JXG.copyAttributes(i,e.options,"perpendicularsegment"),o=JXG.createLine(e,[function(){return JXG.Math.Geometry.perpendicular(r,n,e)[1]?[a,n]:[n,a]}],s),o.point=a,o.elType="perpendicularsegment",o.parents=[n.id,r.id],o.subs={point:a},o},JXG.createMidpoint=function(e,t,i){var n,r,o;if(2==t.length&&JXG.isPoint(t[0])&&JXG.isPoint(t[1]))n=t[0],r=t[1];else{if(1!=t.length||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create midpoint.\nPossible parent types: [point,point], [line]");n=t[0].point1,r=t[0].point2}return o=e.create("point",[function(){var e=n.coords.usrCoords[1]+r.coords.usrCoords[1];return isNaN(e)||Math.abs(n.coords.usrCoords[0])<JXG.Math.eps||Math.abs(r.coords.usrCoords[0])<JXG.Math.eps?0/0:.5*e},function(){var e=n.coords.usrCoords[2]+r.coords.usrCoords[2];return isNaN(e)||Math.abs(n.coords.usrCoords[0])<JXG.Math.eps||Math.abs(r.coords.usrCoords[0])<JXG.Math.eps?0/0:.5*e}],i),n.addChild(o),r.addChild(o),o.elType="midpoint",o.parents=[n.id,r.id],o.prepareUpdate().update(),o.generatePolynomial=function(){var e=n.symbolic.x,t=n.symbolic.y,i=r.symbolic.x,a=r.symbolic.y,s=o.symbolic.x,l=o.symbolic.y,c="("+t+")*("+s+")-("+t+")*("+i+")+("+l+")*("+i+")-("+e+")*("+l+")+("+e+")*("+a+")-("+s+")*("+a+")",u="("+e+")^2 - 2*("+e+")*("+s+")+("+t+")^2-2*("+t+")*("+l+")-("+i+")^2+2*("+i+")*("+s+")-("+a+")^2+2*("+a+")*("+l+")";return[c,u]},o},JXG.createParallelPoint=function(e,t,i){var n,r,o,a;if(3==t.length&&t[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[1].elementClass==JXG.OBJECT_CLASS_POINT&&t[2].elementClass==JXG.OBJECT_CLASS_POINT)n=t[0],r=t[1],o=t[2];else if(t[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)o=t[0],n=t[1].point1,r=t[1].point2;else{if(t[1].elementClass!=JXG.OBJECT_CLASS_POINT||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create parallel point with parent types '"+typeof t[0]+"', '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [line,point], [point,point,point]");o=t[1],n=t[0].point1,r=t[0].point2}return a=e.create("point",[function(){return o.coords.usrCoords[1]+r.coords.usrCoords[1]-n.coords.usrCoords[1]},function(){return o.coords.usrCoords[2]+r.coords.usrCoords[2]-n.coords.usrCoords[2]}],i),n.addChild(a),r.addChild(a),o.addChild(a),a.elType="parallelpoint",a.parents=[n.id,r.id,o.id],a.prepareUpdate().update(),a.generatePolynomial=function(){var e=n.symbolic.x,t=n.symbolic.y,i=r.symbolic.x,s=r.symbolic.y,l=o.symbolic.x,c=o.symbolic.y,u=a.symbolic.x,d=a.symbolic.y,h="("+s+")*("+u+")-("+s+")*("+l+")-("+t+")*("+u+")+("+t+")*("+l+")-("+d+")*("+i+")+("+d+")*("+e+")+("+c+")*("+i+")-("+c+")*("+e+")",p="("+d+")*("+e+")-("+d+")*("+l+")-("+s+")*("+e+")+("+s+")*("+l+")-("+u+")*("+t+")+("+u+")*("+c+")+("+i+")*("+t+")-("+i+")*("+c+")";
return[h,p]},a},JXG.createParallel=function(e,t,i){var n,r,o,a,s;return n=null,3==t.length?(n=t[2],a=function(){return JXG.Math.crossProduct(t[0].coords.usrCoords,t[1].coords.usrCoords)}):t[0].elementClass==JXG.OBJECT_CLASS_POINT?(n=t[0],a=function(){return t[1].stdform}):t[1].elementClass==JXG.OBJECT_CLASS_POINT&&(n=t[1],a=function(){return t[0].stdform}),JXG.exists(i.layer)||(i.layer=e.options.layer.line),s=JXG.copyAttributes(i,e.options,"parallel","point"),r=e.create("point",[function(){return JXG.Math.crossProduct([1,0,0],a())}],s),r.isDraggable=!0,s=JXG.copyAttributes(i,e.options,"parallel"),o=e.create("line",[n,r],s),o.elType="parallel",o.parents=[t[0].id,t[1].id],3===t.length&&o.parents.push(t[2].id),o.point=r,o},JXG.createArrowParallel=function(e,t,i){var n;try{return i.firstArrow=!1,i.lastArrow=!0,n=JXG.createParallel(e,t,i).setStraight(!1,!1),n.elType="arrowparallel",n}catch(r){throw Error("JSXGraph: Can't create arrowparallel with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [line,point], [point,point,point]")}},JXG.createNormal=function(e,t,i){var n,r,o,a,s,l,c;if(1==t.length)n=t[0],r=n.slideObject;else{if(2!=t.length)throw Error("JSXGraph: Can't create normal with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line], [point,circle], [glider]");if(JXG.isPoint(t[0]))n=t[0],r=t[1];else{if(!JXG.isPoint(t[1]))throw Error("JSXGraph: Can't create normal with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line], [point,circle], [glider]");r=t[0],n=t[1]}}if(s=JXG.copyAttributes(i,e.options,"normal"),r.elementClass==JXG.OBJECT_CLASS_LINE)c=JXG.copyAttributes(i,e.options,"normal","point"),l=e.create("point",[function(){var e=JXG.Math.crossProduct([1,0,0],r.stdform);return[e[0],-e[2],e[1]]}],c),l.isDraggable=!0,o=e.create("line",[n,l],s),o.point=l;else if(r.elementClass==JXG.OBJECT_CLASS_CIRCLE)o=e.create("line",[r.midpoint,n],s);else if(r.elementClass==JXG.OBJECT_CLASS_CURVE)if("plot"!=r.visProp.curvetype){var u=r.X,d=r.Y;o=e.create("line",[function(){return-n.X()*e.D(u)(n.position)-n.Y()*e.D(d)(n.position)},function(){return e.D(u)(n.position)},function(){return e.D(d)(n.position)}],s)}else o=e.create("line",[function(){var e=Math.floor(n.position),t=n.position-e;return e==r.numberPoints-1&&(e--,t=1),0>e?1:(r.Y(e)+t*(r.Y(e+1)-r.Y(e)))*(r.Y(e)-r.Y(e+1))-(r.X(e)+t*(r.X(e+1)-r.X(e)))*(r.X(e+1)-r.X(e))},function(){var e=Math.floor(n.position);return e==r.numberPoints-1&&e--,0>e?0:r.X(e+1)-r.X(e)},function(){var e=Math.floor(n.position);return e==r.numberPoints-1&&e--,0>e?0:r.Y(e+1)-r.Y(e)}],s);else{if(r.type!=JXG.OBJECT_TYPE_TURTLE)throw Error("JSXGraph: Can't create normal with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,line], [point,circle], [glider]");o=e.create("line",[function(){var e,t,i=Math.floor(n.position),o=n.position-i;for(t=0;r.objects.length>t;t++)if(e=r.objects[t],e.type==JXG.OBJECT_TYPE_CURVE){if(e.numberPoints>i)break;i-=e.numberPoints}return i==e.numberPoints-1&&(i--,o=1),0>i?1:(e.Y(i)+o*(e.Y(i+1)-e.Y(i)))*(e.Y(i)-e.Y(i+1))-(e.X(i)+o*(e.X(i+1)-e.X(i)))*(e.X(i+1)-e.X(i))},function(){var e,t,i=Math.floor(n.position);for(t=0;r.objects.length>t;t++)if(e=r.objects[t],e.type==JXG.OBJECT_TYPE_CURVE){if(e.numberPoints>i)break;i-=e.numberPoints}return i==e.numberPoints-1&&i--,0>i?0:e.X(i+1)-e.X(i)},function(){var e,t,i=Math.floor(n.position);for(t=0;r.objects.length>t;t++)if(e=r.objects[t],e.type==JXG.OBJECT_TYPE_CURVE){if(e.numberPoints>i)break;i-=e.numberPoints}return i==e.numberPoints-1&&i--,0>i?0:e.Y(i+1)-e.Y(i)}],s)}for(o.parents=[],a=0;t.length>a;a++)o.parents.push(t[a].id);return o.elType="normal",o},JXG.createBisector=function(e,t,i){var n,r,o,a;if(t[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[1].elementClass==JXG.OBJECT_CLASS_POINT&&t[2].elementClass==JXG.OBJECT_CLASS_POINT){for(a=JXG.copyAttributes(i,e.options,"bisector","point"),n=e.create("point",[function(){return JXG.Math.Geometry.angleBisector(t[0],t[1],t[2],e)}],a),n.dump=!1,o=0;3>o;o++)t[o].addChild(n);return JXG.exists(i.layer)||(i.layer=e.options.layer.line),a=JXG.copyAttributes(i,e.options,"bisector"),r=JXG.createLine(e,[t[1],n],a),r.point=n,r.elType="bisector",r.parents=[t[0].id,t[1].id,t[2].id],r.subs={point:n},r}throw Error("JSXGraph: Can't create angle bisector with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point,point]")},JXG.createAngularBisectorsOfTwoLines=function(e,t,i){var n,r,o,a,s=JXG.getReference(e,t[0]),l=JXG.getReference(e,t[1]);if(s.elementClass!=JXG.OBJECT_CLASS_LINE||l.elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create angle bisectors of two lines with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [line,line]");return JXG.exists(i.layer)||(i.layer=e.options.layer.line),o=JXG.copyAttributes(i,e.options,"bisectorlines","line1"),n=e.create("line",[function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[0]/e-l.stdform[0]/t},function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[1]/e-l.stdform[1]/t},function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[2]/e-l.stdform[2]/t}],o),JXG.exists(i.layer)||(i.layer=e.options.layer.line),o=JXG.copyAttributes(i,e.options,"bisectorlines","line2"),r=e.create("line",[function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[0]/e+l.stdform[0]/t},function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[1]/e+l.stdform[1]/t},function(){var e=Math.sqrt(s.stdform[1]*s.stdform[1]+s.stdform[2]*s.stdform[2]),t=Math.sqrt(l.stdform[1]*l.stdform[1]+l.stdform[2]*l.stdform[2]);return s.stdform[2]/e+l.stdform[2]/t}],o),a=new JXG.Composition({line1:n,line2:r}),n.dump=!1,r.dump=!1,a.elType="bisectorlines",a.parents=[s.id,l.id],a.subs={line1:n,line2:r},a},JXG.createCircumcircleMidpoint=function(e,t,i){var n,r;if(t[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[1].elementClass==JXG.OBJECT_CLASS_POINT&&t[2].elementClass==JXG.OBJECT_CLASS_POINT){for(n=JXG.createPoint(e,[function(){return JXG.Math.Geometry.circumcenterMidpoint(t[0],t[1],t[2],e)}],i),r=0;3>r;r++)t[r].addChild(n);return n.elType="circumcenter",n.parents=[t[0].id,t[1].id,t[2].id],n.generatePolynomial=function(){var e=a.symbolic.x,t=a.symbolic.y,i=b.symbolic.x,r=b.symbolic.y,o=c.symbolic.x,s=c.symbolic.y,l=n.symbolic.x,u=n.symbolic.y,d=["((",l,")-(",e,"))^2+((",u,")-(",t,"))^2-((",l,")-(",i,"))^2-((",u,")-(",r,"))^2"].join(""),h=["((",l,")-(",e,"))^2+((",u,")-(",t,"))^2-((",l,")-(",o,"))^2-((",u,")-(",s,"))^2"].join("");return[d,h]},n}throw Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+typeof t[0]+"', '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]")},JXG.createIncenter=function(e,t,i){var n,r,o,a;if(!(t.length>=3&&JXG.isPoint(t[0])&&JXG.isPoint(t[1])&&JXG.isPoint(t[2])))throw Error("JSXGraph: Can't create incenter with parent types '"+typeof t[0]+"', '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]");return r=t[0],o=t[1],a=t[2],n=e.create("point",[function(){var t,i,n;return t=Math.sqrt((o.X()-a.X())*(o.X()-a.X())+(o.Y()-a.Y())*(o.Y()-a.Y())),i=Math.sqrt((r.X()-a.X())*(r.X()-a.X())+(r.Y()-a.Y())*(r.Y()-a.Y())),n=Math.sqrt((o.X()-r.X())*(o.X()-r.X())+(o.Y()-r.Y())*(o.Y()-r.Y())),new JXG.Coords(JXG.COORDS_BY_USER,[(t*r.X()+i*o.X()+n*a.X())/(t+i+n),(t*r.Y()+i*o.Y()+n*a.Y())/(t+i+n)],e)}],i),n.elType="incenter",n.parents=[t[0].id,t[1].id,t[2].id],n},JXG.createCircumcircle=function(e,t,i){var n,r,o;try{o=JXG.copyAttributes(i,e.options,"circumcircle","center"),n=JXG.createCircumcircleMidpoint(e,t,o),n.dump=!1,JXG.exists(i.layer)||(i.layer=e.options.layer.circle),o=JXG.copyAttributes(i,e.options,"circumcircle"),r=JXG.createCircle(e,[n,t[0]],o),r.elType="circumcircle",r.parents=[t[0].id,t[1].id,t[2].id],r.subs={center:n}}catch(a){throw Error("JSXGraph: Can't create circumcircle with parent types '"+typeof t[0]+"', '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]")}return r},JXG.createIncircle=function(e,t,i){var n,r,o;try{o=JXG.copyAttributes(i,e.options,"incircle","center"),n=JXG.createIncenter(e,t,o),n.dump=!1,JXG.exists(i.layer)||(i.layer=e.options.layer.circle),o=JXG.copyAttributes(i,e.options,"incircle"),r=JXG.createCircle(e,[n,function(){var e=Math.sqrt((t[1].X()-t[2].X())*(t[1].X()-t[2].X())+(t[1].Y()-t[2].Y())*(t[1].Y()-t[2].Y())),i=Math.sqrt((t[0].X()-t[2].X())*(t[0].X()-t[2].X())+(t[0].Y()-t[2].Y())*(t[0].Y()-t[2].Y())),n=Math.sqrt((t[1].X()-t[0].X())*(t[1].X()-t[0].X())+(t[1].Y()-t[0].Y())*(t[1].Y()-t[0].Y())),r=(e+i+n)/2;return Math.sqrt((r-e)*(r-i)*(r-n)/r)}],o),r.elType="incircle",r.parents=[t[0].id,t[1].id,t[2].id],r.center=n,r.subs={center:n}}catch(a){throw Error("JSXGraph: Can't create circumcircle with parent types '"+typeof t[0]+"', '"+typeof t[1]+"' and '"+typeof t[2]+"'."+"\nPossible parent types: [point,point,point]")}return r},JXG.createReflection=function(e,t,i){var n,r,o,a;if(t[0].elementClass==JXG.OBJECT_CLASS_POINT&&t[1].elementClass==JXG.OBJECT_CLASS_LINE)r=t[0],n=t[1];else{if(t[1].elementClass!=JXG.OBJECT_CLASS_POINT||t[0].elementClass!=JXG.OBJECT_CLASS_LINE)throw Error("JSXGraph: Can't create reflection point with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [line,point]");r=t[1],n=t[0]}return a=JXG.createTransform(e,[n],{type:"reflect"}),o=JXG.createPoint(e,[r,a],i),r.addChild(o),n.addChild(o),o.elType="reflection",o.parents=[t[0].id,t[1].id],o.prepareUpdate().update(),o.generatePolynomial=function(){var e=n.point1.symbolic.x,t=n.point1.symbolic.y,i=n.point2.symbolic.x,a=n.point2.symbolic.y,s=r.symbolic.x,l=r.symbolic.y,c=o.symbolic.x,u=o.symbolic.y,d=["((",u,")-(",l,"))*((",t,")-(",a,"))+((",e,")-(",i,"))*((",c,")-(",s,"))"].join(""),h=["((",c,")-(",e,"))^2+((",u,")-(",t,"))^2-((",s,")-(",e,"))^2-((",l,")-(",t,"))^2"].join("");return[d,h]},o},JXG.createMirrorPoint=function(e,t,i){var n,r;if(!JXG.isPoint(t[0])||!JXG.isPoint(t[1]))throw Error("JSXGraph: Can't create mirror point with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [point,point]");for(n=JXG.createPoint(e,[function(){return JXG.Math.Geometry.rotation(t[0],t[1],Math.PI,e)}],i),r=0;2>r;r++)t[r].addChild(n);return n.elType="mirrorpoint",n.parents=[t[0].id,t[1].id],n.prepareUpdate().update(),n},JXG.createIntegral=function(e,t,i){var n,r,o,a,s,l,c,u,d,h,p,f,g,m=0,b=0,v=1;if(JXG.isArray(t[0])&&t[1].elementClass==JXG.OBJECT_CLASS_CURVE)n=t[0],r=t[1];else{if(!JXG.isArray(t[1])||t[0].elementClass!=JXG.OBJECT_CLASS_CURVE)throw Error("JSXGraph: Can't create integral with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'."+"\nPossible parent types: [[number|function,number|function],curve]");n=t[1],r=t[0]}return m=n[0],b=n[1],JXG.isFunction(m)?(a=m,s=function(){return r.Y(a())},m=a()):(a=m,s=r.Y(m)),JXG.isFunction(m)?(l=b,c=function(){return r.Y(l())},b=l()):(l=b,c=r.Y(b)),m>b&&(v=-1),o=JXG.copyAttributes(i,e.options,"integral","curveLeft"),u=e.create("glider",[a,s,r],o),JXG.isFunction(a)&&u.hideElement(),o=JXG.copyAttributes(i,e.options,"integral","baseLeft"),d=e.create("point",[function(){return u.X()},0],o),o=JXG.copyAttributes(i,e.options,"integral","curveRight"),h=e.create("glider",[l,c,r],o),JXG.isFunction(l)&&h.hideElement(),o=JXG.copyAttributes(i,e.options,"integral","baseRight"),p=e.create("point",[function(){return h.X()},0],o),o=JXG.copyAttributes(i,e.options,"integral"),o.withLabel!==!1&&(o=JXG.copyAttributes(i,e.options,"integral","label"),f=e.create("text",[function(){return h.X()+.2},function(){return h.Y()-.8},function(){var e=JXG.Math.Numerics.I([d.X(),p.X()],r.Y);return"&int; = "+e.toFixed(4)}],o),f.dump=!1,u.addChild(f),h.addChild(f)),o=JXG.copyAttributes(i,e.options,"integral"),g=e.create("curve",[[0],[0]],o),u.dump=!1,d.dump=!1,h.dump=!1,p.dump=!1,g.elType="integral",g.parents=[r.id,n],g.subs={curveLeft:u,baseLeft:d,curveRight:h,baseRight:p},o.withLabel&&(g.subs.label=f),g.updateDataArray=function(){var e,t,i,n,o;for(d.X()<p.X()?(n=d.X(),o=p.X()):(n=p.X(),o=d.X()),e=[n,n],t=[0,r.Y(n)],i=0;r.numberPoints>i;i++)r.points[i].usrCoords[1]>=n&&o>=r.points[i].usrCoords[1]&&(e.push(r.points[i].usrCoords[1]),t.push(r.points[i].usrCoords[2]));e.push(o),t.push(r.Y(o)),e.push(o),t.push(0),e.push(n),t.push(0),this.dataX=e,this.dataY=t},u.addChild(g),h.addChild(g),g.baseLeft=d,g.baseRight=p,g.curveLeft=u,g.curveRight=h,g.label={content:f},g},JXG.createLocus=function(e,t,i){var n,r;if(!JXG.isArray(t)||1!=t.length||t[0].elementClass!=JXG.OBJECT_CLASS_POINT)throw Error("JSXGraph: Can't create locus with parent of type other than point.\nPossible parent types: [point]");return r=t[0],n=e.create("curve",[[null],[null]],i),n.dontCallServer=!1,n.elType="locus",n.parents=[r.id],n.updateDataArray=function(){if(!(n.board.mode>0)){var t=JXG.Math.Symbolic.generatePolynomials(e,r,!0).join("|");if(t!==n.spe){n.spe=t;var i=function(e,t,i,r){n.dataX=e,n.dataY=t,n.eq=i,n.ctime=r,n.generatePolynomial=function(e){return function(t){var i,n="("+t.symbolic.x+")",r="("+t.symbolic.y+")",o=[];for(i=0;e.length>i;i++)o[i]=e[i].replace(/\*\*/g,"^").replace(/x/g,n).replace(/y/g,r);return o}}(i)},o=JXG.Math.Symbolic.geometricLocusByGroebnerBase(e,r,i);i(o.datax,o.datay,o.polynomial,o.exectime)}}},n},JXG.createGrid=function(e,t,i){var n,r;return r=JXG.copyAttributes(i,e.options,"grid"),n=e.create("curve",[[null],[null]],r),n.elType="grid",n.parents=[],n.type=JXG.OBJECT_TYPE_GRID,n.updateDataArray=function(){var t,i=this.visProp.gridx,r=this.visProp.gridy,o=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],e),a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e.canvasWidth,e.canvasHeight],e);for(e.options.grid.hasGrid=!0,o.setCoordinates(JXG.COORDS_BY_USER,[Math.floor(o.usrCoords[1]/i)*i,Math.ceil(o.usrCoords[2]/r)*r]),a.setCoordinates(JXG.COORDS_BY_USER,[Math.ceil(a.usrCoords[1]/i)*i,Math.floor(a.usrCoords[2]/r)*r]),n.dataX=[],n.dataY=[],t=o.usrCoords[2];t>a.usrCoords[2]-r;t-=r)n.dataX.push(o.usrCoords[1],a.usrCoords[1],0/0),n.dataY.push(t,t,0/0);for(t=o.usrCoords[1];a.usrCoords[1]+i>t;t+=i)n.dataX.push(t,t,0/0),n.dataY.push(o.usrCoords[2],a.usrCoords[2],0/0)},n.hasPoint=function(){return!1},e.grids.push(n),n},JXG.createInequality=function(e,t,i){var n,r,o;if(o=JXG.copyAttributes(i,e.options,"inequality"),t[0].elementClass===JXG.OBJECT_CLASS_LINE)r=e.create("curve",[[],[]],o),r.hasPoint=function(){return!1},r.updateDataArray=function(){var i,n,r,a=e.getBoundingBox(),s=o.inverse?-1:1,l=1.5,c=l*Math.max(a[2]-a[0],a[1]-a[3]),u={coords:{usrCoords:[1,(a[0]+a[2])/2,o.inverse?a[1]:a[3]]}},d=t[0].stdform.slice(1),h=d;d[1]>0&&(d=JXG.Math.Statistics.multiply(d,-1),h=d),i=l*Math.max(JXG.Math.Geometry.perpendicular(t[0],u,e)[0].distance(JXG.COORDS_BY_USER,u.coords),c),i*=s,u={coords:{usrCoords:[1,(a[0]+a[2])/2,(a[1]+a[3])/2]}},u=JXG.Math.Geometry.perpendicular(t[0],u,e)[0].usrCoords,n=[1,u[1]+d[1]*c,u[2]-d[0]*c],r=[1,u[1]-h[1]*c,u[2]+h[0]*c],this.dataX=[n[1],n[1]+d[0]*i,r[1]+h[0]*i,r[1],n[1]],this.dataY=[n[2],n[2]+d[1]*i,r[2]+h[1]*i,r[2],n[2]]};else if(n=JXG.createFunction(t[0]),!JXG.exists(n))throw Error("JSXGraph: Can't create area with the given parents.\nPossible parent types: [line], [function]");return r},JXG.JSXGraph.registerElement("arrowparallel",JXG.createArrowParallel),JXG.JSXGraph.registerElement("bisector",JXG.createBisector),JXG.JSXGraph.registerElement("bisectorlines",JXG.createAngularBisectorsOfTwoLines),JXG.JSXGraph.registerElement("circumcircle",JXG.createCircumcircle),JXG.JSXGraph.registerElement("circumcirclemidpoint",JXG.createCircumcircleMidpoint),JXG.JSXGraph.registerElement("circumcenter",JXG.createCircumcircleMidpoint),JXG.JSXGraph.registerElement("incenter",JXG.createIncenter),JXG.JSXGraph.registerElement("incircle",JXG.createIncircle),JXG.JSXGraph.registerElement("integral",JXG.createIntegral),JXG.JSXGraph.registerElement("midpoint",JXG.createMidpoint),JXG.JSXGraph.registerElement("mirrorpoint",JXG.createMirrorPoint),JXG.JSXGraph.registerElement("normal",JXG.createNormal),JXG.JSXGraph.registerElement("orthogonalprojection",JXG.createOrthogonalProjection),JXG.JSXGraph.registerElement("parallel",JXG.createParallel),JXG.JSXGraph.registerElement("parallelpoint",JXG.createParallelPoint),JXG.JSXGraph.registerElement("perpendicular",JXG.createPerpendicular),JXG.JSXGraph.registerElement("perpendicularpoint",JXG.createPerpendicularPoint),JXG.JSXGraph.registerElement("perpendicularsegment",JXG.createPerpendicularSegment),JXG.JSXGraph.registerElement("reflection",JXG.createReflection),JXG.JSXGraph.registerElement("locus",JXG.createLocus),JXG.JSXGraph.registerElement("grid",JXG.createGrid),JXG.JSXGraph.registerElement("inequality",JXG.createInequality),JXG.Text=function(e,t,i,n){return this.constructor(e,n,JXG.OBJECT_TYPE_TEXT,JXG.OBJECT_CLASS_OTHER),this.content="",this.plaintext="",this.isDraggable=!1,this.needsSizeUpdate=!1,(this.element=JXG.getRef(this.board,n.anchor))?(this.relativeCoords=this.visProp.islabel?new JXG.Coords(JXG.COORDS_BY_SCREEN,[parseFloat(i[0]),parseFloat(i[1])],this.board):new JXG.Coords(JXG.COORDS_BY_USER,[parseFloat(i[0]),parseFloat(i[1])],this.board),this.element.addChild(this),this.X=function(){var e,t,i;return this.visProp.islabel?(e=parseFloat(this.visProp.offset[0]),i=this.element.getLabelAnchor(),t=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e+this.relativeCoords.scrCoords[1]+i.scrCoords[1],0],this.board),t.usrCoords[1]):(i=this.element.getTextAnchor(),this.relativeCoords.usrCoords[1]+i.usrCoords[1])},this.Y=function(){var e,t,i;return this.visProp.islabel?(e=-parseFloat(this.visProp.offset[1]),i=this.element.getLabelAnchor(),t=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,e+this.relativeCoords.scrCoords[2]+i.scrCoords[2]],this.board),t.usrCoords[2]):(i=this.element.getTextAnchor(),this.relativeCoords.usrCoords[2]+i.usrCoords[2])},this.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board),this.isDraggable=!0):(JXG.isNumber(i[0])&&JXG.isNumber(i[1])&&(this.isDraggable=!0),this.X=JXG.createFunction(i[0],this.board,null,!0),this.Y=JXG.createFunction(i[1],this.board,null,!0),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board)),this.Z=JXG.createFunction(1,this.board,""),this.size=[1,1],this.id=this.board.setId(this,"T"),this.board.renderer.drawText(this),this.setText(t),this.updateSize(),this.visProp.visible||this.board.renderer.hide(this),"string"==typeof this.content&&this.notifyParents(this.content),this.elType="text",this.methodMap=JXG.deepCopy(this.methodMap,{setText:"setTextJessieCode",free:"free",move:"setCoords"}),this},JXG.Text.prototype=new JXG.GeometryElement,JXG.extend(JXG.Text.prototype,{hasPoint:function(e,t){var i,n,r,o,a=this.board.options.precision.hasPoint;return i="right"===this.visProp.anchorx?this.coords.scrCoords[1]-this.size[0]:"middle"===this.visProp.anchorx?this.coords.scrCoords[1]-.5*this.size[0]:this.coords.scrCoords[1],n=i+this.size[0],o="top"===this.visProp.anchory?this.coords.scrCoords[2]+this.size[1]:"middle"===this.visProp.anchorx?this.coords.scrCoords[2]+.5*this.size[1]:this.coords.scrCoords[2],r=o-this.size[1],t>=r-a&&o+a>=t&&(e>=i-a&&i+2*a>=e||e>=n-2*a&&n+a>=e)},_setText:function(e){return this.needsSizeUpdate=!1,"function"==typeof e?(this.updateText=function(){this.plaintext=e()},this.needsSizeUpdate=!0):(JXG.isNumber(e)?this.content=e.toFixed(this.visProp.digits):this.visProp.useasciimathml?(this.content="'`"+e+"`'",this.needsSizeUpdate=!0):this.content=this.generateTerm(e),this.updateText=Function("this.plaintext = "+this.content+"; ")),this.updateText(),this.prepareUpdate().update().updateRenderer(),this},setTextJessieCode:function(e){var t;return this.visProp.castext=e,t="function"==typeof e?function(){return e().replace(/</g,"&lt;").replace(/>/g,"&gt;")}:JXG.isNumber(e)?e:e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),this._setText(t)},setText:function(e){this._setText(e)},updateSize:function(){var e;if("undefined"==typeof document)return this;if("html"==this.visProp.display&&"vml"!==this.board.renderer.type&&"no"!==this.board.renderer.type)this.size=[this.rendNode.offsetWidth,this.rendNode.offsetHeight];else if("internal"===this.visProp.display&&"svg"===this.board.renderer.type)try{e=this.rendNode.getBBox(),this.size=[e.width,e.height]}catch(t){}else("vml"===this.board.renderer.type||"internal"===this.visProp.display&&"canvas"===this.board.renderer.type)&&(this.size=[.45*parseFloat(this.visProp.fontsize)*this.plaintext.length,.9*parseFloat(this.visProp.fontsize)]);return this},getSize:function(){return this.size},setCoords:function(e,t){return JXG.isArray(e)&&e.length>1&&(t=e[1],e=e[0]),this.X=function(){return e},this.Y=function(){return t},this.coords.setCoordinates(JXG.COORDS_BY_USER,[e,t]),this.prepareUpdate().update().updateRenderer(),this},free:function(){this.X=JXG.createFunction(this.X(),this.board,""),this.Y=JXG.createFunction(this.Y(),this.board,""),this.isDraggable=!0},update:function(){return this.needsUpdate&&(this.updateCoords(),this.updateText(),this.needsSizeUpdate&&this.updateSize(),this.updateTransform()),this},updateCoords:function(){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()])},updateRenderer:function(){return this.needsUpdate&&(this.board.renderer.updateText(this),this.needsUpdate=!1),this},updateTransform:function(){var e;if(0!=this.transformations.length){for(e=0;this.transformations.length>e;e++)this.transformations[e].update();return this}},generateTerm:function(e){var t,i,n='""';e=e||"",e=e.replace(/\r/g,""),e=e.replace(/\n/g,""),e=e.replace(/\"/g,'\\"'),e=e.replace(/\'/g,"\\'"),e=e.replace(/&amp;arc;/g,"&ang;"),e=e.replace(/<arc\s*\/>/g,"&ang;"),e=e.replace(/<sqrt\s*\/>/g,"&radic;");var r;r=e.indexOf("<value>");var o=e.indexOf("</value>");if(r>=0)for(this.needsSizeUpdate=!0;r>=0;)n+=' + "'+JXG.GeonextParser.replaceSub(JXG.GeonextParser.replaceSup(e.slice(0,r)))+'"',i=e.slice(r+7,o),t=JXG.GeonextParser.geonext2JS(i,this.board),t=t.replace(/\\"/g,'"'),t=t.replace(/\\'/g,"'"),n+=0>t.indexOf("toFixed")?JXG.isNumber(JXG.bind(Function("return "+t+";"),this)())?"+("+t+").toFixed("+this.visProp.digits+")":"+("+t+")":"+("+t+")",e=e.slice(o+8),r=e.indexOf("<value>"),o=e.indexOf("</value>");return n+=' + "'+JXG.GeonextParser.replaceSub(JXG.GeonextParser.replaceSup(e))+'"',n=n.replace(/<overline>/g,"<span style=text-decoration:overline>"),n=n.replace(/<\/overline>/g,"</span>"),n=n.replace(/<arrow>/g,"<span style=text-decoration:overline>"),n=n.replace(/<\/arrow>/g,"</span>"),n=n.replace(/&amp;/g,"&")},notifyParents:function(e){var t=null;do{var i=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;t=i.exec(e),null!=t&&(JXG.GeonextParser.findDependencies(this,t[1],this.board),e=e.substr(t.index),e=e.replace(i,""))}while(null!=t);return this},bounds:function(){var e=this.coords.usrCoords;return this.visProp.islabel?[0,0,0,0]:[e[1],e[2]+this.size[1],e[1]+this.size[0],e[2]]},setPositionDirectly:function(e,t,i){var n,r,o=new JXG.Coords(e,t,this.board),a=new JXG.Coords(e,i,this.board);return this.relativeCoords?this.visProp.islabel?(n=JXG.Math.Statistics.subtract(o.scrCoords,a.scrCoords),this.relativeCoords.scrCoords[1]+=n[1],this.relativeCoords.scrCoords[2]+=n[2]):(n=JXG.Math.Statistics.subtract(o.usrCoords,a.usrCoords),this.relativeCoords.usrCoords[1]+=n[1],this.relativeCoords.usrCoords[2]+=n[2]):(n=JXG.Math.Statistics.subtract(o.usrCoords,a.usrCoords),r=[this.Z(),this.X(),this.Y()],this.X=JXG.createFunction(r[1]+n[1],this.board,""),this.Y=JXG.createFunction(r[2]+n[2],this.board,"")),this}}),JXG.createText=function(e,t,i){var n,r=JXG.copyAttributes(i,e.options,"text");return r.anchor=r.parent||r.anchor,n=new JXG.Text(e,t[t.length-1],t,r),"function"!=typeof t[t.length-1]&&(n.parents=t),0!=JXG.evaluate(r.rotate)&&"internal"==r.display&&n.addRotation(JXG.evaluate(r.rotate)),n},JXG.JSXGraph.registerElement("text",JXG.createText),JXG.Image=function(e,t,i,n,r){this.constructor(e,r,JXG.OBJECT_TYPE_IMAGE,JXG.OBJECT_CLASS_OTHER),this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,i,this.board),!JXG.isFunction(i[0])&&!JXG.isFunction(i[1])&&(this.isDraggable=!0),this.X=JXG.createFunction(i[0],this.board,""),this.Y=JXG.createFunction(i[1],this.board,""),this.Z=JXG.createFunction(1,this.board,""),this.W=JXG.createFunction(n[0],this.board,""),this.H=JXG.createFunction(n[1],this.board,""),this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*e.unitX),Math.abs(this.usrSize[1]*e.unitY)],this.url=t,this.elType="image",this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]],this.parent=JXG.getRef(r.anchor),this.id=this.board.setId(this,"Im"),this.board.renderer.drawImage(this),this.visProp.visible||this.board.renderer.hide(this)},JXG.Image.prototype=new JXG.GeometryElement,JXG.extend(JXG.Image.prototype,{hasPoint:function(e,t){var i,n,r,o,a,s,l,c=this.transformations.length;return 0==c?(i=e-this.coords.scrCoords[1],n=this.coords.scrCoords[2]-t,r=this.board.options.precision.hasPoint,i>=-r&&r>=i-this.size[0]&&n>=-r&&r>=n-this.size[1]?!0:!1):(o=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,t],this.board),o=o.usrCoords,a=[o[0]-this.span[0][0],o[1]-this.span[0][1],o[2]-this.span[0][2]],l=JXG.Math.innerProduct,s=l(a,this.span[1]),s>=0&&l(this.span[1],this.span[1])>=s&&(s=l(a,this.span[2]),s>=0&&l(this.span[2],this.span[2])>=s)?!0:!1)},update:function(){return this.needsUpdate&&(this.updateCoords(),this.usrSize=[this.W(),this.H()],this.size=[Math.abs(this.usrSize[0]*this.board.unitX),Math.abs(this.usrSize[1]*this.board.unitY)],this.updateTransform(),this.updateSpan()),this},updateRenderer:function(){return this.needsUpdate&&(this.board.renderer.updateImage(this),this.needsUpdate=!1),this},updateTransform:function(){var e,t=this.transformations.length;if(t>0)for(e=0;t>e;e++)this.transformations[e].update();return this},updateCoords:function(){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()])},updateSize:function(){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.W(),this.H()])},updateSpan:function(){var e,t,i=this.transformations.length,n=[];if(0==i)this.span=[[this.Z(),this.X(),this.Y()],[this.Z(),this.W(),0],[this.Z(),0,this.H()]];else{for(n[0]=[this.Z(),this.X(),this.Y()],n[1]=[this.Z(),this.X()+this.W(),this.Y()],n[2]=[this.Z(),this.X(),this.Y()+this.H()],e=0;i>e;e++)for(t=0;3>t;t++)n[t]=JXG.Math.matVecMult(this.transformations[e].matrix,n[t]);for(t=0;3>t;t++)n[t][1]/=n[t][0],n[t][2]/=n[t][0],n[t][0]/=n[t][0];for(t=1;3>t;t++)n[t][0]-=n[0][0],n[t][1]-=n[0][1],n[t][2]-=n[0][2];this.span=n}return this},addTransform:function(e){if(JXG.isArray(e))for(var t=0;e.length>t;t++)this.transformations.push(e[t]);else this.transformations.push(e)},setPositionDirectly:function(e,t,i){var n,r=new JXG.Coords(e,t,this.board),o=new JXG.Coords(e,i,this.board),a=[this.Z(),this.X(),this.Y()];return n=JXG.Math.Statistics.subtract(r.usrCoords,o.usrCoords),this.X=JXG.createFunction(a[1]+n[1],this.board,""),this.Y=JXG.createFunction(a[2]+n[2],this.board,""),this}}),JXG.createImage=function(e,t,i){var n,r;return n=JXG.copyAttributes(i,e.options,"image"),r=new JXG.Image(e,t[0],t[1],t[2],n),0!=JXG.evaluate(n.rotate)&&r.addRotation(JXG.evaluate(n.rotate)),r},JXG.JSXGraph.registerElement("image",JXG.createImage),JXG.createSlider=function(e,t,i){var n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w,k,_;return n=t[0],r=t[1],o=t[2][0],a=t[2][1],s=t[2][2],l=s-o,k=JXG.copyAttributes(i,e.options,"slider"),C=k.withticks,x=k.withlabel,w=k.snapwidth,_=k.precision,k=JXG.copyAttributes(i,e.options,"slider","point1"),c=e.create("point",n,k),k=JXG.copyAttributes(i,e.options,"slider","point2"),u=e.create("point",r,k),e.create("group",[c,u]),k=JXG.copyAttributes(i,e.options,"slider","baseline"),d=e.create("segment",[c,u],k),d.updateStdform(),C&&(k=JXG.copyAttributes(i,e.options,"slider","ticks"),h=2,p=e.create("ticks",[d,u.Dist(c)/h],k)),f=n[0]+(r[0]-n[0])*(a-o)/(s-o),g=n[1]+(r[1]-n[1])*(a-o)/(s-o),k=JXG.copyAttributes(i,e.options,"slider"),k.withLabel=!1,m=e.create("glider",[f,g,d],k),m.setProperty({snapwidth:w}),k=JXG.copyAttributes(i,e.options,"slider","highline"),b=e.create("segment",[c,m],k),m.Value=function(){return-1===m.visProp.snapwidth?this.position*l+o:Math.round((this.position*l+o)/this.visProp.snapwidth)*this.visProp.snapwidth},m.methodMap=JXG.deepCopy(m.methodMap,{Value:"Value"}),m._smax=s,m._smin=o,x&&(v=i.name&&""!=i.name?i.name+" = ":"",k=JXG.copyAttributes(i,e.options,"slider","label"),y=e.create("text",[function(){return.05*(u.X()-c.X())+u.X()},function(){return.05*(u.Y()-c.Y())+u.Y()},function(){return v+m.Value().toFixed(_)}],k),m.label.content=y),m.point1=c,m.point2=u,m.baseline=d,m.highline=b,C&&(m.ticks=p),m.remove=function(){x&&e.removeObject(y),e.removeObject(b),C&&d.removeTicks(p),e.removeObject(d),e.removeObject(u),e.removeObject(c),JXG.Point.prototype.remove.call(m)},c.dump=!1,u.dump=!1,d.dump=!1,b.dump=!1,m.elType="slider",m.parents=t,m.subs={point1:c,point2:u,baseLine:d,highLine:b},C&&(p.dump=!1,m.subs.ticks=p),m},JXG.JSXGraph.registerElement("slider",JXG.createSlider),JXG.Chart=function(e,t,i){this.constructor(e,i);var n,r,o,a,s,l;if(!JXG.isArray(t)||0===t.length)throw Error("JSXGraph: Can't create a chart without data");if(this.elements=[],JXG.isNumber(t[0]))for(r=t,n=[],o=0;r.length>o;o++)n[o]=o+1;else if(1===t.length&&JXG.isArray(t[0]))for(r=t[0],n=[],l=JXG.evaluate(r).length,o=0;l>o;o++)n[o]=o+1;else 2===t.length&&(l=Math.min(t[0].length,t[1].length),n=t[0].slice(0,l),r=t[1].slice(0,l));if(JXG.isArray(r)&&0===r.length)throw Error("JSXGraph: Can't create charts without data.");for(s=i.chartstyle.replace(/ /g,"").split(","),o=0;s.length>o;o++){switch(s[o]){case"bar":a=this.drawBar(e,n,r,i);break;case"line":a=this.drawLine(e,n,r,i);break;case"fit":a=this.drawFit(e,n,r,i);break;case"spline":a=this.drawSpline(e,n,r,i);break;case"pie":a=this.drawPie(e,r,i);break;case"point":a=this.drawPoints(e,n,r,i);break;case"radar":a=this.drawRadar(e,t,i)}this.elements.push(a)}return this.id=this.board.setId(this,"Chart"),this.elements},JXG.Chart.prototype=new JXG.GeometryElement,JXG.extend(JXG.Chart.prototype,{drawLine:function(e,t,i,n){return n.fillcolor="none",n.highlightfillcolor="none",e.create("curve",[t,i],n)},drawSpline:function(e,t,i,n){return n.fillColor="none",n.highlightfillcolor="none",e.create("spline",[t,i],n)},drawFit:function(e,t,i,n){var r=n.degree;return r=!JXG.exists(r)||0/0==parseInt(r)||1>parseInt(r)?1:parseInt(r),n.fillcolor="none",n.highlightfillcolor="none",e.create("functiongraph",[JXG.Math.Numerics.regressionPolynomial(r,t,i)],n)},drawBar:function(e,t,i,n){var r,o,a,s,l,c,u,d,h,p,f,g=[],m=[],b={fixed:!0,withLabel:!1,visible:!1,name:""};if(JXG.exists(n.fillopacity)||(n.fillopacity=.6),n&&n.width)c=n.width;else{if(1>=t.length)c=1;else for(c=t[1]-t[0],r=1;t.length-1>r;r++)c=c>t[r+1]-t[r]?t[r+1]-t[r]:c;c*=.8}for(a=n.fillcolor,s=parseFloat(e.options.text.fontSize),r=0;t.length>r;r++)isNaN(JXG.evaluate(t[r]))||isNaN(i[r]),JXG.isFunction(t[r])?(u=function(){return t[r]()-.5*c},d=function(){return t[r]()},h=function(){return t[r]()+.5*c}):(u=t[r]-.5*c,d=t[r],h=t[r]+.5*c),p=i[r],"horizontal"==n.dir?(m[0]=e.create("point",[0,u],b),m[1]=e.create("point",[p,u],b),m[2]=e.create("point",[p,h],b),m[3]=e.create("point",[0,h],b),JXG.exists(n.labels)&&JXG.exists(n.labels[r])&&(o=(""+n.labels[r]).length,o=2*o*s/e.unitX,p>=0?p+=.5*s/e.unitX:p-=s*o/e.unitX,d-=.2*s/e.unitY,l=e.create("text",[p,d,n.labels[r]],n))):(m[0]=e.create("point",[u,0],b),m[1]=e.create("point",[u,p],b),m[2]=e.create("point",[h,p],b),m[3]=e.create("point",[h,0],b),JXG.exists(n.labels)&&JXG.exists(n.labels[r])&&(o=(""+n.labels[r]).length,o=.6*o*s/e.unitX,p>=0?p+=.5*s/e.unitY:p-=1*s/e.unitY,l=e.create("text",[d-.5*o,p,n.labels[r]],n))),n.withlines=!1,JXG.exists(n.colors)&&JXG.isArray(n.colors)&&(f=n.colors,n.fillcolor=f[r%f.length]),g[r]=e.create("polygon",m,n),JXG.exists(n.labels)&&JXG.exists(n.labels[r])&&(g[r].text=l);
return g},drawPoints:function(e,t,i,n){var r,o=[],a=n.infoboxarray;for(n.fixed=!0,n.name="",r=0;t.length>r;r++)n.infoboxtext=a?a[r%a.length]:!1,o[r]=e.create("point",[t[r],i[r]],n);return o},drawPie:function(e,t,i){var n,r,o=[],a=[],s=(JXG.Math.Statistics.sum(t),i.colors),l=i.highlightcolors,c=i.labels,u=i.radius||4,d=u,h=i.center||[0,0],p=h[0],f=h[1],g={fixed:!0,withLabel:!1,visible:!1,name:""};if(!JXG.isArray(c))for(c=[],n=0;t.length>n;n++)c[n]="";for(JXG.isFunction(u)||(d=function(){return u}),i.highlightonsector=i.highlightonsector||!1,i.straightfirst=!1,i.straightlast=!1,r=e.create("point",[p,f],g),o[0]=e.create("point",[function(){return d()+p},function(){return f}],g),n=0;t.length>n;n++)o[n+1]=e.create("point",[function(e){return function(){var i,n,r,o=0;for(n=0;e>=n;n++)o+=parseFloat(JXG.evaluate(t[n]));for(i=o,n=e+1;t.length>n;n++)i+=parseFloat(JXG.evaluate(t[n]));return r=0!=i?2*Math.PI*o/i:0,d()*Math.cos(r)+p}}(n),function(e){return function(){var i,n,r,o=0;for(n=0;e>=n;n++)o+=parseFloat(JXG.evaluate(t[n]));for(i=o,n=e+1;t.length>n;n++)i+=parseFloat(JXG.evaluate(t[n]));return r=0!=i?2*Math.PI*o/i:0,d()*Math.sin(r)+f}}(n)],g),i.name=c[n],i.withlabel=""!=i.name,i.fillcolor=s&&s[n%s.length],i.labelcolor=s&&s[n%s.length],i.highlightfillcolor=l&&l[n%l.length],a[n]=e.create("sector",[r,o[n],o[n+1]],i),i.highlightonsector&&(a[n].hasPoint=a[n].hasPointSector),i.highlightbysize&&(a[n].highlight=function(){if(!this.highlighted){this.highlighted=!0,this.board.renderer.highlight(this);var e=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],t=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];null!=this.label.content&&(this.label.content.rendNode.style.fontSize=2*this.label.content.visProp.fontsize+"px",this.label.content.prepareUpdate().update().updateRenderer()),this.point2.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+1.1*e,this.point1.coords.usrCoords[2]+1.1*t],this.board),this.prepareUpdate().update().updateRenderer()}},a[n].noHighlight=function(){if(this.highlighted){this.highlighted=!1,this.board.renderer.noHighlight(this);var e=-this.point1.coords.usrCoords[1]+this.point2.coords.usrCoords[1],t=-this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[2];null!=this.label.content&&(this.label.content.rendNode.style.fontSize=2*this.label.content.visProp.fontsize+"px",this.label.content.prepareUpdate().update().updateRenderer()),this.point2.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.point1.coords.usrCoords[1]+e/1.1,this.point1.coords.usrCoords[2]+t/1.1],this.board),this.prepareUpdate().update().updateRenderer()}});return{sectors:a,points:o,midpoint:r}},drawRadar:function(e,t,i){var n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w,k,_,E,T,S,A,P,O,R,L,I,G,X,D,M,N,J,B,F,j,z,H=t.length;if(0>=H)return JXG.debug("No data"),void 0;if(o=i.paramarray,!JXG.exists(o))return JXG.debug("Need paramArray attribute"),void 0;if(a=o.length,1>=a)return JXG.debug("Need more than 1 param"),void 0;for(n=0;H>n;n++)if(a!=t[n].length)return JXG.debug("Use data length equal to number of params ("+t[n].length+" != "+a+")"),void 0;for(s=Array(a),l=Array(a),r=0;a>r;r++)s[r]=t[0][r],l[r]=s[r];for(n=1;H>n;n++)for(r=0;a>r;r++)t[n][r]>s[r]&&(s[r]=t[n][r]),t[n][r]<l[r]&&(l[r]=t[n][r]);for(c=Array(H),u=Array(H),n=0;H>n;n++)c[n]="",u[n]=[];for(d=Array(a),h=Array(a),p=i.startshiftratio||0,f=i.endshiftratio||0,n=0;a>n;n++)d[n]=(s[n]-l[n])*p,h[n]=(s[n]-l[n])*f;if(g=i.startshiftarray||d,m=i.endshiftarray||h,b=i.startarray||l,JXG.exists(i.start))for(n=0;a>n;n++)b[n]=i.start;if(v=i.endarray||s,JXG.exists(i.end))for(n=0;a>n;n++)v[n]=i.end;if(g.length!=a)return JXG.debug("Start shifts length is not equal to number of parameters"),void 0;if(m.length!=a)return JXG.debug("End shifts length is not equal to number of parameters"),void 0;if(b.length!=a)return JXG.debug("Starts length is not equal to number of parameters"),void 0;if(v.length!=a)return JXG.debug("Ends length is not equal to number of parameters"),void 0;y=i.labelarray||c,x=i.colors,C=i.highlightcolors,w=i.radius||10,k={},JXG.exists(i.highlightonsector)||(i.highlightonsector=!1),k.name=i.name,k.id=i.id,k.strokewidth=i.strokewidth||1,k.polystrokewidth=i.polystrokewidth||2*k.strokewidth,k.strokecolor=i.strokecolor||"black",k.straightfirst=!1,k.straightlast=!1,k.fillcolor=i.fillColor||"#FFFF88",k.fillopacity=i.fillOpacity||.4,k.highlightfillcolor=i.highlightFillColor||"#FF7400",k.highlightstrokecolor=i.highlightStrokeColor||"black",k.gradient=i.gradient||"none",_=i.center||[0,0],E=_[0],T=_[1],S=e.create("point",[E,T],{name:"",fixed:!0,withlabel:!1,visible:!1}),A=Math.PI/2-Math.PI/a,(i.startangle||0===i.startangle)&&(A=i.startangle),P=A,O=[],R=[];var $=function(){var e,t,i,n,r=this.visProp.label.offset.slice(0);return e=this.point1.X(),t=this.point2.X(),i=this.point1.Y(),n=this.point2.Y(),e>t&&(r[0]=-r[0]),i>n&&(r[1]=-r[1]),this.setLabelRelativeCoords(r),new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)},Y=function(t,i){var n,r,o;return n=e.create("transform",[-(b[i]-g[i]),0],{type:"translate"}),r=e.create("transform",[w/(v[i]+m[i]-(b[i]-g[i])),1],{type:"scale"}),n.melt(r),o=e.create("transform",[t],{type:"rotate"}),n.melt(o),n};for(n=0;a>n;n++)for(P+=2*Math.PI/a,I=w*Math.cos(P)+E,G=w*Math.sin(P)+T,O[n]=e.create("point",[I,G],{name:"",fixed:!0,withlabel:!1,visible:!1}),R[n]=e.create("line",[S,O[n]],{name:o[n],strokeColor:k.strokecolor,strokeWidth:k.strokewidth,strokeOpacity:1,straightFirst:!1,straightLast:!1,withLabel:!0,highlightStrokeColor:k.highlightstrokecolor}),R[n].getLabelAnchor=$,L=Y(P,n),r=0;t.length>r;r++){var U=t[r][n];u[r][n]=e.create("point",[U,0],{name:"",fixed:!0,withlabel:!1,visible:!1}),u[r][n].addTransform(u[r][n],L)}for(X=Array(H),n=0;H>n;n++)for(k.labelcolor=x&&x[n%x.length],k.strokecolor=x&&x[n%x.length],k.fillcolor=x&&x[n%x.length],X[n]=e.create("polygon",u[n],{withLines:!0,withLabel:!1,fillColor:k.fillcolor,fillOpacity:k.fillopacity,highlightFillColor:k.highlightfillcolor}),r=0;a>r;r++)X[n].borders[r].setProperty("strokecolor:"+x[n%x.length]),X[n].borders[r].setProperty("strokewidth:"+k.polystrokewidth);switch(D=i.legendposition||"none"){case"right":var W=i.legendleftoffset||2,V=i.legendtopoffset||1;this.legend=e.create("legend",[E+w+W,T+w-V],{labels:y,colors:x});break;case"none":break;default:JXG.debug("Unknown legend position")}if(M=[],0!=i.showcircles){for(N=[],n=0;6>n;n++)N[n]=20*n;if(N[0]="0",J=i.circlelabelarray||N,B=J.length,2>B)return alert("Too less circles"),void 0;for(F=[],j=A+Math.PI/a,L=Y(j,0),k.fillcolor="none",k.highlightfillcolor="none",k.strokecolor=i.strokecolor||"black",k.strokewidth=i.circlestrokewidth||.5,k.layer=0,z=(v[0]-b[0])/(B-1),n=0;B>n;n++)F[n]=e.create("point",[b[0]+n*z,0],{name:J[n],size:0,fixed:!0,withLabel:!0,visible:!0}),F[n].addTransform(F[n],L),M[n]=e.create("circle",[S,F[n]],k)}return this.rendNode=X[0].rendNode,{circles:M,lines:R,points:u,midpoint:S,polygons:X}},updateRenderer:function(){return this},update:function(){return this.needsUpdate&&this.updateDataArray(),this},updateDataArray:function(){}}),JXG.createChart=function(e,t,i){if(1==t.length&&"string"==typeof t[0]){var n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y=document.getElementById(t[0]),x=[];if(JXG.exists(y)){if(v=JXG.copyAttributes(i,e.options,"chart"),y=(new JXG.DataSource).loadFromTable(t[0],v.withheaders,v.withheaders),n=y.data,s=y.columnHeaders,r=y.rowHeaders,d=v.width,h=v.name,p=v.strokecolor,f=v.fillcolor,g=v.highlightstrokecolor,m=v.highlightfillcolor,e.suspendUpdate(),b=n.length,u=[],v.rows&&JXG.isArray(v.rows)){for(o=0;b>o;o++)for(a=0;v.rows.length>a;a++)if(v.rows[a]==o||v.withheaders&&v.rows[a]==r[o]){u.push(n[o]);break}}else u=n;for(b=u.length,o=0;b>o;o++){if(c=[],v.chartstyle&&-1!=v.chartstyle.indexOf("bar")){for(l=d?d:.8,c.push(1-l/2+(o+.5)*l/(1*b)),a=1;u[o].length>a;a++)c.push(c[a-1]+1);v.width=l/(1*b)}h&&h.length==b?v.name=h[o]:v.withheaders&&(v.name=s[o]),v.strokecolor=p&&p.length==b?p[o]:JXG.hsv2rgb(360*((o+1)/(1*b)),.9,.6),v.fillcolor=f&&f.length==b?f[o]:JXG.hsv2rgb(360*((o+1)/(1*b)),.9,1),v.highlightstrokecolor=g&&g.length==b?g[o]:JXG.hsv2rgb(360*((o+1)/(1*b)),.9,1),v.highlightfillcolor=m&&m.length==b?m[o]:JXG.hsv2rgb(360*((o+1)/(1*b)),.9,.6),v.chartstyle&&-1!=v.chartstyle.indexOf("bar")?x.push(new JXG.Chart(e,[c,u[o]],v)):x.push(new JXG.Chart(e,[u[o]],v))}e.unsuspendUpdate()}return x}return v=JXG.copyAttributes(i,e.options,"chart"),new JXG.Chart(e,t,v)},JXG.JSXGraph.registerElement("chart",JXG.createChart),JXG.Legend=function(e,t,i){var n;switch(this.constructor(),n=JXG.copyAttributes(i,e.options,"legend"),this.board=e,this.coords=new JXG.Coords(JXG.COORDS_BY_USER,t,this.board),this.myAtts={},this.label_array=n.labelarray||n.labels,this.color_array=n.colorarray||n.colors,this.lines=[],this.myAtts.strokewidth=n.strokewidth||5,this.myAtts.straightfirst=!1,this.myAtts.straightlast=!1,this.myAtts.withlabel=!0,this.myAtts.fixed=!0,this.style=n.legendstyle||n.style,this.style){case"vertical":this.drawVerticalLegend(e,n);break;default:throw Error("JSXGraph: Unknown legend style: "+this.style)}},JXG.Legend.prototype=new JXG.GeometryElement,JXG.Legend.prototype.drawVerticalLegend=function(e,t){var i,n=t.linelength||1,r=(t.rowheight||20)/this.board.unitY;for(i=0;this.label_array.length>i;i++)this.myAtts.strokecolor=this.color_array[i],this.myAtts.highlightstrokecolor=this.color_array[i],this.myAtts.name=this.label_array[i],this.myAtts.label={offset:[10,0],strokeColor:this.color_array[i],strokeWidth:this.myAtts.strokewidth},this.lines[i]=e.create("line",[[this.coords.usrCoords[1],this.coords.usrCoords[2]-i*r],[this.coords.usrCoords[1]+n,this.coords.usrCoords[2]-i*r]],this.myAtts),this.lines[i].getLabelAnchor=function(){return this.setLabelRelativeCoords(this.visProp.label.offset),new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X(),this.point2.Y()],this.board)}},JXG.createLegend=function(e,t,i){var n=[0,0];return JXG.exists(t)&&2==t.length&&(n=t),new JXG.Legend(e,n,i)},JXG.JSXGraph.registerElement("legend",JXG.createLegend),JXG.Transformation=function(e,t,i){this.elementClass=JXG.OBJECT_CLASS_OTHER,this.matrix=[[1,0,0],[0,1,0],[0,0,1]],this.board=e,this.isNumericMatrix=!1,this.setMatrix(e,t,i)},JXG.Transformation.prototype={},JXG.extend(JXG.Transformation.prototype,{update:function(){return this},setMatrix:function(e,t,i){var n;for(this.isNumericMatrix=!0,n=0;i.length>n;n++)if("number"!=typeof i[n]){this.isNumericMatrix=!1;break}"translate"==t?(this.evalParam=JXG.createEvalFunction(e,i,2),this.update=function(){this.matrix[1][0]=this.evalParam(0),this.matrix[2][0]=this.evalParam(1)}):"scale"==t?(this.evalParam=JXG.createEvalFunction(e,i,2),this.update=function(){this.matrix[1][1]=this.evalParam(0),this.matrix[2][2]=this.evalParam(1)}):"reflect"==t?(4>i.length&&(i[0]=JXG.getReference(e,i[0])),2==i.length&&(i[1]=JXG.getReference(e,i[1])),4==i.length&&(this.evalParam=JXG.createEvalFunction(e,i,4)),this.update=function(){var e,t,n,r,o,a,s,l;1==i.length?s=i[0].stdform:2==i.length?s=JXG.Math.crossProduct(i[1].coords.usrCoords,i[0].coords.usrCoords):4==i.length&&(s=JXG.Math.crossProduct([1,this.evalParam(2),this.evalParam(3)],[1,this.evalParam(0),this.evalParam(1)])),e=s[1],t=s[2],n=s[0],l=[-n*e,-n*t,e*e+t*t],a=l[2],r=l[0]/l[2],o=l[1]/l[2],e=-s[2],t=s[1],this.matrix[1][1]=(e*e-t*t)/a,this.matrix[1][2]=2*e*t/a,this.matrix[2][1]=this.matrix[1][2],this.matrix[2][2]=-this.matrix[1][1],this.matrix[1][0]=r*(1-this.matrix[1][1])-o*this.matrix[1][2],this.matrix[2][0]=o*(1-this.matrix[2][2])-r*this.matrix[2][1]}):"rotate"==t?(3==i.length?this.evalParam=JXG.createEvalFunction(e,i,3):2>=i.length&&(this.evalParam=JXG.createEvalFunction(e,i,1),2==i.length&&(i[1]=JXG.getReference(e,i[1]))),this.update=function(){var e,t,n=this.evalParam(0),r=Math.cos(n),o=Math.sin(n);this.matrix[1][1]=r,this.matrix[1][2]=-o,this.matrix[2][1]=o,this.matrix[2][2]=r,i.length>1&&(3==i.length?(e=this.evalParam(1),t=this.evalParam(2)):(e=i[1].X(),t=i[1].Y()),this.matrix[1][0]=e*(1-r)+t*o,this.matrix[2][0]=t*(1-r)-e*o)}):"shear"==t?(this.evalParam=JXG.createEvalFunction(e,i,1),this.update=function(){var e=this.evalParam(0);this.matrix[1][1]=Math.tan(e)}):"generic"==t&&(this.evalParam=JXG.createEvalFunction(e,i,9),this.update=function(){this.matrix[0][0]=this.evalParam(0),this.matrix[0][1]=this.evalParam(1),this.matrix[0][2]=this.evalParam(2),this.matrix[1][0]=this.evalParam(3),this.matrix[1][1]=this.evalParam(4),this.matrix[1][2]=this.evalParam(5),this.matrix[2][0]=this.evalParam(6),this.matrix[2][1]=this.evalParam(7),this.matrix[2][2]=this.evalParam(8)})},apply:function(e){return this.update(),null!=arguments[1]?JXG.Math.matVecMult(this.matrix,e.initialCoords.usrCoords):JXG.Math.matVecMult(this.matrix,e.coords.usrCoords)},applyOnce:function(e){var t,i,n;for(JXG.isArray(e)||(e=[e]),i=e.length,n=0;i>n;n++)this.update(),t=JXG.Math.matVecMult(this.matrix,e[n].coords.usrCoords),e[n].coords.setCoordinates(JXG.COORDS_BY_USER,t)},bindTo:function(e){var t,i;if(JXG.isArray(e))for(i=e.length,t=0;i>t;t++)e[t].transformations.push(this);else e.transformations.push(this)},setProperty:function(){},melt:function(e){var t,i,n,r,o,a,s=[];for(i=e.matrix.length,n=this.matrix[0].length,t=0;i>t;t++)s[t]=[];for(this.update(),e.update(),t=0;i>t;t++)for(a=0;n>a;a++){for(o=0,r=0;i>r;r++)o+=e.matrix[t][r]*this.matrix[r][a];s[t][a]=o}return this.update=function(){var e=this.matrix.length,i=this.matrix[0].length;for(t=0;e>t;t++)for(a=0;i>a;a++)this.matrix[t][a]=s[t][a]},this}}),JXG.createTransform=function(e,t,i){return new JXG.Transformation(e,i.type,t)},JXG.JSXGraph.registerElement("transform",JXG.createTransform),JXG.Turtle=function(e,t,i){this.constructor(e,i,JXG.OBJECT_TYPE_TURTLE,JXG.OBJECT_CLASS_OTHER);var n,r,o;return this.turtleIsHidden=!1,this.board=e,this.visProp.curveType="plot",this._attributes=JXG.copyAttributes(this.visProp,e.options,"turtle"),delete this._attributes.id,n=0,r=0,o=90,0!=t.length&&(3==t.length?(n=t[0],r=t[1],o=t[2]):2==t.length?JXG.isArray(t[0])?(n=t[0][0],r=t[0][1],o=t[1]):(n=t[0],r=t[1]):(n=t[0][0],r=t[0][1])),this.init(n,r,o),this},JXG.Turtle.prototype=new JXG.GeometryElement,JXG.extend(JXG.Turtle.prototype,{init:function(e,t,i){this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY),this.pos=[e,t],this.isPenDown=!0,this.dir=90,this.stack=[],this.objects=[],this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.turtle=this.board.create("point",this.pos,{fixed:!0,name:" ",visible:!1,withLabel:!1}),this.objects.push(this.turtle),this.turtle2=this.board.create("point",[this.pos[0],this.pos[1]+this.arrowLen],{fixed:!0,name:" ",visible:!1,withLabel:!1}),this.objects.push(this.turtle2),this.visProp.arrow.lastArrow=!0,this.visProp.arrow.straightFirst=!1,this.visProp.arrow.straightLast=!1,this.arrow=this.board.create("line",[this.turtle,this.turtle2],this.visProp.arrow),this.objects.push(this.arrow),this.right(90-i),this.board.update()},forward:function(e){if(0===e)return this;var t=e*Math.cos(this.dir*Math.PI/180),i=e*Math.sin(this.dir*Math.PI/180);if(!this.turtleIsHidden){var n=this.board.create("transform",[t,i],{type:"translate"});n.applyOnce(this.turtle),n.applyOnce(this.turtle2)}return this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]+=t,this.pos[1]+=i,this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update(),this},back:function(e){return this.forward(-e)},right:function(e){if(this.dir-=e,this.dir%=360,!this.turtleIsHidden){var t=this.board.create("transform",[-e*Math.PI/180,this.turtle],{type:"rotate"});t.applyOnce(this.turtle2)}return this.board.update(),this},left:function(e){return this.right(-e)},penUp:function(){return this.isPenDown=!1,this},penDown:function(){return this.isPenDown=!0,this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this},clean:function(){for(var e=0;this.objects.length>e;e++){var t=this.objects[e];t.type==JXG.OBJECT_TYPE_CURVE&&(this.board.removeObject(t),this.objects.splice(e,1))}return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},clearScreen:function(){var e,t,i=this.objects.length;for(e=0;i>e;e++)t=this.objects[e],this.board.removeObject(t);return this.init(0,0,90),this},setPos:function(e,t){if(this.pos=JXG.isArray(e)?e:[e,t],!this.turtleIsHidden){this.turtle.setPositionDirectly(JXG.COORDS_BY_USER,[e,t]),this.turtle2.setPositionDirectly(JXG.COORDS_BY_USER,[e,t+this.arrowLen]);var i=this.board.create("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"});i.applyOnce(this.turtle2)}return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve),this.board.update(),this},setPenSize:function(e){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeWidth",e)),this.objects.push(this.curve),this},setPenColor:function(e){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("strokeColor",e)),this.objects.push(this.curve),this},setHighlightPenColor:function(e){return this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this.copyAttr("highlightStrokeColor",e)),this.objects.push(this.curve),this},setProperty:function(e){var t,i,n,r=this.objects.length;for(t=0;r>t;t++)i=this.objects[t],i.type==JXG.OBJECT_TYPE_CURVE&&i.setProperty(e);return n=this.visProp.id,this.visProp=JXG.deepCopy(this.curve.visProp),this.visProp.id=n,this._attributes=JXG.deepCopy(this.visProp),delete this._attributes.id,this},copyAttr:function(e,t){return this._attributes[e.toLowerCase()]=t,this._attributes},showTurtle:function(){return this.turtleIsHidden=!1,this.arrow.setProperty({visible:!0}),this.visProp.arrow.visible=!1,this.setPos(this.pos[0],this.pos[1]),this.board.update(),this},hideTurtle:function(){return this.turtleIsHidden=!0,this.arrow.setProperty({visible:!1}),this.visProp.arrow.visible=!1,this.board.update(),this},home:function(){return this.pos=[0,0],this.setPos(this.pos[0],this.pos[1]),this},pushTurtle:function(){return this.stack.push([this.pos[0],this.pos[1],this.dir]),this},popTurtle:function(){var e=this.stack.pop();return this.pos[0]=e[0],this.pos[1]=e[1],this.dir=e[2],this.setPos(this.pos[0],this.pos[1]),this},lookTo:function(e){if(JXG.isArray(e)){var t,i=this.pos[0],n=this.pos[1],r=e[0],o=e[1];t=Math.atan2(o-n,r-i),this.right(this.dir-180*t/Math.PI)}else JXG.isNumber(e)&&this.right(this.dir-e);return this},moveTo:function(e){if(JXG.isArray(e)){var t=e[0]-this.pos[0],i=e[1]-this.pos[1];if(!this.turtleIsHidden){var n=this.board.create("transform",[t,i],{type:"translate"});n.applyOnce(this.turtle),n.applyOnce(this.turtle2)}this.isPenDown&&this.curve.dataX.length>=8192&&(this.curve=this.board.create("curve",[[this.pos[0]],[this.pos[1]]],this._attributes),this.objects.push(this.curve)),this.pos[0]=e[0],this.pos[1]=e[1],this.isPenDown&&(this.curve.dataX.push(this.pos[0]),this.curve.dataY.push(this.pos[1])),this.board.update()}return this},fd:function(e){return this.forward(e)},bk:function(e){return this.back(e)},lt:function(e){return this.left(e)},rt:function(e){return this.right(e)},pu:function(){return this.penUp()},pd:function(){return this.penDown()},ht:function(){return this.hideTurtle()},st:function(){return this.showTurtle()},cs:function(){return this.clearScreen()},push:function(){return this.pushTurtle()},pop:function(){return this.popTurtle()},evalAt:function(e,t){var i,n,r,o,a=this.objects.length;for(i=0,n=0;a>i;i++)if(r=this.objects[i],r.elementClass==JXG.OBJECT_CLASS_CURVE){if(e>=n&&n+r.numberPoints>e)return o=e-n,r[t](o);n+=r.numberPoints}return this[t]()},X:function(e){return e===void 0?this.pos[0]:this.evalAt(e,"X")},Y:function(e){return e===void 0?this.pos[1]:this.evalAt(e,"Y")},Z:function(){return 1},minX:function(){return 0},maxX:function(){var e,t,i=0,n=this.objects.length;for(e=0;n>e;e++)t=this.objects[e],t.elementClass==JXG.OBJECT_CLASS_CURVE&&(i+=this.objects[e].numberPoints);return i},hasPoint:function(e,t){var i,n;for(i=0;this.objects.length>i;i++)if(n=this.objects[i],n.type==JXG.OBJECT_TYPE_CURVE&&n.hasPoint(e,t))return!0;return!1}}),JXG.createTurtle=function(e,t,i){var n;return t=t||[],n=JXG.copyAttributes(i,e.options,"turtle"),new JXG.Turtle(e,t,n)},JXG.JSXGraph.registerElement("turtle",JXG.createTurtle),JXG.rgbParser=function(){var e,t,i,n,r,o=!1;if(0===arguments.length)return[];if(arguments.length>=3&&(arguments[0]=[arguments[0],arguments[1],arguments[2]],arguments.length=1),e=arguments[0],JXG.isArray(e)){for(t=0;3>t;t++)o|=/\./.test(""+arguments[0][t]);for(t=0;3>t;t++)o&=arguments[0][t]>=0&1>=arguments[0][t];return o?[Math.ceil(255*arguments[0][0]),Math.ceil(255*arguments[0][1]),Math.ceil(255*arguments[0][2])]:(arguments[0].length=3,arguments[0])}"string"==typeof arguments[0]&&(e=arguments[0]),"#"==e.charAt(0)&&(e=e.substr(1,6)),e=e.replace(/ /g,"").toLowerCase();var a={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};e=a[e]||e;var s=[{re:/^\s*rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]{1,3})\s*\)\s*$/,example:["rgba(123, 234, 45, 0.5)","rgba(255,234,245,1.0)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^\s*rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)\s*$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(e){return[parseInt(e[1]),parseInt(e[2]),parseInt(e[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(e){return[parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(e){return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)]}}];for(t=0;s.length>t;t++){var l,c=s[t].re,u=s[t].process,d=c.exec(e);d&&(l=u(d),i=l[0],n=l[1],r=l[2])}return isNaN(i)||isNaN(n)||isNaN(r)?[]:(i=0>i||isNaN(i)?0:i>255?255:i,n=0>n||isNaN(n)?0:n>255?255:n,r=0>r||isNaN(r)?0:r>255?255:r,[i,n,r])},JXG.rgb2css=function(){var e,t,i;return e=JXG.rgbParser.apply(JXG.rgbParser,arguments),t=e[1],i=e[2],e=e[0],"rgb("+e+", "+t+", "+i+")"},JXG.rgb2hex=function(){var e,t,i;return e=JXG.rgbParser.apply(JXG.rgbParser,arguments),t=e[1],i=e[2],e=e[0],e=e.toString(16),t=t.toString(16),i=i.toString(16),1==e.length&&(e="0"+e),1==t.length&&(t="0"+t),1==i.length&&(i="0"+i),"#"+e+t+i},JXG.hex2rgb=function(e){var t,i,n;return"#"==e.charAt(0)&&(e=e.slice(1)),t=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),n=parseInt(e.substr(4,2),16),"rgb("+t+", "+i+", "+n+")"},JXG.hsv2rgb=function(e,t,i){var n,r,o,a,s,l,c,u,d;if(e=(e%360+360)%360,0==t){if(!(isNaN(e)||JXG.Math.eps>e))return"#ffffff";n=i,r=i,o=i}else switch(l=e>=360?0:e,l/=60,s=Math.floor(l),a=l-s,c=i*(1-t),u=i*(1-t*a),d=i*(1-t*(1-a)),s){case 0:n=i,r=d,o=c;break;case 1:n=u,r=i,o=c;break;case 2:n=c,r=i,o=d;break;case 3:n=c,r=u,o=i;break;case 4:n=d,r=c,o=i;break;case 5:n=i,r=c,o=u}return n=Math.round(255*n).toString(16),n=2==n.length?n:1==n.length?"0"+n:"00",r=Math.round(255*r).toString(16),r=2==r.length?r:1==r.length?"0"+r:"00",o=Math.round(255*o).toString(16),o=2==o.length?o:1==o.length?"0"+o:"00",["#",n,r,o].join("")},JXG.rgb2hsv=function(){var e,t,i,n,r,o,a,s,l,c,u,d,h,p;return e=JXG.rgbParser.apply(JXG.rgbParser,arguments),t=e[1],i=e[2],e=e[0],p=JXG.Math.Statistics,n=e/255,r=t/255,o=i/255,d=p.max([e,t,i]),h=p.min([e,t,i]),a=d/255,s=h/255,u=a,c=0,u>0&&(c=(u-s)/(1*u)),l=1/(a-s),c>0&&(l=d==e?(r-o)*l:d==t?2+(o-n)*l:4+(n-r)*l),l*=60,0>l&&(l+=360),d==h&&(l=0),[l,c,u]},JXG.rgb2LMS=function(){var e,t,i,n,r,o,a,s=[[.05059983,.08585369,.0095242],[.01893033,.08925308,.01370054],[.00292202,.00975732,.07145979]];return e=JXG.rgbParser.apply(JXG.rgbParser,arguments),t=e[1],i=e[2],e=e[0],e=Math.pow(e,.476190476),t=Math.pow(t,.476190476),i=Math.pow(i,.476190476),n=e*s[0][0]+t*s[0][1]+i*s[0][2],r=e*s[1][0]+t*s[1][1]+i*s[1][2],o=e*s[2][0]+t*s[2][1]+i*s[2][2],a=[n,r,o],a.l=n,a.m=r,a.s=o,a},JXG.LMS2rgb=function(e,t,i){var n,r,o,a,s=[[30.830854,-29.832659,1.610474],[-6.481468,17.715578,-2.532642],[-.37569,-1.199062,14.273846]];n=e*s[0][0]+t*s[0][1]+i*s[0][2],r=e*s[1][0]+t*s[1][1]+i*s[1][2],o=e*s[2][0]+t*s[2][1]+i*s[2][2];var l=function(e){for(var t=127,i=64;i>0;){if(Math.pow(t,.476190476)>e)t-=i;else{if(Math.pow(t+1,.476190476)>e)return t;t+=i}i/=2}return 254==t&&e>13.994955247?255:t};return n=l(n),r=l(r),o=l(o),a=[n,r,o],a.r=n,a.g=r,a.b=o,a},JXG.rgba2rgbo=function(e){var t;return 9==e.length&&"#"==e.charAt(0)?(t=parseInt(e.substr(7,2).toUpperCase(),16)/255,e=e.substr(0,7)):t=1,[e,t]},JXG.rgbo2rgba=function(e,t){var i;return"none"==e?e:(i=Math.round(255*t).toString(16),1==i.length&&(i="0"+i),e+i)},JXG.rgb2bw=function(e){if("none"==e)return e;var t,i,n,r="0123456789ABCDEF";return n=JXG.rgbParser(e),t=.3*n[0]+.59*n[1]+.11*n[2],i=r.charAt(15&t>>4)+r.charAt(15&t),e="#"+i+i+i},JXG.rgb2cb=function(e,t){if("none"==e)return e;var i,n,r,o,a,s,l,c,u,d,h,p,f;switch(a=JXG.rgb2LMS(e),n=a.l,r=a.m,o=a.s,t=t.toLowerCase(),t){case"protanopia":l=-.06150039994295001,c=.08277001656812001,u=-.013200141220000003,d=.05858939668799999,h=-.07934519995360001,p=.013289415272000003,f=.6903216543277437,s=o/r,n=f>s?-(c*r+u*o)/l:-(h*r+p*o)/d;break;case"tritanopia":l=-.00058973116217,c=.007690316482,u=-.01011703519052,d=.025495080838999994,h=-.0422740347,p=.017005316784,f=.8349489908460004,s=r/n,o=f>s?-(l*n+c*r)/u:-(d*n+h*r)/p;break;default:l=-.06150039994295001,c=.08277001656812001,u=-.013200141220000003,d=.05858939668799999,h=-.07934519995360001,p=.013289415272000003,f=.5763833686400911,s=o/n,r=f>s?-(l*n+u*o)/c:-(d*n+p*o)/h}i=JXG.LMS2rgb(n,r,o);var g="0123456789ABCDEF";return s=g.charAt(15&i.r>>4)+g.charAt(15&i.r),e="#"+s,s=g.charAt(15&i.g>>4)+g.charAt(15&i.g),e+=s,s=g.charAt(15&i.b>>4)+g.charAt(15&i.b),e+=s},JXG.extend(JXG.Board.prototype,{intersection:function(e,t,i,n,r){var o;return e=JXG.getReference(this,e),t=JXG.getReference(this,t),null!=r&&(o=r.point),e.elementClass!=JXG.OBJECT_CLASS_CURVE||t.elementClass!=JXG.OBJECT_CLASS_CURVE||e.type==JXG.OBJECT_TYPE_ARC&&t.type==JXG.OBJECT_TYPE_ARC?e.type==JXG.OBJECT_TYPE_ARC&&t.elementClass==JXG.OBJECT_CLASS_LINE||t.type==JXG.OBJECT_TYPE_ARC&&e.elementClass==JXG.OBJECT_CLASS_LINE?function(){return JXG.Math.Geometry.meet(e.stdform,t.stdform,i,e.board)}:e.elementClass==JXG.OBJECT_CLASS_CURVE&&t.elementClass==JXG.OBJECT_CLASS_LINE||t.elementClass==JXG.OBJECT_CLASS_CURVE&&e.elementClass==JXG.OBJECT_CLASS_LINE?function(){return JXG.Math.Geometry.meetCurveLine(e,t,i,e.board,r)}:e.elementClass==JXG.OBJECT_CLASS_LINE&&t.elementClass==JXG.OBJECT_CLASS_LINE?function(){var n,r,a=e.visProp.straightfirst;return first2=t.visProp.straightfirst,last1=e.visProp.straightlast,last2=t.visProp.straightlast,!JXG.exists(o)||o.visProp.alwaysintersect||0!=a&&0!=last1&&0!=first2&&0!=last2?JXG.Math.Geometry.meet(e.stdform,t.stdform,i,e.board):(n=JXG.Math.Geometry.meetSegmentSegment(e.point1.coords.usrCoords,e.point2.coords.usrCoords,t.point1.coords.usrCoords,t.point2.coords.usrCoords,e.board),r=!a&&0>n[1]||!last1&&n[1]>1||!first2&&0>n[2]||!last2&&n[2]>1?[0,0/0,0/0]:n[0],new JXG.Coords(JXG.COORDS_BY_USER,r,e.board))}:function(){return JXG.Math.Geometry.meet(e.stdform,t.stdform,i,e.board)}:function(){return JXG.Math.Geometry.meetCurveCurve(e,t,i,n,e.board)}},intersectionFunc:function(e,t,i,n){return this.intersection(e,t,i,n)},otherIntersection:function(e,t,i){return e=JXG.getReference(this,e),t=JXG.getReference(this,t),function(){var n=JXG.Math.Geometry.meet(e.stdform,t.stdform,0,e.board);return Math.abs(i.X()-n.usrCoords[1])>JXG.Math.eps||Math.abs(i.Y()-n.usrCoords[2])>JXG.Math.eps||Math.abs(i.Z()-n.usrCoords[0])>JXG.Math.eps?n:JXG.Math.Geometry.meet(e.stdform,t.stdform,1,e.board)}}}),JXG.extend(JXG.Board.prototype,{angle:function(e,t,i){return JXG.Math.Geometry.angle(e,t,i)},rad:function(e,t,i){return JXG.Math.Geometry.rad(e,t,i)},distance:function(e,t){return JXG.Math.Geometry.distance(e,t)},pow:function(e,t){return JXG.Math.pow(e,t)},round:function(e,t){return e.toFixed(t)},cosh:function(e){return JXG.Math.cosh(e)},sinh:function(e){return JXG.Math.sinh(e)},sgn:function(e){return 0==e?0:e/Math.abs(e)},D:function(e,t){return JXG.Math.Numerics.D(e,t)},I:function(e,t){return JXG.Math.Numerics.I(e,t)},root:function(e,t,i){return JXG.Math.Numerics.root(e,t,i)},lagrangePolynomial:function(e){return JXG.Math.Numerics.lagrangePolynomial(e)},neville:function(e){return JXG.Math.Numerics.Neville(e)},riemannsum:function(e,t,i,n,r){return JXG.Math.Numerics.riemannsum(e,t,i,n,r)},abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,random:Math.random,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,trunc:Math.ceil,factorial:function(e){return JXG.Math.factorial(e)},binomial:function(e,t){return JXG.Math.binomial(e,t)},getElement:function(e){return JXG.getReference(this,e)},intersectionOptions:["point",[[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_CIRCLE],[JXG.OBJECT_CLASS_CIRCLE,JXG.OBJECT_CLASS_CIRCLE]]],pointFunc:function(){return[null]},pointOptions:["point",[[JXG.OBJECT_CLASS_POINT]]],lineFunc:function(){return arguments
},lineOptions:["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],linesegmentFunc:function(){return arguments},linesegmentOptions:["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],linesegmentAtts:{straightFirst:!1,straightLast:!1},arrowFunc:function(){return arguments},arrowOptions:["arrow",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circleFunc:function(){return arguments},circleOptions:["circle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_CIRCLE]]],arrowparallelOptions:["arrowparallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],arrowparallelFunc:function(){return arguments},bisectorOptions:["bisector",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],bisectorFunc:function(){return arguments},circumcircleOptions:["circumcircle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circumcircleFunc:function(){return arguments},circumcirclemidpointOptions:["circumcirclemidpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],circumcirclemidpointFunc:function(){return arguments},integralOptions:["integral",[[]]],integralFunc:function(){return arguments},midpointOptions:["midpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_LINE]]],midpointFunc:function(){return arguments},mirrorpointOptions:["mirrorpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],mirrorpointFunc:function(){return arguments},normalOptions:["normal",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],normalFunc:function(){return arguments},parallelOptions:["parallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],parallelFunc:function(){return arguments},parallelpointOptions:["parallelpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]],parallelpointFunc:function(){return arguments},perpendicularOptions:["perpendicular",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],perpendicularFunc:function(){return arguments},perpendicularpointOptions:["perpendicularpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],perpendicularpointFunc:function(){return arguments},reflectionOptions:["reflection",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]],reflectionFunc:function(){return arguments}}),JXG.Point.prototype.setPositionX=function(e,t){var i=e==JXG.COORDS_BY_USER?this.coords.usrCoords[2]:this.coords.scrCoords[2];this.setPosition(e,[t,i])},JXG.Point.prototype.setPositionY=function(e,t){var i=e==JXG.COORDS_BY_USER?this.coords.usrCoords[1]:this.coords.scrCoords[1];this.setPosition(e,[i,t])},JXG.Ticks=function(e,t,i){if(this.constructor(e.board,i,JXG.OBJECT_TYPE_TICKS,JXG.OBJECT_CLASS_OTHER),this.line=e,this.board=this.line.board,this.ticksFunction=null,this.fixedTicks=null,this.equidistant=!1,JXG.isFunction(t))throw this.ticksFunction=t,Error("Function arguments are no longer supported.");JXG.isArray(t)?this.fixedTicks=t:(Math.abs(t)<JXG.Math.eps&&(t=i.defaultdistance),this.ticksFunction=function(){return t},this.equidistant=!0),this.minTicksDistance=i.minticksdistance,this.maxTicksDistance=i.maxticksdistance,this.labels=[],this.id=this.line.addTicks(this),this.board.setId(this,"Ti")},JXG.Ticks.prototype=new JXG.GeometryElement,JXG.extend(JXG.Ticks.prototype,{hasPoint:function(e,t){var i,n,r=this.ticks.length,o=this.board.options.precision.hasPoint;if(!this.line.visProp.scalable)return!1;if(0!=this.line.stdform[1]&&0!=this.line.stdform[2]&&this.line.type!=JXG.OBJECT_TYPE_AXIS)return!1;for(i=0;r>i;i++)if(n=this.ticks[i],n[2]&&!(0==this.line.stdform[1]&&Math.abs(n[0][0]-this.line.point1.coords.scrCoords[1])<JXG.Math.eps||0==this.line.stdform[2]&&Math.abs(n[1][0]-this.line.point1.coords.scrCoords[2])<JXG.Math.eps||!(Math.abs(n[0][0]-n[0][1])>=1||Math.abs(n[1][0]-n[1][1])>=1)))if(0==this.line.stdform[1]){if(2*o>Math.abs(t-.5*(n[1][0]+n[1][1]))&&e>n[0][0]-o&&n[0][1]+o>e)return!0}else if(0==this.line.stdform[2]&&2*o>Math.abs(e-.5*(n[0][0]+n[0][1]))&&t>n[1][0]-o&&n[1][1]+o>t)return!0;return!1},setPositionDirectly:function(e,t,i){var n,r,o=new JXG.Coords(e,t,this.board),a=new JXG.Coords(e,i,this.board),s=this.board.getBoundingBox();return this.line.visProp.scalable?(Math.abs(this.line.stdform[1])<JXG.Math.eps&&Math.abs(o.usrCoords[1]*a.usrCoords[1])>JXG.Math.eps?(n=a.usrCoords[1]/o.usrCoords[1],s[0]*=n,s[2]*=n,this.board.setBoundingBox(s,!1)):Math.abs(this.line.stdform[2])<JXG.Math.eps&&Math.abs(o.usrCoords[2]*a.usrCoords[2])>JXG.Math.eps&&(r=a.usrCoords[2]/o.usrCoords[2],s[3]*=r,s[1]*=r,this.board.setBoundingBox(s,!1)),this):this},calculateTicksCoordinates:function(){var e,t,i,n,r,o,a,s,l,c,u,d,h,p,f,g,m,b,v,y,x,C,w,k=this.line.point1,_=this.line.point2,E=k.Dist(_),T=(_.coords.usrCoords[1]-k.coords.usrCoords[1])/E,S=(_.coords.usrCoords[2]-k.coords.usrCoords[2])/E,A=k.coords.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[k.coords.usrCoords[1]+T,k.coords.usrCoords[2]+S],this.board)),P=this.equidistant?this.ticksFunction(1):1,O=5,R=0,L=0,I=2,G=-1,X=JXG.Math.eps,D=.5*this.visProp.majorheight,M=.5*this.visProp.minorheight;if(0!==this.board.canvasWidth&&0!==this.board.canvasHeight&&(this.minStyle=0>this.visProp.minorheight?"infinite":"finite",this.majStyle=0>this.visProp.majorheight?"infinite":"finite",g=this.line.visProp.straightfirst?Number.NEGATIVE_INFINITY:0+X,m=this.line.visProp.straightlast?Number.POSITIVE_INFINITY:E-X,b=this.line.stdform[1],v=this.line.stdform[2],y=b,x=v,C=b,w=v,d=Math.sqrt(b*b*this.board.unitX*this.board.unitX+v*v*this.board.unitY*this.board.unitY),b*=D/d*this.board.unitX,v*=D/d*this.board.unitY,y*=M/d*this.board.unitX,x*=M/d*this.board.unitY,this.removeTickLabels(),!(Math.abs(C)<JXG.Math.eps&&Math.abs(w)<JXG.Math.eps)))if(this.ticks=[],this.labels=[],this.equidistant){e=P,P*=this.visProp.scale,this.visProp.insertticks&&this.minTicksDistance>JXG.Math.eps&&(t=this._adjustTickDistance(P,A,O,k.coords,T,S),P*=t,e*=t),this.visProp.insertticks||(P/=this.visProp.minorticks+1,e/=this.visProp.minorticks+1),this.ticksDelta=P,this.symbTicksDelta=e,h=this.board.getBoundingBox(),R=.5*(h[0]+h[2]),L=.5*(h[1]+h[3]),p=[R*this.line.stdform[2]-L*this.line.stdform[1],-this.line.stdform[2],this.line.stdform[1]],u=JXG.Math.crossProduct(this.line.stdform,p),u[1]/=u[0],u[2]/=u[0],u[0]=1,i=new JXG.Coords(JXG.COORDS_BY_USER,u.slice(1),this.board),d=k.coords.distance(JXG.COORDS_BY_USER,i),(0>(_.X()-k.X())*(u[1]-k.X())||0>(_.Y()-k.Y())*(u[2]-k.Y()))&&(d*=-1),s=Math.round(d/P)*P,Math.abs(s)>JXG.Math.eps&&(G=Math.abs(s)/s),u[1]=k.coords.usrCoords[1]+T*s,u[2]=k.coords.usrCoords[2]+S*s,n=s,s=0,l=0,r=n/this.visProp.scale,R=u[1],L=u[2],o=0,a=0;do i=new JXG.Coords(JXG.COORDS_BY_USER,[R,L],this.board),i.major=0===Math.round((G*s+n)/P)%(this.visProp.minorticks+1),c=this._tickEndings(i,C,w,b,v,y,x,i.major),3===c.length?(f=G*l+r,(Math.abs(f)>=X||this.visProp.drawzero)&&f>g&&m>f&&(this.ticks.push(c),i.major?this.labels.push(this._makeLabel(f,i,this.board,this.visProp.drawlabels,this.id,o)):this.labels.push(null),o++),2==I&&(G*=-1),(0===a%2||1===I)&&(s+=P,l+=e)):(G*=-1,I--),a++,R=u[1]+G*T*s,L=u[2]+G*S*s;while(I>0);this.needsUpdate=!0,this.updateRenderer()}else for(o=0;this.fixedTicks.length>o;o++)R=k.coords.usrCoords[1]+this.fixedTicks[o]*T,L=k.coords.usrCoords[2]+this.fixedTicks[o]*S,i=new JXG.Coords(JXG.COORDS_BY_USER,[R,L],this.board),c=this._tickEndings(i,C,w,b,v,y,x,!0),2==c.length&&this.fixedTicks[o]>=g&&m>this.fixedTicks[o]&&this.ticks.push(c),this.labels.push(this._makeLabel(this.visProp.labels[o]||this.fixedTicks[o],i,this.board,this.visProp.drawlabels,this.id,o))},_adjustTickDistance:function(e,t,i,n,r,o){for(var a,s,l=1;t>4*this.minTicksDistance;)l/=10,a=n.usrCoords[1]+r*e*l,s=n.usrCoords[2]+o*e*l,t=n.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[a,s],this.board));for(;this.minTicksDistance>t;)l*=i,i=5==i?2:5,a=n.usrCoords[1]+r*e*l,s=n.usrCoords[2]+o*e*l,t=n.distance(JXG.COORDS_BY_SCREEN,new JXG.Coords(JXG.COORDS_BY_USER,[a,s],this.board));return l},_tickEndings:function(e,t,i,n,r,o,a,s){var l,c,u,d,h,p=this.board.canvasWidth,f=this.board.canvasHeight,g=[-1e3*p,-1e3*f],m=[-1e3*p,-1e3*f],b=0,v=!1;return l=e.scrCoords,s?(c=n,u=r,h=this.majStyle):(c=o,u=a,h=this.minStyle),Math.abs(t)<JXG.Math.eps?(g[0]=l[1],g[1]=l[1],m[0]=0,m[1]=f):Math.abs(i)<JXG.Math.eps?(g[0]=0,g[1]=p,m[0]=l[2],m[1]=l[2]):(b=0,d=JXG.Math.crossProduct([0,0,1],[-u*l[1]-c*l[2],u,c]),d[1]/=d[0],d[1]>=0&&p>=d[1]&&(g[b]=d[1],m[b]=0,b++),d=JXG.Math.crossProduct([0,1,0],[-u*l[1]-c*l[2],u,c]),d[2]/=d[0],d[2]>=0&&f>=d[2]&&(g[b]=0,m[b]=d[2],b++),2>b&&(d=JXG.Math.crossProduct([f*f,0,-f],[-u*l[1]-c*l[2],u,c]),d[1]/=d[0],d[1]>=0&&p>=d[1]&&(g[b]=d[1],m[b]=f,b++)),2>b&&(d=JXG.Math.crossProduct([p*p,-p,0],[-u*l[1]-c*l[2],u,c]),d[2]/=d[0],d[2]>=0&&f>=d[2]&&(g[b]=p,m[b]=d[2]))),v=g[0]>=0&&p>=g[0]&&m[0]>=0&&f>=m[0]||g[1]>=0&&p>=g[1]&&m[1]>=0&&f>=m[1]?!0:!1,"finite"==h&&(g[0]=l[1]+c,m[0]=l[2]-u,g[1]=l[1]-c,m[1]=l[2]+u),v?[g,m,s]:[]},_makeLabel:function(e,t,i,n,r,o){var a,s,l,c="number"==typeof e;return n?(a=""+e,Math.abs(e)<JXG.Math.eps&&(a="0"),c&&(a.length>5||-1!=a.indexOf("e"))&&(a=""+e.toPrecision(3)),c&&a.indexOf(".")>-1&&(a=a.replace(/0+$/,""),a=a.replace(/\.$/,"")),this.visProp.scalesymbol.length>0&&"1"===a?a=this.visProp.scalesymbol:this.visProp.scalesymbol.length>0&&"0"===a?a="0":a+=this.visProp.scalesymbol,l={id:r+o+"Label",isLabel:!0,layer:i.options.layer.line,highlightStrokeColor:i.options.text.strokeColor,highlightStrokeWidth:i.options.text.strokeWidth,highlightStrokeOpacity:i.options.text.strokeOpacity,visible:this.visProp.visible,priv:this.visProp.priv},l=JXG.deepCopy(l,this.visProp.label),s=JXG.createText(i,[t.usrCoords[1],t.usrCoords[2],a],l),s.isDraggable=!1,s.dump=!1,s.distanceX=this.visProp.label.offset[0],s.distanceY=this.visProp.label.offset[1],s.setCoords(t.usrCoords[1]+s.distanceX/i.unitX,t.usrCoords[2]+s.distanceY/i.unitY),s.visProp.visible=n,s):null},removeTickLabels:function(){var e;if(null!=this.labels&&(this.board.needsFullUpdate||this.needsRegularUpdate)&&("canvas"!=this.board.options.renderer||"internal"!=this.board.options.text.display))for(e=0;this.labels.length>e;e++)null!=this.labels[e]&&this.board.removeObject(this.labels[e])},update:function(){return this.needsUpdate&&this.calculateTicksCoordinates(),this},updateRenderer:function(){return this.needsUpdate&&(this.ticks&&this.board.renderer.updateTicks(this,this.dxMaj,this.dyMaj,this.dxMin,this.dyMin,this.minStyle,this.majStyle),this.needsUpdate=!1),this},hideElement:function(){var e;for(this.visProp.visible=!1,this.board.renderer.hide(this),e=0;this.labels.length>e;e++)JXG.exists(this.labels[e])&&this.labels[e].hideElement();return this},showElement:function(){var e;for(this.visProp.visible=!0,this.board.renderer.show(this),e=0;this.labels.length>e;e++)JXG.exists(this.labels[e])&&this.labels[e].showElement();return this}}),JXG.createTicks=function(e,t,i){var n,r,o=JXG.copyAttributes(i,e.options,"ticks");if(r=2>t.length?i.ticksDistance:t[1],t[0].elementClass!=JXG.OBJECT_CLASS_LINE||!(JXG.isFunction(t[1])||JXG.isArray(t[1])||JXG.isNumber(t[1])))throw Error("JSXGraph: Can't create Ticks with parent types '"+typeof t[0]+"' and '"+typeof t[1]+"'.");return n=new JXG.Ticks(t[0],r,o),n.isDraggable=!0,n},JXG.JSXGraph.registerElement("ticks",JXG.createTicks),JXG.Util={},JXG.Util.Unzip=function(e){function t(){return X+=8,L.length>I?L[I++]:-1}function i(){G=1}function n(){var e;return X++,e=1&G,G>>=1,0==G&&(G=t(),e=1&G,G=128|G>>1),e}function r(e){for(var t=0,i=e;i--;)t=t<<1|n();return e&&(t=T[t]>>8-e),t}function o(){_=0}function a(e){b++,k[_++]=e,y.push(String.fromCharCode(e)),32768==_&&(_=0)}function s(){this.b0=0,this.b1=0,this.jump=null,this.jumppos=-1}function l(){for(;;){if(H[z]>=Y)return-1;if($[H[z]]==z)return H[z]++;H[z]++}}function c(){var e,t=j[F];if(x&&document.write("<br>len:"+z+" treepos:"+F),17==z)return-1;if(F++,z++,e=l(),x&&document.write("<br>IsPat "+e),e>=0)t.b0=e,x&&document.write("<br>b0 "+t.b0);else if(t.b0=32768,x&&document.write("<br>b0 "+t.b0),c())return-1;if(e=l(),e>=0)t.b1=e,x&&document.write("<br>b1 "+t.b1),t.jump=null;else if(t.b1=32768,x&&document.write("<br>b1 "+t.b1),t.jump=j[F],t.jumppos=F,c())return-1;return z--,0}function u(e,t,i,n){var r;for(x&&document.write("currentTree "+e+" numval "+t+" lengths "+i+" show "+n),j=e,F=0,$=i,Y=t,r=0;17>r;r++)H[r]=0;if(z=0,c())return x&&alert("invalid huffman tree\n"),-1;if(x){document.write("<br>Tree: "+j.length);for(var o=0;32>o;o++)document.write("Places["+o+"].b0="+j[o].b0+"<br>"),document.write("Places["+o+"].b1="+j[o].b1+"<br>")}return 0}function d(e){for(var t,i,r,o=0,a=e[o];;)if(r=n(),x&&document.write("b="+r),r){if(!(32768&a.b1))return x&&document.write("ret1"),a.b1;for(a=a.jump,t=e.length,i=0;t>i;i++)if(e[i]===a){o=i;break}}else{if(!(32768&a.b0))return x&&document.write("ret2"),a.b0;o++,a=e[o]}return x&&document.write("ret3"),-1}function h(){var e,l,c,h,p;do{switch(e=n(),c=r(2)){case 0:x&&alert("Stored\n");break;case 1:x&&alert("Fixed Huffman codes\n");break;case 2:x&&alert("Dynamic Huffman codes\n");break;case 3:x&&alert("Reserved block type!!\n");break;default:x&&alert("Unexpected value %d!\n",c)}if(0==c){var f,g;for(i(),f=t(),f|=t()<<8,g=t(),g|=t()<<8,65535&(f^~g)&&document.write("BlockLen checksum mismatch\n");f--;)l=t(),a(l)}else if(1==c)for(var m;;)if(m=T[r(7)]>>1,m>23?(m=m<<1|n(),m>199?(m-=128,m=m<<1|n()):(m-=48,m>143&&(m+=136))):m+=256,256>m)a(m);else{if(256==m)break;var p,b;for(m-=257,p=r(A[m])+S[m],m=T[r(5)]>>3,O[m]>8?(b=r(8),b|=r(O[m]-8)<<8):b=r(O[m]),b+=P[m],m=0;p>m;m++){var l=k[32767&_-b];a(l)}}else if(2==c){var m,v,y,C,w,E=Array(320);for(y=257+r(5),C=1+r(5),w=4+r(4),m=0;19>m;m++)E[m]=0;for(m=0;w>m;m++)E[R[m]]=r(3);for(p=B.length,h=0;p>h;h++)B[h]=new s;if(u(B,19,E,0))return o(),1;if(x){document.write("<br>distanceTree");for(var L=0;B.length>L;L++)document.write("<br>"+B[L].b0+" "+B[L].b1+" "+B[L].jump+" "+B[L].jumppos)}v=y+C,h=0;var I=-1;for(x&&document.write("<br>n="+v+" bits: "+X+"<br>");v>h;)if(I++,m=d(B),x&&document.write("<br>"+I+" i:"+h+" decode: "+m+"    bits "+X+"<br>"),16>m)E[h++]=m;else if(16==m){var G;if(m=3+r(2),h+m>v)return o(),1;for(G=h?E[h-1]:0;m--;)E[h++]=G}else{if(m=17==m?3+r(3):11+r(7),h+m>v)return o(),1;for(;m--;)E[h++]=0}for(p=J.length,h=0;p>h;h++)J[h]=new s;if(u(J,y,E,0))return o(),1;for(p=J.length,h=0;p>h;h++)B[h]=new s;var D=[];for(h=y;E.length>h;h++)D[h-y]=E[h];if(u(B,C,D,0))return o(),1;for(x&&document.write("<br>literalTree");;)if(m=d(J),m>=256){var p,b;if(m-=256,0==m)break;for(m--,p=r(A[m])+S[m],m=d(B),O[m]>8?(b=r(8),b|=r(O[m]-8)<<8):b=r(O[m]),b+=P[m];p--;){var l=k[32767&_-b];a(l)}}else a(m)}}while(!e);return o(),i(),0}function p(){x&&alert("NEXTFILE"),y=[];var e=[];if(E=!1,e[0]=t(),e[1]=t(),x&&alert("type: "+e[0]+" "+e[1]),e[0]==parseInt("78",16)&&e[1]==parseInt("da",16)&&(x&&alert("GEONExT-GZIP"),h(),x&&alert(y.join("")),w[C]=Array(2),w[C][0]=y.join(""),w[C][1]="geonext.gxt",C++),e[0]==parseInt("1f",16)&&e[1]==parseInt("8b",16)&&(x&&alert("GZIP"),f(),x&&alert(y.join("")),w[C]=Array(2),w[C][0]=y.join(""),w[C][1]="file",C++),e[0]==parseInt("50",16)&&e[1]==parseInt("4b",16)&&(E=!0,e[2]=t(),e[3]=t(),e[2]==parseInt("3",16)&&e[3]==parseInt("4",16))){e[0]=t(),e[1]=t(),x&&alert("ZIP-Version: "+e[1]+" "+e[0]/10+"."+e[0]%10),g=t(),g|=t()<<8,x&&alert("gpflags: "+g);var i=t();i|=t()<<8,x&&alert("method: "+i),t(),t(),t(),t();var n=t();n|=t()<<8,n|=t()<<16,n|=t()<<24;var r=t();r|=t()<<8,r|=t()<<16,r|=t()<<24;var o=t();o|=t()<<8,o|=t()<<16,o|=t()<<24,x&&alert("local CRC: "+n+"\nlocal Size: "+o+"\nlocal CompSize: "+r);var a=t();a|=t()<<8;var s=t();for(s|=t()<<8,x&&alert("filelen "+a),c=0,M=[];a--;){var l=t();"/"==l|":"==l?c=0:D-1>c&&(M[c++]=String.fromCharCode(l))}x&&alert("nameBuf: "+M),v||(v=M);for(var c=0;s>c;)l=t(),c++;m=4294967295,b=0,(o=0)&&x&&alert("skipdir"),8==i&&(h(),x&&alert(y.join("")),w[C]=Array(2),w[C][0]=y.join(""),w[C][1]=M.join(""),C++),f()}}function f(){var e,i,n,r,o,a,s=[];if(8&g&&(s[0]=t(),s[1]=t(),s[2]=t(),s[3]=t(),s[0]==parseInt("50",16)&&s[1]==parseInt("4b",16)&&s[2]==parseInt("07",16)&&s[3]==parseInt("08",16)?(e=t(),e|=t()<<8,e|=t()<<16,e|=t()<<24):e=s[0]|s[1]<<8|s[2]<<16|s[3]<<24,i=t(),i|=t()<<8,i|=t()<<16,i|=t()<<24,n=t(),n|=t()<<8,n|=t()<<16,n|=t()<<24,x&&alert("CRC:")),E&&p(),s[0]=t(),8!=s[0])return x&&alert("Unknown compression method!"),0;if(g=t(),x&&g&~parseInt("1f",16)&&alert("Unknown flags set!"),t(),t(),t(),t(),t(),r=t(),4&g)for(s[0]=t(),s[2]=t(),z=s[0]+256*s[1],x&&alert("Extra field size: "+z),o=0;z>o;o++)t();if(8&g){for(o=0,M=[];a=t();)("7"==a||":"==a)&&(o=0),D-1>o&&(M[o++]=a);x&&alert("original file name: "+M)}if(16&g)for(;a=t(););2&g&&(t(),t()),h(),e=t(),e|=t()<<8,e|=t()<<16,e|=t()<<24,n=t(),n|=t()<<8,n|=t()<<16,n|=t()<<24,E&&p()}var g,m,b,v,y=[],x=!1,C=0,w=[],k=Array(32768),_=0,E=!1,T=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],S=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],P=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],O=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=e,I=0,G=1,X=0,D=256,M=[],N=288,J=Array(N),B=Array(32),F=0,j=null,z=(Array(64),Array(64),0),H=Array(17);H[0]=0;var $,Y;JXG.Util.Unzip.prototype.unzipFile=function(e){var t;for(this.unzip(),t=0;w.length>t;t++)if(w[t][1]==e)return w[t][0]},JXG.Util.Unzip.prototype.unzip=function(){return x&&alert(L),p(),w}},JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,i,n,r,o,a,s,l=[],c=0;for(e=JXG.Util.Base64._utf8_encode(e);e.length>c;)t=e.charCodeAt(c++),i=e.charCodeAt(c++),n=e.charCodeAt(c++),r=t>>2,o=(3&t)<<4|i>>4,a=(15&i)<<2|n>>6,s=63&n,isNaN(i)?a=s=64:isNaN(n)&&(s=64),l.push([this._keyStr.charAt(r),this._keyStr.charAt(o),this._keyStr.charAt(a),this._keyStr.charAt(s)].join(""));return l.join("")},decode:function(e,t){var i,n,r,o,a,s,l,c=[],u=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");e.length>u;)o=this._keyStr.indexOf(e.charAt(u++)),a=this._keyStr.indexOf(e.charAt(u++)),s=this._keyStr.indexOf(e.charAt(u++)),l=this._keyStr.indexOf(e.charAt(u++)),i=o<<2|a>>4,n=(15&a)<<4|s>>2,r=(3&s)<<6|l,c.push(String.fromCharCode(i)),64!=s&&c.push(String.fromCharCode(n)),64!=l&&c.push(String.fromCharCode(r));return c=c.join(""),t&&(c=JXG.Util.Base64._utf8_decode(c)),c},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",i=0;e.length>i;i++){var n=e.charCodeAt(i);128>n?t+=String.fromCharCode(n):n>127&&2048>n?(t+=String.fromCharCode(192|n>>6),t+=String.fromCharCode(128|63&n)):(t+=String.fromCharCode(224|n>>12),t+=String.fromCharCode(128|63&n>>6),t+=String.fromCharCode(128|63&n))}return t},_utf8_decode:function(e){for(var t=[],i=0,n=0,r=0,o=0;e.length>i;)n=e.charCodeAt(i),128>n?(t.push(String.fromCharCode(n)),i++):n>191&&224>n?(r=e.charCodeAt(i+1),t.push(String.fromCharCode((31&n)<<6|63&r)),i+=2):(r=e.charCodeAt(i+1),o=e.charCodeAt(i+2),t.push(String.fromCharCode((15&n)<<12|(63&r)<<6|63&o)),i+=3);return t.join("")},_destrip:function(e,t){var i,n,r=[],o=[];for(null==t&&(t=76),e.replace(/ /g,""),i=e.length/t,n=0;i>n;n++)r[n]=e.substr(n*t,t);for(i!=e.length/t&&(r[r.length]=e.substr(i*t,e.length-i*t)),n=0;r.length>n;n++)o.push(r[n]);return o.join("\n")},decodeAsArray:function(e){var t,i=this.decode(e),n=[];for(t=0;i.length>t;t++)n[t]=i.charCodeAt(t);return n},decodeGEONExT:function(e){return decodeAsArray(destrip(e),!1)}},JXG.Util.asciiCharCodeAt=function(e,t){var i=e.charCodeAt(t);if(i>255)switch(i){case 8364:i=128;break;case 8218:i=130;break;case 402:i=131;break;case 8222:i=132;break;case 8230:i=133;break;case 8224:i=134;break;case 8225:i=135;break;case 710:i=136;break;case 8240:i=137;break;case 352:i=138;break;case 8249:i=139;break;case 338:i=140;break;case 381:i=142;break;case 8216:i=145;break;case 8217:i=146;break;case 8220:i=147;break;case 8221:i=148;break;case 8226:i=149;break;case 8211:i=150;break;case 8212:i=151;break;case 732:i=152;break;case 8482:i=153;break;case 353:i=154;break;case 8250:i=155;break;case 339:i=156;break;case 382:i=158;break;case 376:i=159;break;default:}return i},JXG.Util.utf8Decode=function(e){var t,i=[],n=0,r=0,o=0;if(!JXG.exists(e))return"";for(;e.length>n;)r=e.charCodeAt(n),128>r?(i.push(String.fromCharCode(r)),n++):r>191&&224>r?(o=e.charCodeAt(n+1),i.push(String.fromCharCode((31&r)<<6|63&o)),n+=2):(o=e.charCodeAt(n+1),t=e.charCodeAt(n+2),i.push(String.fromCharCode((15&r)<<12|(63&o)<<6|63&t)),n+=3);return i.join("")},JXG.Util.genUUID=function(){for(var e,t="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=Array(36),n=0,r=0;36>r;r++)8==r||13==r||18==r||23==r?i[r]="-":14==r?i[r]="4":(2>=n&&(n=0|33554432+16777216*Math.random()),e=15&n,n>>=4,i[r]=t[19==r?8|3&e:e]);return i.join("")},JXG.PsTricks={convert:function(e){var t,i,n=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],e),r=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e.canvasWidth,e.canvasHeight],e),o=[];o.push("\\begin{pspicture*}("+n.usrCoords[1]+","+r.usrCoords[2]+")("+r.usrCoords[1]+","+n.usrCoords[2]+")\n");for(t in e.objects)if(i=e.objects[t],i.visProp.visible)switch(i.elementClass){case JXG.OBJECT_CLASS_CIRCLE:o.push(this.addCircle(i));break;case JXG.OBJECT_CLASS_LINE:o.push(this.addLine(i));break;case JXG.OBJECT_CLASS_POINT:o.push(this.addPoint(i));break;default:switch(i.type){case JXG.OBJECT_TYPE_ARC:o.push(this.addArc(i));break;case JXG.OBJECT_TYPE_SECTOR:o.push(this.addArc(i)),o.push(this.addSector(i));break;case JXG.OBJECT_TYPE_POLYGON:o.push(this.addPolygon(i));break;case JXG.OBJECT_TYPE_ANGLE:o.push(this.addAngle(i))}}return o.push("\\end{pspicture*}"),o.join("\n")},setArrows:function(e){var t="";return e.visProp.firstarrow&&e.visProp.lastarrow?t="{<->}":e.visProp.firstarrow?t="{<-}":e.visProp.lastarrow&&(t="{->}"),t},drawWedge:function(e,t,i,n,r,o){var a="";return"none"!=e&&t>0&&(a+="\\pswedge[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(e)+", opacity="+t.toFixed(5)+"]",a+="("+i.join(",")+"){"+n+"}{"+r+"}{"+o+"}\n"),a},addPoint:function(e){var t="\\psdot[linecolor="+this.parseColor(e.visProp.strokecolor)+",dotstyle=",i=e.normalizeFace(e.visProp.face)||"o",n=e.visProp.size>4?4:e.visProp.size,r=[0,0,"2pt 2","5pt 2","5pt 3"];return"x"==i?t+="x, dotsize="+r[n]:"o"==i?(t+="*, dotsize=",1==n?t+="2pt 2":2==n?t+="4pt 2":3==n?t+="6pt 2":4==n&&(t+="6pt 3")):"[]"==i?t+="square*, dotsize="+r[n]:"+"==i&&(t+="+, dotsize="+r[n]),t+="]("+e.coords.usrCoords.slice(1).join(",")+")\n",t+="\\rput("+(e.coords.usrCoords[1]+15/e.board.unitY)+","+(e.coords.usrCoords[2]+15/e.board.unitY)+"){\\small $"+e.name+"$}\n"},addLine:function(e){var t=new JXG.Coords(JXG.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),i=new JXG.Coords(JXG.COORDS_BY_USER,e.point2.coords.usrCoords,e.board),n="\\psline[linecolor="+this.parseColor(e.visProp.strokecolor)+", linewidth="+e.visProp.strokewidth+"px]";return(e.visProp.straightfirst||e.visProp.straightlast)&&JXG.Math.Geometry.calcStraight(e,t,i),n+=this.setArrows(e),n+="("+t.usrCoords.slice(1).join(",")+")("+i.usrCoords.slice(2).join(",")+")\n"},addCircle:function(e){var t=e.Radius(),i="\\pscircle[linecolor="+this.parseColor(e.visProp.strokecolor)+", linewidth="+e.visProp.strokewidth+"px";return"none"!=e.visProp.fillcolor&&0!=e.visProp.fillopacity&&(i+=", fillstyle=solid, fillcolor="+this.parseColor(e.visProp.fillcolor)+", opacity="+e.visProp.fillopacity.toFixed(5)),i+="]("+e.center.coords.usrCoords.slice(1).join("1")+"){"+t+"}\n"},addPolygon:function(e){var t,i="\\pspolygon[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(e.visProp.fillcolor)+", opacity="+e.visProp.fillopacity.toFixed(5)+"]";for(t=0;e.vertices.length>t;t++)i+="("+e.vertices[t].coords.usrCoords.slice(1).join(",")+")";return i+="\n"},addArc:function(e){var t=e.Radius(),i={coords:new JXG.Coords(JXG.COORDS_BY_USER,[e.board.canvasWidth/e.board.unitY,e.center.coords.usrCoords[2]],e.board)},n=JXG.Math.Geometry.trueAngle(i,e.center,e.point2).toFixed(4),r=JXG.Math.Geometry.trueAngle(i,e.center,e.point3).toFixed(4),o="\\psarc[linecolor="+this.parseColor(e.visProp.strokecolor)+", linewidth="+e.visProp.strokewidth+"px]";return o+=this.setArrows(e),o+="("+e.center.coords.usrCoords.slice(1).join(",")+"){"+t+"}{"+n+"}{"+r+"}\n"},addSector:function(e){var t=e.Radius(),i={coords:new JXG.Coords(JXG.COORDS_BY_USER,[e.board.canvasWidth/e.board.unitY,e.point1.coords.usrCoords[2]],e.board)},n=JXG.Math.Geometry.trueAngle(i,e.point1,e.point2).toFixed(4),r=JXG.Math.Geometry.trueAngle(i,e.point1,e.point3).toFixed(4);return this.drawWedge(e.visProp.fillcolor,e.visProp.fillopacity,e.point1.coords.usrCoords.slice(1),t,n,r)},addAngle:function(e){var t,i=e.radius,n={coords:new JXG.Coords(JXG.COORDS_BY_USER,[e.board.canvasWidth/e.board.unitY,e.point2.coords.usrCoords[2]],e.board)},r=JXG.Math.Geometry.trueAngle(n,e.point2,e.point1).toFixed(4),o=JXG.Math.Geometry.trueAngle(n,e.point2,e.point3).toFixed(4);return t=this.drawWedge(e.visProp.fillcolor,e.visProp.fillopacity,e.point2.coords.usrCoords.slice(1),i,r,o),t+="\\psarc[linecolor="+this.parseColor(e.visProp.strokecolor)+", linewidth="+e.visProp.strokewidth+"px]",t+="("+e.point2.coords.usrCoords.slice(1).join(",")+"){"+i+"}{"+r+"}{"+o+"}\n"},parseColor:function(e){var t=JXG.rgbParser(e);return"{[rgb]{"+t[0]/255+","+t[1]/255+","+t[2]/255+"}}"}},JXG.Server=function(){},JXG.Server.modules=function(){},JXG.Server.runningCalls={},JXG.Server.handleError=function(e){alert("error occured, server says: "+e.message)},JXG.Server.callServer=function(e,t,i,n){var r,o,a,s,l,c,u;n=n||!1,s="";for(u in i)s+="&"+escape(u)+"="+escape(i[u]);c=JXG.toJSON(i);do l=e+Math.floor(4096*Math.random());while(this.runningCalls[l]!==void 0);return this.runningCalls[l]={action:e},i.module!==void 0&&(this.runningCalls[l].module=i.module),r=JXG.serverBase+"JXGServer.py",o="action="+escape(e)+"&id="+l+"&dataJSON="+escape(JXG.Util.Base64.encode(c)),this.cbp=function(e){var i,n,r,o,a,s,l,c;if(i=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(e)).unzip(),JXG.isArray(i)&&i.length>0&&(i=i[0][0]),"string"==typeof i)if(n=window.JSON&&window.JSON.parse?window.JSON.parse(i):Function("return "+i)(),"error"==n.type)this.handleError(n);else if("response"==n.type){for(s=n.id,l=0;n.fields.length>l;l++)r=n.fields[l],o=r.namespace+("object"==typeof Function("return "+r.namespace)()?".":".prototype.")+r.name+" = "+r.value,Function(o)();for(l=0;n.handler.length>l;l++){for(r=n.handler[l],a=[],c=0;r.parameters.length>c;c++)a[c]='"'+r.parameters[c]+'": '+r.parameters[c];o="if(typeof JXG.Server.modules."+this.runningCalls[s].module+' == "undefined")'+"JXG.Server.modules."+this.runningCalls[s].module+" = {};",o+="JXG.Server.modules."+this.runningCalls[s].module+"."+r.name+"_cb = "+r.callback+";",o+="JXG.Server.modules."+this.runningCalls[s].module+"."+r.name+" = function ("+r.parameters.join(",")+", __JXGSERVER_CB__, __JXGSERVER_SYNC) {"+'if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[s].module+"."+r.name+"_cb;"+"var __JXGSERVER_PAR__ = {"+a.join(",")+', "module": "'+this.runningCalls[s].module+'", "handler": "'+r.name+'" };'+'JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__, __JXGSERVER_SYNC);'+"};",Function(o)()}delete this.runningCalls[s],t(n.data)}},this.cb=JXG.bind(this.cbp,this),window.XMLHttpRequest?(a=new XMLHttpRequest,a.overrideMimeType("text/plain; charset=iso-8859-1")):a=new ActiveXObject("Microsoft.XMLHTTP"),a?(a.open("POST",r,!n),a.setRequestHeader("Content-type","application/x-www-form-urlencoded"),n||(a.onreadystatechange=function(e){return function(){switch(a.readyState){case 4:200==a.status&&e(a.responseText);break;default:return!1}}}(this.cb)),a.send(o),n&&this.cb(a.responseText),void 0):!1},JXG.Server.loadModule_cb=function(e){var t;for(t=0;e.length>t;t++)alert(e[t].name+": "+e[t].value)},JXG.Server.loadModule=function(e){return JXG.Server.callServer("load",JXG.Server.loadModule_cb,{module:e},!0)},JXG.Server.load=JXG.Server.loadModule,JXG.DataSource=function(){return this.data=[],this.columnHeaders=[],this.rowHeaders=[],this},JXG.extend(JXG.DataSource.prototype,{loadFromArray:function(e,t,i){var n,r,o;if(t===void 0&&(t=!1),i===void 0&&(i=!1),JXG.isArray(t)&&(this.columnHeaders=t,t=!1),JXG.isArray(i)&&(this.rowHeaders=i,i=!1),this.data=[],t&&(this.columnHeaders=[]),i&&(this.rowHeaders=[]),e!==void 0){for(this.data=Array(e.length),n=0;e.length>n;n++)for(this.data[n]=Array(e[n].length),r=0;e[n].length>r;r++)o=e[n][r],this.data[n][r]=""+parseFloat(o)==o?parseFloat(o):"-"!=o?o:0/0;if(t&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),i)for(this.rowHeaders=[],n=0;this.data.length>n;n++)this.rowHeaders.push(this.data[n][0]),this.data[n]=this.data[n].slice(1)}return this},loadFromTable:function(e,t,i){var n,r,o,a,s;if(t===void 0&&(t=!1),i===void 0&&(i=!1),JXG.isArray(t)&&(this.columnHeaders=t,t=!1),JXG.isArray(i)&&(this.rowHeaders=i,i=!1),this.data=[],t&&(this.columnHeaders=[]),i&&(this.rowHeaders=[]),e=document.getElementById(e),e!==void 0){for(n=e.getElementsByTagName("tr"),this.data=Array(n.length),r=0;n.length>r;r++)for(a=n[r].getElementsByTagName("td"),this.data[r]=Array(a.length),o=0;a.length>o;o++)s=a[o].innerHTML,this.data[r][o]=""+parseFloat(s)==s?parseFloat(s):"-"!=s?s:0/0;if(t&&(this.columnHeaders=this.data[0].slice(1),this.data=this.data.slice(1)),i)for(this.rowHeaders=[],r=0;this.data.length>r;r++)this.rowHeaders.push(this.data[r][0]),this.data[r]=this.data[r].slice(1)}return this},addColumn:function(){},addRow:function(){},getColumn:function(e){var t,i=Array(this.data.length);if("string"==typeof e)for(t=0;this.columnHeaders.length>t;t++)if(e==this.columnHeaders[t]){e=t;break}for(t=0;this.data.length>t;t++)this.data[t].length>e&&(i[t]=parseFloat(this.data[t][e]));return i},getRow:function(e){var t,i;if("string"==typeof e)for(i=0;this.rowHeaders.length>i;i++)if(e==this.rowHeaders[i]){e=i;break}for(t=Array(this.data[e].length),i=0;this.data[e].length>i;i++)t[i]=this.data[e][i];return t}}),JXG.JessieCode=function(e){this.sstack=[{}],this.scope=0,this.pstack=[[]],this.dpstack=[[]],this.pscope=0,this.propstack=[{}],this.propscope=0,this.propobj=0,this.lhs=[],this.isLHS=!1,this.warnLog="jcwarn",this.builtIn=this.defineBuiltIn(),this.board=null,this.lineToElement={},this.countLines=!0,this.parCurLine=1,this.parCurColumn=0,this.line=1,this.col=1,this.code="","string"==typeof e&&this.parse(e)},JXG.extend(JXG.JessieCode.prototype,{node:function(e,t,i){return{type:e,value:t,children:i}},createNode:function(e,t){var i,n=this.node(e,t,[]);for(i=2;arguments.length>i;i++)n.children.push(arguments[i]);return n.line=this.parCurLine,n.col=this.parCurColumn,n},getElementById:function(e){return this.board.objects[e]},creator:function(){var e,t={};return e=function(e){var i;return"function"==typeof t[this.board.id+e]?t[this.board.id+e]:(i=function(t){return function(i,n){var r;return r=JXG.exists(n)?n:{name:0!==t.lhs[t.scope]?t.lhs[t.scope]:""},t.board.create(e,i,r)}}(this),i.creator=!0,t[this.board.id+e]=i,i)
},e.clearCache=function(){t={}},e}(),letvar:function(e,t){this.builtIn[e]&&this._warn('"'+e+'" is a predefined value.'),this.sstack[this.scope][e]=t},isLocalVariable:function(e){var t;for(t=this.scope;t>-1;t--)if(JXG.exists(this.sstack[t][e]))return t;return-1},isCreator:function(e){return!!JXG.JSXGraph.elements[e]},isMathMethod:function(e){return"E"!==e&&!!Math[e]},isBuiltIn:function(e){return!!this.builtIn[e]},getvar:function(e,t){var i,n;return t=JXG.def(t,!1),i=this.isLocalVariable(e),i>-1?this.sstack[i][e]:this.isCreator(e)?this.creator(e):this.isMathMethod(e)?Math[e]:this.isBuiltIn(e)?this.builtIn[e]:t||(i=JXG.getRef(this.board,e),i===e)?n:i},getvarJS:function(e,t,i){var n;if(t=JXG.def(t,!1),i=JXG.def(i,!1),JXG.indexOf(this.pstack[this.pscope],e)>-1)return e;if(n=this.isLocalVariable(e),n>-1&&!i)return"$jc$.sstack["+n+"]['"+e+"']";if(this.isCreator(e))return"(function () { var a = Array.prototype.slice.call(arguments, 0), props = "+(i?"a.pop()":"{}")+"; return $jc$.board.create.apply($jc$.board, ['"+e+"'].concat([a, props])); })";if(i&&this._error("Syntax error (attribute values are allowed with element creators only)"),this.isMathMethod(e))return"Math."+e;if(this.isBuiltIn(e))return this.builtIn[e].src||this.builtIn[e];if(!t){if(JXG.isId(this.board,e))return"$jc$.board.objects['"+e+"']";if(JXG.isName(this.board,e))return"$jc$.board.elementsByName['"+e+"']";if(JXG.isGroup(this.board,e))return"$jc$.board.groups['"+e+"']"}return""},mergeAttributes:function(){var e,t={};for(e=0;arguments.length>e;e++)t=JXG.deepCopy(t,arguments[e],!0);return t},setProp:function(e,t,i){var n,r,o={};e.elementClass!==JXG.OBJECT_CLASS_POINT||"X"!==t&&"Y"!==t?e.type!==JXG.OBJECT_TYPE_TEXT||"X"!==t&&"Y"!==t?e.type&&e.elementClass&&e.visProp?(o[t]=i,e.setProperty(o)):e[t]=i:("number"==typeof i?e[t]=function(){return i}:"function"==typeof i?(e.isDraggable=!1,e[t]=i):"string"==typeof i&&(e.isDraggable=!1,e[t]=JXG.createFunction(i,this.board,null,!0),e[t+"jc"]=i),e[t].origin=i,this.board.update()):(t=t.toLowerCase(),e.isDraggable&&"number"==typeof i?(n="x"===t?i:e.X(),r="y"===t?i:e.Y(),e.setPosition(JXG.COORDS_BY_USER,[n,r])):!e.isDraggable||"function"!=typeof i&&"string"!=typeof i?e.isDraggable||(n="x"===t?i:e.XEval.origin,r="y"===t?i:e.YEval.origin,e.addConstraint([n,r])):(n="x"===t?i:e.coords.usrCoords[1],r="y"===t?i:e.coords.usrCoords[2],e.addConstraint([n,r])),this.board.update())},utf8_encode:function(e){var t,i,n=[];for(t=0;e.length>t;t++)i=e.charCodeAt(t),128>i?n.push(String.fromCharCode(i)):n.push("&#x"+i.toString(16)+";");return n.join("")},parse:function(e,t,i){var n,r,o,a=0,s=[],l=[],c=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Factorial","Floor","Log","Max","Min","Random","Round","Sin","Sqrt","Tan","Trunc","If","Deg","Rad","Dist"],u=JXG.Text.prototype.setText,d=e.replace(/\r\n/g,"\n").split("\n"),h=[];i||(this.code+=e+"\n"),JXG.Text.prototype.setText=JXG.Text.prototype.setTextJessieCode;try{for(JXG.exists(t)||(t=!1),r=0;d.length>r;r++)if("/"!==JXG.trim(d[r])[0]||"/"!==JXG.trim(d[r])[1]){if(t)for(o=0;c.length>o;o++)n=RegExp(c[o]+"\\(","g"),d[r]=d[r].replace(n,c[o].toLowerCase()+"(");h.push(d[r])}else h.push("");if(e=h.join("\n"),e=this.utf8_encode(e),(a=this._parse(e,s,l))>0)for(r=0;a>r;r++)this.line=s[r].line,this._error("Parse error in line "+s[r].line+" near >"+e.substr(s[r].offset,30)+'<, expecting "'+l[r].join()+'"')}catch(p){throw JXG.Text.prototype.setText=u,p}JXG.Text.prototype.setText=u},snippet:function(e,t,i,n){var r,o,a,s;return r="jxg__tmp__intern_"+JXG.Util.genUUID().replace(/\-/g,""),JXG.exists(t)||(t=!0),JXG.exists(i)||(i=""),JXG.exists(n)||(n=!1),a=this.sstack[0][r],this.countLines=!1,o=r+" = "+(t?" function ("+i+") { return ":"")+e+(t?"; }":"")+";",this.parse(o,n,!0),s=this.sstack[0][r],JXG.exists(a)?this.sstack[0][r]=a:delete this.sstack[0][r],this.countLines=!0,s},replaceIDs:function(e){var t,i;if(e.replaced&&(i=this.board.objects[e.children[1].children[0].value],JXG.exists(i)&&JXG.exists(i)&&""!==i.name&&(e.type="node_var",e.value=i.name,e.children.length=0,delete e.replaced)),e.children)for(t=e.children.length;t>0;t--)JXG.exists(e.children[t-1])&&(e.children[t-1]=this.replaceIDs(e.children[t-1]));return e},replaceNames:function(e){var t,i;if(i=e.value,"node_op"==e.type&&"op_lhs"==i&&1===e.children.length?this.isLHS=!0:"node_var"==e.type&&(this.isLHS?this.letvar(i,!0):!JXG.exists(this.getvar(i,!0))&&JXG.exists(this.board.elementsByName[i])&&(e=this.createReplacementNode(e))),e.children)for(t=e.children.length;t>0;t--)JXG.exists(e.children[t-1])&&(e.children[t-1]=this.replaceNames(e.children[t-1]));return"node_op"==e.type&&"op_lhs"==e.value&&1===e.children.length&&(this.isLHS=!1),e},createReplacementNode:function(e){var t=e.value,i=this.board.elementsByName[t];return e=this.createNode("node_op","op_execfun",this.createNode("node_var","$"),this.createNode("node_op","op_param",this.createNode("node_str",i.id))),e.replaced=!0,e},collectDependencies:function(e,t){var i,n,r;if(n=e.value,"node_var"==e.type&&(r=this.getvar(n),r&&r.visProp&&r.type&&r.elementClass&&r.id&&(t[r.id]=r)),"node_op"==e.type&&"op_execfun"==e.value&&e.children.length>1&&"$"==e.children[0].value&&e.children[1].children.length>0&&(r=e.children[1].children[0].value,t[r]=this.board.objects[r]),e.children)for(i=e.children.length;i>0;i--)JXG.exists(e.children[i-1])&&this.collectDependencies(e.children[i-1],t)},resolveProperty:function(e,t,i){return i=JXG.def(i,!1),e&&e.methodMap&&("label"===t?(e=e.label,t="content"):JXG.exists(e.subs)&&JXG.exists(e.subs[t])?e=e.subs:JXG.exists(e.methodMap[t])?t=e.methodMap[t]:(e=e.visProp,t=t.toLowerCase())),JXG.exists(e)||this._error(e+" is not an object"),JXG.exists(e[t])||this._error("unknown property "+t),i&&"function"==typeof e[t]?function(){return e[t].apply(e,arguments)}:e[t]},execute:function(node){var ret,v,i,e,parents=[];if(ret=0,!node)return ret;switch(this.line=node.line,this.col=node.col,node.type){case"node_op":switch(node.value){case"op_none":node.children[0]&&this.execute(node.children[0]),node.children[1]&&(ret=this.execute(node.children[1]));break;case"op_assign":v=this.execute(node.children[0]),this.lhs[this.scope]=v[1],v[0].type&&v[0].elementClass&&v[0].methodMap&&"label"===v[1]&&this._error("Left-hand side of assignment is read-only."),v[0]!==this.sstack[this.scope]||JXG.isArray(v[0])&&"number"==typeof v[1]?this.setProp(v[0],v[1],this.execute(node.children[1])):this.letvar(v[1],this.execute(node.children[1])),this.lhs[this.scope]=0;break;case"op_noassign":ret=this.execute(node.children[0]);break;case"op_if":this.execute(node.children[0])&&(ret=this.execute(node.children[1]));break;case"op_if_else":ret=this.execute(node.children[0])?this.execute(node.children[1]):this.execute(node.children[2]);break;case"op_while":for(;this.execute(node.children[0]);)this.execute(node.children[1]);break;case"op_do":do this.execute(node.children[0]);while(this.execute(node.children[1]));break;case"op_for":for(this.execute(node.children[0]);this.execute(node.children[1]);this.execute(node.children[2]))this.execute(node.children[3]);break;case"op_param":node.children[1]&&this.execute(node.children[1]),ret=node.children[0],this.pstack[this.pscope].push(ret),this.dpstack[this.pscope]&&this.dpstack[this.pscope].push({line:node.children[0].line,col:node.children[0].col});break;case"op_paramdef":node.children[1]&&this.execute(node.children[1]),ret=node.children[0],this.pstack[this.pscope].push(ret);break;case"op_proplst":node.children[0]&&this.execute(node.children[0]),node.children[1]&&this.execute(node.children[1]);break;case"op_proplst_val":this.propstack.push({}),this.propscope++,this.execute(node.children[0]),ret=this.propstack[this.propscope],this.propstack.pop(),this.propscope--;break;case"op_prop":this.propstack[this.propscope][node.children[0]]=this.execute(node.children[1]);break;case"op_array":var l;for(this.pstack.push([]),this.pscope++,this.execute(node.children[0]),ret=[],l=this.pstack[this.pscope].length,i=0;l>i;i++)ret.push(this.execute(this.pstack[this.pscope][i]));this.pstack.pop(),this.pscope--;break;case"op_extvalue":var undef;ret=this.execute(node.children[0]),i=this.execute(node.children[1]),ret="number"==typeof i&&Math.abs(Math.round(i)-i)<JXG.Math.eps?ret[i]:undef;break;case"op_return":if(0!==this.scope)return this.execute(node.children[0]);this._error("Unexpected return.");break;case"op_function":if(this.pstack.push([]),this.pscope++,this.execute(node.children[0]),this.board.options.jc.compile){for(this.sstack.push({}),this.scope++,this.isLHS=!1,i=0;this.pstack[this.pscope].length>i;i++)this.sstack[this.scope][this.pstack[this.pscope][i]]=this.pstack[this.pscope][i];this.replaceNames(node.children[1]),ret=function($jc$){var p=$jc$.pstack[$jc$.pscope].join(", "),str="var f = function ("+p+") {\n$jc$.sstack.push([]);\n$jc$.scope++;\nvar r = (function () {\n"+$jc$.compile(node.children[1],!0)+"})();\n$jc$.sstack.pop();\n$jc$.scope--;\nreturn r;\n}; f;";try{return eval(str)}catch(e){throw e}}(this),this.sstack.pop(),this.scope--}else ret=function(e,t){return function(){var i;for(t.sstack.push({}),t.scope++,i=0;e.length>i;i++)t.sstack[t.scope][e[i]]=arguments[i];return i=t.execute(node.children[1]),t.sstack.pop(),t.scope--,i}}(this.pstack[this.pscope],this);ret.node=node,ret.toJS=ret.toString,ret.toString=function(e){return function(){return e.compile(e.replaceIDs(JXG.deepCopy(node)))}}(this),ret.deps={},this.collectDependencies(node.children[1],ret.deps),this.pstack.pop(),this.pscope--;break;case"op_execfun":var fun,attr,sc;if(this.pstack.push([]),this.dpstack.push([]),this.pscope++,this.execute(node.children[1]),node.children[2]!==void 0)if(node.children[3]){for(this.pstack.push([]),this.dpstack.push([]),this.pscope++,this.execute(node.children[2]),attr={},i=0;this.pstack[this.pscope].length>i;i++)attr=JXG.deepCopy(attr,this.execute(this.pstack[this.pscope][i]),!0);this.pscope--,this.pstack.pop(),this.dpstack.pop()}else attr=this.execute(node.children[2]);for(fun=this.execute(node.children[0]),sc=fun&&fun.sc?fun.sc:this,!fun.creator&&node.children[2]!==void 0&&this._error("Unexpected value. Only element creators are allowed to have a value after the function call."),i=0;this.pstack[this.pscope].length>i;i++)parents[i]=this.execute(this.pstack[this.pscope][i]);if("function"!=typeof fun||fun.creator)if("function"==typeof fun&&fun.creator){e=this.line;try{for(ret=fun(parents,attr),ret.jcLineStart=e,ret.jcLineEnd=node.line,i=e;node.line>=i;i++)this.lineToElement[i]=ret;ret.debugParents=this.dpstack[this.pscope]}catch(ex){this._error(""+ex,e)}}else this._error("Function '"+fun+"' is undefined.");else ret=fun.apply(sc,parents);this.pstack.pop(),this.dpstack.pop(),this.pscope--;break;case"op_property":e=this.execute(node.children[0]),v=node.children[1],ret=this.resolveProperty(e,v,!1),JXG.exists(ret)&&(ret.sc=e);break;case"op_lhs":v=node.children[0],v.children&&v.type&&v.value&&(v=this.execute(v)),1===node.children.length?e=this.sstack[this.scope]:(e=this.execute(node.children[1]),e.type&&e.elementClass&&v.toLowerCase&&"x"!==v.toLowerCase()&&"y"!==v.toLowerCase()&&(v=v.toLowerCase())),ret=[e,v];break;case"op_use":var found=!1;for(var b in JXG.JSXGraph.boards)JXG.JSXGraph.boards[b].container===""+node.children[0]&&(this.use(JXG.JSXGraph.boards[b]),found=!0);found||this._error("Board '"+(""+node.children[0])+"' not found!");break;case"op_delete":v=this.getvar(node.children[0]),"object"==typeof v&&JXG.exists(v.type)&&JXG.exists(v.elementClass)&&this.board.removeObject(v);break;case"op_equ":ret=this.execute(node.children[0])==this.execute(node.children[1]);break;case"op_neq":ret=this.execute(node.children[0])!=this.execute(node.children[1]);break;case"op_approx":ret=Math.abs(this.execute(node.children[0])-this.execute(node.children[1]))<JXG.Math.eps;break;case"op_grt":ret=this.execute(node.children[0])>this.execute(node.children[1]);break;case"op_lot":ret=this.execute(node.children[0])<this.execute(node.children[1]);break;case"op_gre":ret=this.execute(node.children[0])>=this.execute(node.children[1]);break;case"op_loe":ret=this.execute(node.children[0])<=this.execute(node.children[1]);break;case"op_or":ret=this.execute(node.children[0])||this.execute(node.children[1]);break;case"op_and":ret=this.execute(node.children[0])&&this.execute(node.children[1]);break;case"op_not":ret=!this.execute(node.children[0]);break;case"op_add":ret=JXG.Math.Statistics.add(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_sub":ret=JXG.Math.Statistics.subtract(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_div":ret=JXG.Math.Statistics.div(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_mod":ret=JXG.Math.Statistics.mod(this.execute(node.children[0]),this.execute(node.children[1]),!0);break;case"op_mul":ret=this.mul(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_exp":ret=Math.pow(this.execute(node.children[0]),this.execute(node.children[1]));break;case"op_neg":ret=-1*this.execute(node.children[0])}break;case"node_var":ret=this.getvar(node.value);break;case"node_const":ret=Number(node.value);break;case"node_const_bool":ret="false"!==node.value.toLowerCase();break;case"node_str":ret=node.value}return ret},compile:function(e,t){var i,n;if(i="",JXG.exists(t)||(t=!1),!e)return i;switch(e.type){case"node_op":switch(e.value){case"op_none":e.children[0]&&(i=this.compile(e.children[0],t)),e.children[1]&&(i+=this.compile(e.children[1],t));break;case"op_assign":n=this.compile(e.children[0],t),t?JXG.isArray(n)?i="$jc$.setProp("+n[0]+", '"+n[1]+"', "+this.compile(e.children[1],t)+");\n":(this.isLocalVariable(n)!==this.scope&&(this.sstack[this.scope][n]=!0),i="$jc$.sstack["+this.scope+"]['"+n+"'] = "+this.compile(e.children[1],t)+";\n"):i=n+" = "+this.compile(e.children[1],t)+";\n";break;case"op_noassign":i=this.compile(e.children[0],t)+";\n";break;case"op_if":i=" if ("+this.compile(e.children[0],t)+") "+this.compile(e.children[1],t);break;case"op_if_else":i=" if ("+this.compile(e.children[0],t)+")"+this.compile(e.children[1],t),i+=" else "+this.compile(e.children[2],t);break;case"op_while":i=" while ("+this.compile(e.children[0],t)+") {\n"+this.compile(e.children[1],t)+"}\n";break;case"op_do":i=" do {\n"+this.compile(e.children[0],t)+"} while ("+this.compile(e.children[1],t)+");\n";break;case"op_for":i=" for ("+this.compile(e.children[0],t)+"; "+this.compile(e.children[1],t)+"; "+this.compile(e.children[2],t)+") {\n"+this.compile(e.children[3],t)+"\n}\n";break;case"op_param":e.children[1]&&(i=this.compile(e.children[1],t)+", "),i+=this.compile(e.children[0],t);break;case"op_paramdef":e.children[1]&&(i=this.compile(e.children[1],t)+", "),i+=e.children[0];break;case"op_proplst":e.children[0]&&(i=this.compile(e.children[0],t)+", "),i+=this.compile(e.children[1],t);break;case"op_prop":i=e.children[0]+": "+this.compile(e.children[1],t);break;case"op_proplst_val":i=this.compile(e.children[0],t);break;case"op_array":i="["+this.compile(e.children[0],t)+"]";break;case"op_extvalue":i=this.compile(e.children[0],t)+"["+this.compile(e.children[1],t)+"]";break;case"op_return":i=" return "+this.compile(e.children[0],t)+";\n";break;case"op_function":i=" function ("+this.compile(e.children[0],t)+") {\n"+this.compile(e.children[1],t)+"}";break;case"op_execfun":e.children[2]&&(n=this.compile(e.children[2],t),t&&(n="$jc$.mergeAttributes("+n+")")),e.children[0].withProps=!!e.children[2],i=this.compile(e.children[0],t)+"("+this.compile(e.children[1],t)+(e.children[2]&&t?", "+n:"")+")"+(e.children[2]&&!t?n:""),t&&"$"===e.children[0].value&&(i="$jc$.board.objects["+this.compile(e.children[1],t)+"]");break;case"op_property":i=t&&"X"!==e.children[1]&&"Y"!==e.children[1]?"$jc$.resolveProperty("+this.compile(e.children[0],t)+", '"+e.children[1]+"', true)":this.compile(e.children[0],t)+"."+e.children[1];break;case"op_lhs":1===e.children.length?i=e.children[0]:"dot"===e.children[2]?i=t?[this.compile(e.children[1],t),e.children[0]]:this.compile(e.children[1],t)+"."+e.children[0]:"bracket"===e.children[2]&&(i=t?[this.compile(e.children[1],t),this.compile(e.children[0],t)]:this.compile(e.children[1],t)+"["+this.compile(e.children[0],t)+"]");break;case"op_use":i=t?"$jc$.use(JXG.JSXGraph.boards['"+e.children[0]+"'])":"use "+e.children[0]+";";break;case"op_delete":i="delete "+e.children[0];break;case"op_equ":i="("+this.compile(e.children[0],t)+" == "+this.compile(e.children[1],t)+")";break;case"op_neq":i="("+this.compile(e.children[0],t)+" != "+this.compile(e.children[1],t)+")";break;case"op_approx":i="("+this.compile(e.children[0],t)+" ~= "+this.compile(e.children[1],t)+")";break;case"op_grt":i="("+this.compile(e.children[0],t)+" > "+this.compile(e.children[1],t)+")";break;case"op_lot":i="("+this.compile(e.children[0],t)+" < "+this.compile(e.children[1],t)+")";break;case"op_gre":i="("+this.compile(e.children[0],t)+" >= "+this.compile(e.children[1],t)+")";break;case"op_loe":i="("+this.compile(e.children[0],t)+" <= "+this.compile(e.children[1],t)+")";break;case"op_or":i="("+this.compile(e.children[0],t)+" || "+this.compile(e.children[1],t)+")";break;case"op_and":i="("+this.compile(e.children[0],t)+" && "+this.compile(e.children[1],t)+")";break;case"op_not":i="!("+this.compile(e.children[0],t)+")";break;case"op_add":i=t?"JXG.Math.Statistics.add("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+")":"("+this.compile(e.children[0],t)+" + "+this.compile(e.children[1],t)+")";break;case"op_sub":i=t?"JXG.Math.Statistics.subtract("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+")":"("+this.compile(e.children[0],t)+" - "+this.compile(e.children[1],t)+")";break;case"op_div":i=t?"JXG.Math.Statistics.div("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+")":"("+this.compile(e.children[0],t)+" / "+this.compile(e.children[1],t)+")";break;case"op_mod":i=t?"JXG.Math.mod("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+", true)":"("+this.compile(e.children[0],t)+" % "+this.compile(e.children[1],t)+")";break;case"op_mul":i=t?"$jc$.mul("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+")":"("+this.compile(e.children[0],t)+" * "+this.compile(e.children[1],t)+")";break;case"op_exp":i=t?"Math.pow("+this.compile(e.children[0],t)+", "+this.compile(e.children[1],t)+")":"("+this.compile(e.children[0],t)+"^"+this.compile(e.children[1],t)+")";break;case"op_neg":i="(-"+this.compile(e.children[0],t)+")"}break;case"node_var":i=t?this.getvarJS(e.value,!1,e.withProps):e.value;break;case"node_const":i=e.value;break;case"node_const_bool":i=e.value;break;case"node_str":i="'"+e.value.replace(/'/g,"\\'")+"'"}return e.needsBrackets&&(i="{\n"+i+"}\n"),i},X:function(e){return e.X()},Y:function(e){return e.Y()},V:function(e){return e.Value()},L:function(e){return e.L()},dist:function(e,t){return(!JXG.exists(e)||!JXG.exists(e.Dist))&&this._error("Error: Can't calculate distance."),e.Dist(t)},mul:function(e,t){return JXG.isArray(e)*JXG.isArray(t)?JXG.Math.innerProduct(e,t,Math.min(e.length,t.length)):JXG.Math.Statistics.multiply(e,t)},use:function(e){this.board=e,this.builtIn.$board=e,this.builtIn.$board.src="$jc$.board"},findSymbol:function(e,t){var i,n;for(t=JXG.def(t,-1),-1===t&&(t=this.scope),i=t;i>=0;i--)for(n in this.sstack[i])if(this.sstack[i][n]===e)return[n,i];return[]},defineBuiltIn:function(){var e=this,t={PI:Math.PI,EULER:Math.E,X:e.X,Y:e.Y,V:e.V,L:e.L,dist:e.dist,rad:JXG.Math.Geometry.rad,deg:JXG.Math.Geometry.trueAngle,factorial:JXG.Math.factorial,trunc:JXG.trunc,$:e.getElementById,$board:e.board};return t.rad.sc=JXG.Math.Geometry,t.deg.sc=JXG.Math.Geometry,t.factorial.sc=JXG.Math,t.PI.src="Math.PI",t.EULER.src="Math.E",t.X.src="$jc$.X",t.Y.src="$jc$.Y",t.V.src="$jc$.V",t.L.src="$jc$.L",t.dist.src="$jc$.dist",t.rad.src="JXG.Math.Geometry.rad",t.deg.src="JXG.Math.Geometry.trueAngle",t.factorial.src="JXG.Math.factorial",t.trunc.src="JXG.trunc",t.$.src="(function (n) { return JXG.getRef($jc$.board, n); })",t.$board&&(t.$board.src="$jc$.board"),t},_debug:function(e){"undefined"!=typeof console?console.log(e):document&&null!==document.getElementById("debug")&&(document.getElementById("debug").innerHTML+=e+"<br />")},_error:function(e){var t=Error("Error("+this.line+"): "+e);throw t.line=this.line,t},_warn:function(e){"undefined"!=typeof console?console.log("Warning("+this.line+"): "+e):document&&null!==document.getElementById(this.warnLog)&&(document.getElementById(this.warnLog).innerHTML+="Warning("+this.line+"): "+e+"<br />")},_log:function(e){"undefined"==typeof window&&"undefined"!=typeof self&&self.postMessage?self.postMessage({type:"log",msg:"Log: "+(""+e)}):console.log("Log: ",arguments)}}),JXG.extend(JXG.JessieCode.prototype,{_lex:function(e){for(var t,i,n,r=-1,o=0,a=0;;){t=0,r=-1,o=0,a=0,i=e.offset+1+(o-a);do{if(i--,t=0,r=-2,a=i,a>=e.src.length)return 68;do{switch(n=e.src.charCodeAt(i),t){case 0:t=n>=9&&10>=n||13==n||32==n?1:33==n?2:35==n?3:36==n||n>=65&&67>=n||n>=71&&72>=n||n>=74&&77>=n||n>=79&&81>=n||83==n||86==n||n>=88&&90>=n||95==n||n>=97&&99>=n||n>=103&&104>=n||n>=106&&113>=n||115==n||118==n||n>=120&&122>=n?4:37==n?5:40==n?6:41==n?7:42==n?8:43==n?9:44==n?10:45==n?11:46==n?12:47==n?13:n>=48&&57>=n?14:58==n?15:59==n?16:60==n?17:61==n?18:62==n?19:91==n?20:93==n?21:94==n?22:123==n?23:124==n?24:125==n?25:38==n?49:68==n||100==n?50:39==n?52:73==n||105==n?53:126==n?54:70==n||102==n?66:78==n?67:85==n||117==n?68:69==n||101==n?76:84==n||116==n?77:87==n||119==n?83:82==n||114==n?87:-1;break;case 1:t=-1,r=2,o=i;break;case 2:t=61==n?26:-1,r=31,o=i;break;case 3:t=-1,r=41,o=i;break;case 4:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=46,o=i;break;case 5:t=-1,r=35,o=i;break;case 6:t=-1,r=38,o=i;break;case 7:t=-1,r=39,o=i;break;case 8:t=-1,r=36,o=i;break;case 9:t=-1,r=32,o=i;break;case 10:t=-1,r=40,o=i;break;case 11:t=-1,r=33,o=i;break;case 12:t=n>=48&&57>=n?29:-1,r=44,o=i;break;case 13:t=-1,r=34,o=i;break;case 14:t=n>=48&&57>=n?14:46==n?29:-1,r=48,o=i;break;case 15:t=-1,r=42,o=i;break;case 16:t=-1,r=20,o=i;break;case 17:t=60==n?30:61==n?31:-1,r=28,o=i;break;case 18:t=61==n?32:-1,r=21,o=i;break;case 19:t=61==n?33:62==n?34:-1,r=27,o=i;break;case 20:t=-1,r=16,o=i;break;case 21:t=-1,r=17,o=i;break;case 22:t=-1,r=37,o=i;break;case 23:t=-1,r=18,o=i;break;case 24:t=124==n?37:-1,r=43,o=i;break;case 25:t=-1,r=19,o=i;break;case 26:t=-1,r=23,o=i;break;case 27:t=-1,r=30,o=i;break;case 28:t=-1,r=47,o=i;break;case 29:t=n>=48&&57>=n?29:-1,r=49,o=i;break;case 30:t=-1,r=14,o=i;break;case 31:t=-1,r=25,o=i;break;case 32:t=-1,r=22,o=i;break;case 33:t=-1,r=26,o=i;break;case 34:t=-1,r=15,o=i;break;case 35:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=6,o=i;break;case 36:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=3,o=i;break;case 37:t=-1,r=29,o=i;break;case 38:t=-1,r=24,o=i;break;case 39:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=7,o=i;break;case 40:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=45,o=i;break;case 41:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=9,o=i;break;case 42:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=4,o=i;break;case 43:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=12,o=i;break;case 44:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=13,o=i;break;case 45:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=5,o=i;break;case 46:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=11,o=i;break;case 47:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=10,o=i;break;case 48:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=97&&122>=n?4:-1,r=8,o=i;break;case 49:t=38==n?27:-1;break;case 50:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&78>=n||n>=80&&90>=n||95==n||n>=97&&100>=n||n>=102&&110>=n||n>=112&&122>=n?4:79==n||111==n?35:69==n||101==n?84:-1,r=46,o=i;break;case 51:t=39==n?28:n>=0&&38>=n||n>=40&&91>=n||n>=93&&254>=n?52:92==n?56:-1,r=47,o=i;break;case 52:t=39==n?28:n>=0&&38>=n||n>=40&&91>=n||n>=93&&254>=n?52:92==n?56:-1;break;case 53:t=n>=48&&57>=n||n>=65&&69>=n||n>=71&&90>=n||95==n||n>=97&&101>=n||n>=103&&122>=n?4:70==n||102==n?36:-1,r=46,o=i;break;case 54:t=61==n?38:-1;break;case 55:t=n>=48&&57>=n||n>=65&&81>=n||n>=83&&90>=n||95==n||n>=97&&113>=n||n>=115&&122>=n?4:82==n||114==n?39:-1,r=46,o=i;break;case 56:t=39==n?51:n>=0&&38>=n||n>=40&&91>=n||n>=93&&254>=n?52:92==n?56:-1;break;case 57:t=n>=48&&57>=n||n>=65&&77>=n||n>=79&&90>=n||95==n||n>=97&&122>=n?4:78==n?40:-1,r=46,o=i;break;case 58:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?41:-1,r=46,o=i;break;case 59:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?42:-1,r=46,o=i;break;case 60:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?43:-1,r=46,o=i;break;case 61:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?44:-1,r=46,o=i;break;case 62:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?45:-1,r=46,o=i;break;case 63:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?46:-1,r=46,o=i;break;case 64:t=n>=48&&57>=n||n>=65&&77>=n||n>=79&&90>=n||95==n||n>=97&&109>=n||n>=111&&122>=n?4:78==n||110==n?47:-1,r=46,o=i;break;case 65:t=n>=48&&57>=n||n>=65&&77>=n||n>=79&&90>=n||95==n||n>=97&&109>=n||n>=111&&122>=n?4:78==n||110==n?48:-1,r=46,o=i;break;case 66:t=n>=48&&57>=n||n>=66&&78>=n||n>=80&&84>=n||n>=86&&90>=n||95==n||n>=98&&110>=n||n>=112&&116>=n||n>=118&&122>=n?4:79==n||111==n?55:65==n||97==n?78:85==n||117==n?89:-1,r=46,o=i;break;case 67:t=n>=48&&57>=n||n>=65&&90>=n||95==n||n>=98&&122>=n?4:97==n?57:-1,r=46,o=i;break;case 68:t=n>=48&&57>=n||n>=65&&82>=n||n>=84&&90>=n||95==n||n>=97&&114>=n||n>=116&&122>=n?4:83==n||115==n?58:-1,r=46,o=i;break;case 69:t=n>=48&&57>=n||n>=65&&82>=n||n>=84&&90>=n||95==n||n>=97&&114>=n||n>=116&&122>=n?4:83==n||115==n?59:-1,r=46,o=i;break;case 70:t=n>=48&&57>=n||n>=65&&84>=n||n>=86&&90>=n||95==n||n>=97&&116>=n||n>=118&&122>=n?4:85==n||117==n?60:-1,r=46,o=i;break;case 71:t=n>=48&&57>=n||n>=65&&82>=n||n>=84&&90>=n||95==n||n>=97&&114>=n||n>=116&&122>=n?4:83==n||115==n?61:-1,r=46,o=i;break;case 72:t=n>=48&&57>=n||n>=65&&75>=n||n>=77&&90>=n||95==n||n>=97&&107>=n||n>=109&&122>=n?4:76==n||108==n?62:-1,r=46,o=i;break;case 73:t=n>=48&&57>=n||n>=65&&83>=n||n>=85&&90>=n||95==n||n>=97&&115>=n||n>=117&&122>=n?4:84==n||116==n?63:-1,r=46,o=i;break;case 74:t=n>=48&&57>=n||n>=65&&81>=n||n>=83&&90>=n||95==n||n>=97&&113>=n||n>=115&&122>=n?4:82==n||114==n?64:-1,r=46,o=i;break;case 75:t=n>=48&&57>=n||n>=65&&78>=n||n>=80&&90>=n||95==n||n>=97&&110>=n||n>=112&&122>=n?4:79==n||111==n?65:-1,r=46,o=i;break;case 76:t=n>=48&&57>=n||n>=65&&75>=n||n>=77&&90>=n||95==n||n>=97&&107>=n||n>=109&&122>=n?4:76==n||108==n?69:-1,r=46,o=i;break;case 77:t=n>=48&&57>=n||n>=65&&81>=n||n>=83&&90>=n||95==n||n>=97&&113>=n||n>=115&&122>=n?4:82==n||114==n?70:-1,r=46,o=i;break;case 78:t=n>=48&&57>=n||n>=65&&75>=n||n>=77&&90>=n||95==n||n>=97&&107>=n||n>=109&&122>=n?4:76==n||108==n?71:-1,r=46,o=i;break;case 79:t=n>=48&&57>=n||n>=65&&72>=n||n>=74&&90>=n||95==n||n>=97&&104>=n||n>=106&&122>=n?4:73==n||105==n?72:-1,r=46,o=i;break;case 80:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?73:-1,r=46,o=i;break;case 81:t=n>=48&&57>=n||n>=65&&84>=n||n>=86&&90>=n||95==n||n>=97&&116>=n||n>=118&&122>=n?4:85==n||117==n?74:-1,r=46,o=i;break;case 82:t=n>=48&&57>=n||n>=65&&72>=n||n>=74&&90>=n||95==n||n>=97&&104>=n||n>=106&&122>=n?4:73==n||105==n?75:-1,r=46,o=i;break;case 83:t=n>=48&&57>=n||n>=65&&71>=n||n>=73&&90>=n||95==n||n>=97&&103>=n||n>=105&&122>=n?4:72==n||104==n?79:-1,r=46,o=i;break;case 84:t=n>=48&&57>=n||n>=65&&75>=n||n>=77&&90>=n||95==n||n>=97&&107>=n||n>=109&&122>=n?4:76==n||108==n?80:-1,r=46,o=i;break;case 85:t=n>=48&&57>=n||n>=65&&83>=n||n>=85&&90>=n||95==n||n>=97&&115>=n||n>=117&&122>=n?4:84==n||116==n?81:-1,r=46,o=i;break;case 86:t=n>=48&&57>=n||n>=65&&83>=n||n>=85&&90>=n||95==n||n>=97&&115>=n||n>=117&&122>=n?4:84==n||116==n?82:-1,r=46,o=i;break;case 87:t=n>=48&&57>=n||n>=65&&68>=n||n>=70&&90>=n||95==n||n>=97&&100>=n||n>=102&&122>=n?4:69==n||101==n?85:-1,r=46,o=i;break;case 88:t=n>=48&&57>=n||n>=65&&66>=n||n>=68&&90>=n||95==n||n>=97&&98>=n||n>=100&&122>=n?4:67==n||99==n?86:-1,r=46,o=i;break;case 89:t=n>=48&&57>=n||n>=65&&77>=n||n>=79&&90>=n||95==n||n>=97&&109>=n||n>=111&&122>=n?4:78==n||110==n?88:-1,r=46,o=i}t>-1&&(10==n&&(e.line++,e.column=0,this.countLines&&(this.parCurLine=e.line)),e.column++,this.countLines&&(this.parCurColumn=e.column)),i++}while(t>-1)}while(2==r);r>-1?(e.att=e.src.substr(a,o-a),e.offset=o,47==r&&(e.att=e.att.substr(1,e.att.length-2),e.att=e.att.replace(/\\\'/g,"'"))):(e.att=new String,r=-1);break}return r},_parse:function(e,t,i){var n,r,o,a=[],s=[],l=0,c={la:0,act:0,offset:0,src:e,att:"",line:1,column:1,error_step:0},u=[[0,1],[50,2],[50,0],[52,2],[52,0],[53,3],[53,1],[53,0],[55,3],[55,1],[55,0],[56,3],[57,3],[57,1],[57,0],[58,3],[58,1],[61,3],[51,3],[51,5],[51,3],[51,5],[51,9],[51,3],[51,2],[51,2],[51,2],[51,2],[51,3],[51,1],[60,3],[60,4],[60,1],[54,3],[54,3],[54,3],[54,3],[54,3],[54,3],[54,3],[54,1],[63,3],[63,3],[63,2],[63,1],[62,3],[62,3],[62,1],[64,3],[64,3],[64,3],[64,1],[66,3],[66,1],[65,2],[65,2],[65,1],[59,4],[59,7],[59,4],[59,5],[59,3],[59,1],[67,1],[67,1],[67,1],[67,3],[67,1],[67,7],[67,3],[67,3],[67,1],[67,1],[67,1]],d=[[],[3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[38,41],[46,42],[46,43],[3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[20,45],[24,46,23,47,26,48,25,49,27,50,28,51,22,52,20,53],[],[],[21,55],[30,56,29,57],[44,58,38,59,16,60,37,61],[21,-32],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[32,63,33,64],[],[35,65,34,66,36,67],[],[],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[38,69],[46,72],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[],[],[],[48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[24,46,23,47,26,48,25,49,27,50,28,51,22,52,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[44,78,38,59,16,79,37,61],[],[24,46,23,47,26,48,25,49,27,50,28,51,22,52,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[5,81],[46,17,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[20,84],[],[],[],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[19,92,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[46,97],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[30,56,29,57],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[39,106,24,46,23,47,26,48,25,49,27,50,28,51,22,52],[46,108],[15,109,40,110],[],[42,111],[17,112,40,113],[24,46,23,47,26,48,25,49,27,50,28,51,22,52],[],[],[4,114],[46,115],[33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[20,118],[44,58,38,59,16,60],[],[30,56,29,57],[30,56,29,57],[30,56,29,57],[30,56,29,57],[30,56,29,57],[30,56,29,57],[30,56,29,57],[],[],[24,46,23,47,26,48,25,49,27,50,28,51,22,52],[32,63,33,64],[32,63,33,64],[21,-30],[39,119,40,113],[17,120,32,63,33,64],[],[35,65,34,66,36,67],[35,65,34,66,36,67],[],[],[],[],[39,121,40,122],[],[],[46,72],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[],[17,127,32,63,33,64],[24,46,23,47,26,48,25,49,27,50,28,51,22,52,20,128],[31,18,33,33,32,34,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[16,131,48,22,49,23,46,38,38,24,47,25,8,26,14,27,12,29,13,30,45,31],[21,-31],[18,133],[46,134],[],[24,46,23,47,26,48,25,49,27,50,28,51,22,52],[24,46,23,47,26,48,25,49,27,50,28,51,22,52],[],[],[],[24,46,23,47,26,48,25,49,27,50,28,51,22,52,20,135],[40,136],[33,33,32,34,31,18,48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[44,78,38,59,16,79],[],[],[46,17,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[48,22,49,23,46,38,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31],[17,141,32,63,33,64],[19,142,3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[39,143],[44,78,38,59,16,79],[],[],[3,3,5,4,6,5,7,6,9,7,11,8,10,9,18,12,20,13,46,17,31,18,48,22,49,23,38,24,47,25,8,26,14,27,16,28,12,29,13,30,45,31,33,33,32,34],[]],h=[[50,1],[51,2,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[54,36,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[54,39,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[51,40,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[],[],[51,44,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[],[52,54],[],[],[],[],[],[63,62,62,19,64,21,65,32,66,35,59,37,67,20],[],[],[],[],[],[54,68,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[],[],[55,70,56,71],[53,73,54,74,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[],[],[],[],[66,75,59,37,67,20],[66,76,59,37,67,20],[],[51,77,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[],[51,80,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[61,82,60,14,59,83,67,20],[],[],[],[],[63,85,62,19,64,21,65,32,66,35,59,37,67,20],[63,86,62,19,64,21,65,32,66,35,59,37,67,20],[63,87,62,19,64,21,65,32,66,35,59,37,67,20],[63,88,62,19,64,21,65,32,66,35,59,37,67,20],[63,89,62,19,64,21,65,32,66,35,59,37,67,20],[63,90,62,19,64,21,65,32,66,35,59,37,67,20],[63,91,62,19,64,21,65,32,66,35,59,37,67,20],[],[51,93,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[54,94,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[62,95,64,21,65,32,66,35,59,37,67,20],[62,96,64,21,65,32,66,35,59,37,67,20],[],[53,98,54,74,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[62,99,64,21,65,32,66,35,59,37,67,20],[66,100,59,37,67,20],[],[64,101,65,32,66,35,59,37,67,20],[64,102,65,32,66,35,59,37,67,20],[65,103,66,35,59,37,67,20],[65,104,66,35,59,37,67,20],[65,105,66,35,59,37,67,20],[],[57,107],[],[],[],[],[],[],[],[],[],[62,116,64,21,65,32,66,35,59,37,67,20],[],[54,117,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[56,123],[54,124,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[],[54,125,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[51,126,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[],[],[54,129,63,15,62,19,64,21,65,32,66,35,59,37,67,20],[58,130,59,132,67,20],[],[],[],[],[],[],[],[],[],[],[],[53,73,62,137,64,21,54,74,65,32,63,15,66,35,59,37,67,20],[],[52,138],[],[61,139,60,14,59,83,67,20],[59,140,67,20],[],[51,93,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[],[],[],[],[51,144,61,10,54,11,60,14,63,15,59,16,62,19,67,20,64,21,65,32,66,35],[]],p=[2,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,4,29,-1,40,53,65,-1,44,62,47,63,64,-1,67,-1,10,7,71,72,73,51,-1,-1,56,-1,53,65,-1,-1,-1,-1,24,25,26,-1,-1,-1,-1,-1,-1,-1,27,-1,-1,-1,-1,-1,7,-1,-1,43,-1,-1,-1,-1,-1,-1,14,-1,9,-1,-1,6,54,55,18,-1,-1,20,-1,-1,-1,23,39,38,37,36,35,34,33,28,3,17,42,41,61,-1,-1,52,46,45,50,49,48,66,-1,13,69,-1,-1,70,-1,-1,61,-1,-1,-1,59,57,-1,-1,8,11,5,19,57,21,-1,60,7,16,4,12,-1,-1,44,-1,-1,15,58,68,-1,22],f=["Program'","ERROR_RESYNC","WHITESPACE","IF","ELSE","WHILE","DO","FOR","FUNCTION","USE","RETURN","DELETE","TRUE","FALSE","<<",">>","[","]","{","}",";","=","==","!=","~=","<=",">=",">","<","||","&&","!","+","-","/","%","*","^","(",")",",","#",":","|",".","NaN","Identifier","String","Integer","Float","Program","Stmt","Stmt_List","Param_List","Expression","Prop_List","Prop","Param_Def_List","Attr_List","ExtValue","Lhs","Assign","AddSubExp","LogExp","MulDivExp","NegExp","ExpExp","Value","$"];
for(t||(t=[]),i||(i=[]),a.push(0),s.push(0),c.la=this._lex(c);;){for(c.act=146,o=0;d[a[a.length-1]].length>o;o+=2)if(d[a[a.length-1]][o]==c.la){c.act=d[a[a.length-1]][o+1];break}if(146==c.act&&(0>(c.act=p[a[a.length-1]])?c.act=146:c.act*=-1),146==c.act){if(0==c.error_step)for(l++,t.push({offset:c.offset-c.att.length,line:c.line}),i.push([]),o=0;d[a[a.length-1]].length>o;o+=2)i[i.length-1].push(f[d[a[a.length-1]][o]]);for(;a.length>1&&146==c.act;)for(a.pop(),s.pop(),o=0;d[a[a.length-1]].length>o;o+=2)if(1==d[a[a.length-1]][o]){c.act=d[a[a.length-1]][o+1],a.push(c.act),s.push("");break}if(a.length>1&&146!=c.act){for(;68!=c.la;){for(c.act=146,o=0;d[a[a.length-1]].length>o;o+=2)if(d[a[a.length-1]][o]==c.la){c.act=d[a[a.length-1]][o+1];break}if(146!=c.act)break;for(;0>(c.la=this._lex(c));)c.offset++}for(;68!=c.la&&146==c.act;);}if(146==c.act||68==c.la)break;c.error_step=3}if(c.act>0)a.push(c.act),s.push(c.att),c.la=this._lex(c),c.error_step>0&&c.error_step--;else{switch(n=-1*c.act,r=void 0,n){case 0:r=s[s.length-1];break;case 1:this.execute(s[s.length-1]);break;case 2:r=s[s.length-0];break;case 3:r=this.createNode("node_op","op_none",s[s.length-2],s[s.length-1]);break;case 4:r=s[s.length-0];break;case 5:r=this.createNode("node_op","op_param",s[s.length-1],s[s.length-3]);break;case 6:r=this.createNode("node_op","op_param",s[s.length-1]);break;case 7:r=s[s.length-0];break;case 8:r=this.createNode("node_op","op_proplst",s[s.length-3],s[s.length-1]);break;case 9:r=s[s.length-1];break;case 10:r=s[s.length-0];break;case 11:r=this.createNode("node_op","op_prop",s[s.length-3],s[s.length-1]);break;case 12:r=this.createNode("node_op","op_paramdef",s[s.length-1],s[s.length-3]);break;case 13:r=this.createNode("node_op","op_paramdef",s[s.length-1]);break;case 14:r=s[s.length-0];break;case 15:r=this.createNode("node_op","op_param",s[s.length-1],s[s.length-3]);break;case 16:r=this.createNode("node_op","op_param",s[s.length-1]);break;case 17:r=this.createNode("node_op","op_assign",s[s.length-3],s[s.length-1]);break;case 18:r=this.createNode("node_op","op_if",s[s.length-2],s[s.length-1]);break;case 19:r=this.createNode("node_op","op_if_else",s[s.length-4],s[s.length-3],s[s.length-1]);break;case 20:r=this.createNode("node_op","op_while",s[s.length-2],s[s.length-1]);break;case 21:r=this.createNode("node_op","op_do",s[s.length-4],s[s.length-2]);break;case 22:r=this.createNode("node_op","op_for",s[s.length-7],s[s.length-5],s[s.length-3],s[s.length-1]);break;case 23:r=this.createNode("node_op","op_use",s[s.length-2]);break;case 24:r=this.createNode("node_op","op_delete",s[s.length-1]);break;case 25:r=this.createNode("node_op","op_return",s[s.length-1]);break;case 26:r=s[s.length-2];break;case 27:r=this.createNode("node_op","op_noassign",s[s.length-2]);break;case 28:r=s[s.length-2],r.needsBrackets=!0;break;case 29:r=this.createNode("node_op","op_none");break;case 30:r=this.createNode("node_op","op_lhs",s[s.length-1],s[s.length-3],"dot");break;case 31:r=this.createNode("node_op","op_lhs",s[s.length-2],s[s.length-4],"bracket");break;case 32:r=this.createNode("node_op","op_lhs",s[s.length-1]);break;case 33:r=this.createNode("node_op","op_equ",s[s.length-3],s[s.length-1]);break;case 34:r=this.createNode("node_op","op_lot",s[s.length-3],s[s.length-1]);break;case 35:r=this.createNode("node_op","op_grt",s[s.length-3],s[s.length-1]);break;case 36:r=this.createNode("node_op","op_loe",s[s.length-3],s[s.length-1]);break;case 37:r=this.createNode("node_op","op_gre",s[s.length-3],s[s.length-1]);break;case 38:r=this.createNode("node_op","op_neq",s[s.length-3],s[s.length-1]);break;case 39:r=this.createNode("node_op","op_approx",s[s.length-3],s[s.length-1]);break;case 40:r=s[s.length-1];break;case 41:r=this.createNode("node_op","op_or",s[s.length-3],s[s.length-1]);break;case 42:r=this.createNode("node_op","op_and",s[s.length-3],s[s.length-1]);break;case 43:r=this.createNode("node_op","op_not",s[s.length-1]);break;case 44:r=s[s.length-1];break;case 45:r=this.createNode("node_op","op_sub",s[s.length-3],s[s.length-1]);break;case 46:r=this.createNode("node_op","op_add",s[s.length-3],s[s.length-1]);break;case 47:r=s[s.length-1];break;case 48:r=this.createNode("node_op","op_mul",s[s.length-3],s[s.length-1]);break;case 49:r=this.createNode("node_op","op_div",s[s.length-3],s[s.length-1]);break;case 50:r=this.createNode("node_op","op_mod",s[s.length-3],s[s.length-1]);break;case 51:r=s[s.length-1];break;case 52:r=this.createNode("node_op","op_exp",s[s.length-3],s[s.length-1]);break;case 53:r=s[s.length-1];break;case 54:r=this.createNode("node_op","op_neg",s[s.length-1]);break;case 55:r=s[s.length-1];break;case 56:r=s[s.length-1];break;case 57:r=this.createNode("node_op","op_extvalue",s[s.length-4],s[s.length-2]);break;case 58:r=this.createNode("node_op","op_extvalue",this.createNode("node_op","op_execfun",s[s.length-7],s[s.length-5]),s[s.length-2]);break;case 59:r=this.createNode("node_op","op_execfun",s[s.length-4],s[s.length-2]);break;case 60:r=this.createNode("node_op","op_execfun",s[s.length-5],s[s.length-3],s[s.length-1],!0);break;case 61:r=this.createNode("node_op","op_property",s[s.length-3],s[s.length-1]);break;case 62:r=s[s.length-1];break;case 63:r=this.createNode("node_const",s[s.length-1]);break;case 64:r=this.createNode("node_const",s[s.length-1]);break;case 65:r=this.createNode("node_var",s[s.length-1]);break;case 66:r=s[s.length-2];break;case 67:r=this.createNode("node_str",s[s.length-1]);break;case 68:r=this.createNode("node_op","op_function",s[s.length-5],s[s.length-2]);break;case 69:r=this.createNode("node_op","op_proplst_val",s[s.length-2]);break;case 70:r=this.createNode("node_op","op_array",s[s.length-2]);break;case 71:r=this.createNode("node_const_bool",s[s.length-1]);break;case 72:r=this.createNode("node_const_bool",s[s.length-1]);break;case 73:r=0/0}for(o=0;u[n][1]>o;o++)a.pop(),s.pop();for(c.act=146,o=0;h[a[a.length-1]].length>o;o+=2)if(h[a[a.length-1]][o]==u[n][0]){c.act=h[a[a.length-1]][o+1];break}if(0==n)break;a.push(c.act),s.push(r)}}return l}}),JXG.Dump={addMarkers:function(e,t,i){var n,r,o;JXG.isArray(t)||(t=[t]),JXG.isArray(i)||(i=[i]),r=Math.min(t.length,i.length),t.length=r,i.length=r;for(n in e.objects)for(o=0;r>o;o++)e.objects[n][t[o]]=i[o]},deleteMarkers:function(e,t){var i,n,r;JXG.isArray(t)||(t=[t]),n=t.length,t.length=n;for(i in e.objects)for(r=0;n>r;r++)delete e.objects[i][t[r]]},str:function(e){return"string"==typeof e&&"function"!==e.substr(0,7)&&(e="'"+e+"'"),e},minimizeObject:function(e){var t,i,n,r=JXG.deepCopy(e),o=[];for(n=1;arguments.length>n;n++)o.push(arguments[n]);for(n=0;o.length>n;n++)for(t in o[n])i=t.toLowerCase(),"object"!=typeof o[n][t]&&o[n][t]==r[i]&&delete r[i];return r},prepareAttributes:function(e,t){var i,n;i=this.minimizeObject(t.getAttributes(),e.options[t.elType],e.options.elements);for(n in t.subs)i[n]=this.minimizeObject(t.subs[n].getAttributes(),e.options[t.elType][n],e.options[t.subs[n].elType],e.options.elements),i[n].id=t.subs[n].id,i[n].name=t.subs[n].name;return i.id=t.id,i.name=t.name,i},dump:function(e){var t,i,n,r,o=[],a=e.objectsList.length;for(this.addMarkers(e,"dumped",!1),t=0;a>t;t++)if(i=e.objectsList[t],n={},!i.dumped&&i.dump){for(n.type=i.getType(),n.parents=i.getParents(),"point"===n.type&&1==n.parents[0]&&(n.parents=n.parents.slice(1)),r=0;n.parents.length>r;r++)"string"==typeof n.parents[r]&&(n.parents[r]="'"+n.parents[r]+"'");n.attributes=this.prepareAttributes(e,i),o.push(n)}return this.deleteMarkers(e,"dumped"),o},toJSAN:function(e){var t;switch(typeof e){case"object":if(e){var i=[];if(e instanceof Array){for(t=0;e.length>t;t++)i.push(this.toJSAN(e[t]));return"["+i.join(",")+"]"}for(var n in e)i.push(n+": "+this.toJSAN(e[n]));return"<<"+i.join(", ")+">> "}return"null";case"string":return"'"+e.replace(/(["'])/g,"\\$1")+"'";case"number":case"boolean":return new String(e);case"null":return"null"}},toJessie:function(e){var t,i=this.dump(e),n=[];for(t=0;i.length>t;t++)i[t].attributes.name.length>0&&n.push("// "+i[t].attributes.name),n.push("s"+t+" = "+i[t].type+"("+i[t].parents.join(", ")+") "+this.toJSAN(i[t].attributes).replace(/\n/,"\\n")+";"),n.push("");return n.join("\n")},toJavaScript:function(e){var t,i=this.dump(e),n=[];for(t=0;i.length>t;t++)n.push('board.create("'+i[t].type+'", ['+i[t].parents.join(", ")+"], "+JXG.toJSON(i[t].attributes)+");");return n.join("\n")}},JXG.SVGRenderer=function(e){var t;for(this.type="svg",this.svgRoot=null,this.svgNamespace="http://www.w3.org/2000/svg",this.xlinkNamespace="http://www.w3.org/1999/xlink",this.container=e,this.container.style.MozUserSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg"),this.svgRoot.style.overflow="hidden",this.svgRoot.style.width=JXG.getStyle(this.container,"width"),this.svgRoot.style.height=JXG.getStyle(this.container,"height"),this.container.appendChild(this.svgRoot),this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs"),this.svgRoot.appendChild(this.defs),this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter"),this.filter.setAttributeNS(null,"id",this.container.id+"_"+"f1"),this.filter.setAttributeNS(null,"width","300%"),this.filter.setAttributeNS(null,"height","300%"),this.filter.setAttributeNS(null,"filterUnits","userSpaceOnUse"),this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset"),this.feOffset.setAttributeNS(null,"result","offOut"),this.feOffset.setAttributeNS(null,"in","SourceAlpha"),this.feOffset.setAttributeNS(null,"dx","5"),this.feOffset.setAttributeNS(null,"dy","5"),this.filter.appendChild(this.feOffset),this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur"),this.feGaussianBlur.setAttributeNS(null,"result","blurOut"),this.feGaussianBlur.setAttributeNS(null,"in","offOut"),this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3"),this.filter.appendChild(this.feGaussianBlur),this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend"),this.feBlend.setAttributeNS(null,"in","SourceGraphic"),this.feBlend.setAttributeNS(null,"in2","blurOut"),this.feBlend.setAttributeNS(null,"mode","normal"),this.filter.appendChild(this.feBlend),this.defs.appendChild(this.filter),this.layer=[],t=0;JXG.Options.layer.numlayers>t;t++)this.layer[t]=this.container.ownerDocument.createElementNS(this.svgNamespace,"g"),this.svgRoot.appendChild(this.layer[t]);this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]},JXG.SVGRenderer.prototype=new JXG.AbstractRenderer,JXG.extend(JXG.SVGRenderer.prototype,{_createArrowHead:function(e,t){var i,n,r=e.id+"Triangle";return JXG.exists(t)&&(r+=t),i=this.createPrim("marker",r),i.setAttributeNS(null,"viewBox","0 0 10 6"),i.setAttributeNS(null,"refY","3"),i.setAttributeNS(null,"markerUnits","userSpaceOnUse"),i.setAttributeNS(null,"markerHeight","12"),i.setAttributeNS(null,"markerWidth","10"),i.setAttributeNS(null,"orient","auto"),i.setAttributeNS(null,"stroke",JXG.evaluate(e.visProp.strokecolor)),i.setAttributeNS(null,"stroke-opacity",JXG.evaluate(e.visProp.strokeopacity)),i.setAttributeNS(null,"fill",JXG.evaluate(e.visProp.strokecolor)),i.setAttributeNS(null,"fill-opacity",JXG.evaluate(e.visProp.strokeopacity)),n=this.container.ownerDocument.createElementNS(this.svgNamespace,"path"),"End"===t?(i.setAttributeNS(null,"refX","0"),n.setAttributeNS(null,"d","M 0 3 L 10 6 L 10 0 z")):(i.setAttributeNS(null,"refX","10"),n.setAttributeNS(null,"d","M 0 0 L 10 3 L 0 6 z")),i.appendChild(n),i},_setArrowAtts:function(e,t,i,n){e&&(e.setAttributeNS(null,"stroke",t),e.setAttributeNS(null,"stroke-opacity",i),e.setAttributeNS(null,"fill",t),e.setAttributeNS(null,"fill-opacity",i),e.setAttributeNS(null,"stroke-width",n))},updateTicks:function(e){var t,i,n,r,o,a="",s=e.ticks.length;for(t=0;s>t;t++)i=e.ticks[t],r=i[0],o=i[1],r[0]!==void 0&&r[1]!==void 0&&(a+="M "+r[0]+" "+o[0]+" L "+r[1]+" "+o[1]+" ");for(t=0;s>t;t++)i=e.ticks[t].scrCoords,e.ticks[t].major&&(e.board.needsFullUpdate||e.needsRegularUpdate)&&e.labels[t]&&e.labels[t].visProp.visible&&this.updateText(e.labels[t]);n=this.getElementById(e.id),JXG.exists(n)||(n=this.createPrim("path",e.id),this.appendChildPrim(n,e.visProp.layer),this.appendNodesToElement(e,"path")),n.setAttributeNS(null,"stroke",e.visProp.strokecolor),n.setAttributeNS(null,"stroke-opacity",e.visProp.strokeopacity),n.setAttributeNS(null,"stroke-width",e.visProp.strokewidth),this.updatePathPrim(n,a,e.board)},displayCopyright:function(e,t){var i,n=this.createPrim("text","licenseText");n.setAttributeNS(null,"x","20px"),n.setAttributeNS(null,"y",2+t+"px"),n.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+t+"px; fill:#356AA0;  opacity:0.3;"),i=document.createTextNode(e),n.appendChild(i),this.appendChildPrim(n,0)},drawInternalText:function(e){var t=this.createPrim("text",e.id);return t.setAttributeNS(null,"class",e.visProp.cssclass),e.rendNodeText=document.createTextNode(""),t.appendChild(e.rendNodeText),this.appendChildPrim(t,e.visProp.layer),t},updateInternalText:function(e){var t=e.plaintext;isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||(e.rendNode.setAttributeNS(null,"x",e.coords.scrCoords[1]+"px"),e.rendNode.setAttributeNS(null,"y",e.coords.scrCoords[2]+.5*this.vOffsetText+"px"),"right"===e.visProp.anchorx?e.rendNode.setAttributeNS(null,"text-anchor","end"):"middle"===e.visProp.anchorx&&e.rendNode.setAttributeNS(null,"text-anchor","middle"),"top"===e.visProp.anchory?e.rendNode.setAttributeNS(null,"dominant-baseline","text-before-edge"):"middle"===e.visProp.anchory&&e.rendNode.setAttributeNS(null,"dominant-baseline","middle")),e.htmlStr!==t&&(e.rendNodeText.data=t,e.htmlStr=t),this.transformImage(e,e.transformations)},updateInternalTextStyle:function(e,t,i){this.setObjectFillColor(e,t,i)},drawImage:function(e){var t=this.createPrim("image",e.id);t.setAttributeNS(null,"preserveAspectRatio","none"),this.appendChildPrim(t,e.visProp.layer),e.rendNode=t,this.updateImage(e)},transformImage:function(e,t){var i,n,r=e.rendNode,o="",a=t.length;a>0&&(i=this.joinTransforms(e,t),n=[i[1][1],i[2][1],i[1][2],i[2][2],i[1][0],i[2][0]].join(","),o+=" matrix("+n+") ",r.setAttributeNS(null,"transform",o))},updateImageURL:function(e){var t=JXG.evaluate(e.url);e.rendNode.setAttributeNS(this.xlinkNamespace,"xlink:href",t)},updateImageStyle:function(e,t){var i=t?e.visProp.highlightcssclass:e.visProp.cssclass;e.rendNode.setAttributeNS(null,"class",i)},appendChildPrim:function(e,t){JXG.exists(t)?t>=JXG.Options.layer.numlayers&&(t=JXG.Options.layer.numlayers-1):t=0,this.layer[t].appendChild(e)},appendNodesToElement:function(e){e.rendNode=this.getElementById(e.id)},createPrim:function(e,t){var i=this.container.ownerDocument.createElementNS(this.svgNamespace,e);return i.setAttributeNS(null,"id",this.container.id+"_"+t),i.style.position="absolute","path"===e&&(i.setAttributeNS(null,"stroke-linecap","butt"),i.setAttributeNS(null,"stroke-linejoin","round")),i},remove:function(e){JXG.exists(e)&&JXG.exists(e.parentNode)&&e.parentNode.removeChild(e)},makeArrows:function(e){var t;(e.visPropOld.firstarrow!==e.visProp.firstarrow||e.visPropOld.lastarrow!==e.visProp.lastarrow)&&(e.visProp.firstarrow?(t=e.rendNodeTriangleStart,JXG.exists(t)?this.defs.appendChild(t):(t=this._createArrowHead(e,"End"),this.defs.appendChild(t),e.rendNodeTriangleStart=t,e.rendNode.setAttributeNS(null,"marker-start","url(#"+this.container.id+"_"+e.id+"TriangleEnd)"))):(t=e.rendNodeTriangleStart,JXG.exists(t)&&this.remove(t)),e.visProp.lastarrow?(t=e.rendNodeTriangleEnd,JXG.exists(t)?this.defs.appendChild(t):(t=this._createArrowHead(e,"Start"),this.defs.appendChild(t),e.rendNodeTriangleEnd=t,e.rendNode.setAttributeNS(null,"marker-end","url(#"+this.container.id+"_"+e.id+"TriangleStart)"))):(t=e.rendNodeTriangleEnd,JXG.exists(t)&&this.remove(t)),e.visPropOld.firstarrow=e.visProp.firstarrow,e.visPropOld.lastarrow=e.visProp.lastarrow)},updateEllipsePrim:function(e,t,i,n,r){e.setAttributeNS(null,"cx",t),e.setAttributeNS(null,"cy",i),e.setAttributeNS(null,"rx",Math.abs(n)),e.setAttributeNS(null,"ry",Math.abs(r))},updateLinePrim:function(e,t,i,n,r){isNaN(t+i+n+r)||(e.setAttributeNS(null,"x1",t),e.setAttributeNS(null,"y1",i),e.setAttributeNS(null,"x2",n),e.setAttributeNS(null,"y2",r))},updatePathPrim:function(e,t){""==t&&(t="M 0 0"),e.setAttributeNS(null,"d",t)},updatePathStringPoint:function(e,t,i){var n="",r=e.coords.scrCoords,o=.5*t*Math.sqrt(3),a=.5*t;return"x"===i?n=" M "+(r[1]-t)+" "+(r[2]-t)+" L "+(r[1]+t)+" "+(r[2]+t)+" M "+(r[1]+t)+" "+(r[2]-t)+" L "+(r[1]-t)+" "+(r[2]+t):"+"===i?n=" M "+(r[1]-t)+" "+r[2]+" L "+(r[1]+t)+" "+r[2]+" M "+r[1]+" "+(r[2]-t)+" L "+r[1]+" "+(r[2]+t):"<>"===i?n=" M "+(r[1]-t)+" "+r[2]+" L "+r[1]+" "+(r[2]+t)+" L "+(r[1]+t)+" "+r[2]+" L "+r[1]+" "+(r[2]-t)+" Z ":"^"===i?n=" M "+r[1]+" "+(r[2]-t)+" L "+(r[1]-o)+" "+(r[2]+a)+" L "+(r[1]+o)+" "+(r[2]+a)+" Z ":"v"===i?n=" M "+r[1]+" "+(r[2]+t)+" L "+(r[1]-o)+" "+(r[2]-a)+" L "+(r[1]+o)+" "+(r[2]-a)+" Z ":">"===i?n=" M "+(r[1]+t)+" "+r[2]+" L "+(r[1]-a)+" "+(r[2]-o)+" L "+(r[1]-a)+" "+(r[2]+o)+" Z ":"<"===i&&(n=" M "+(r[1]-t)+" "+r[2]+" L "+(r[1]+a)+" "+(r[2]-o)+" L "+(r[1]+a)+" "+(r[2]+o)+" Z "),n},updatePathStringPrim:function(e){var t,i,n,r=" M ",o=" L ",a=" C ",s=r,l=5e3,c="",u="plot"!==e.visProp.curvetype;if(0>=e.numberPoints)return"";if(n=Math.min(e.points.length,e.numberPoints),1==e.bezierDegree)for(u&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,.5)),t=0;n>t;t++)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?s=r:(i[1]>l?i[1]=l:-l>i[1]&&(i[1]=-l),i[2]>l?i[2]=l:-l>i[2]&&(i[2]=-l),c+=s+i[1]+" "+i[2],s=o);else if(3==e.bezierDegree)for(t=0;n>t;)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?s=r:(c+=s+i[1]+" "+i[2],s==a&&(t++,i=e.points[t].scrCoords,c+=" "+i[1]+" "+i[2],t++,i=e.points[t].scrCoords,c+=" "+i[1]+" "+i[2]),s=a),t++;return c},updatePathStringBezierPrim:function(e){var t,i,n,r,o,a,s=" M ",l=" C ",c=s,u=5e3,d="",h=e.visProp.strokewidth,p="plot"!==e.visProp.curvetype;if(0>=e.numberPoints)return"";for(p&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,.5)),a=Math.min(e.points.length,e.numberPoints),i=1;3>i;i++)for(c=s,t=0;a>t;t++)n=e.points[t].scrCoords,isNaN(n[1])||isNaN(n[2])?c=s:(n[1]>u?n[1]=u:-u>n[1]&&(n[1]=-u),n[2]>u?n[2]=u:-u>n[2]&&(n[2]=-u),d+=c==s?[c,n[1]+0*h*(2*i*Math.random()-i)," ",n[2]+0*h*(2*i*Math.random()-i)].join(""):[c,r+.333*(n[1]-r)+h*(2*i*Math.random()-i)," ",o+.333*(n[2]-o)+h*(2*i*Math.random()-i)," ",r+.333*2*(n[1]-r)+h*(2*i*Math.random()-i)," ",o+.333*2*(n[2]-o)+h*(2*i*Math.random()-i)," ",n[1]," ",n[2]].join(""),c=l,r=n[1],o=n[2]);return d},updatePolygonPrim:function(e,t){var i,n,r="",o=t.vertices.length;for(e.setAttributeNS(null,"stroke","none"),n=0;o-1>n;n++){if(!t.vertices[n].isReal)return e.setAttributeNS(null,"points",""),void 0;i=t.vertices[n].coords.scrCoords,r=r+i[1]+","+i[2],o-2>n&&(r+=" ")}-1==r.indexOf("NaN")&&e.setAttributeNS(null,"points",r)},updateRectPrim:function(e,t,i,n,r){e.setAttributeNS(null,"x",t),e.setAttributeNS(null,"y",i),e.setAttributeNS(null,"width",n),e.setAttributeNS(null,"height",r)},setPropertyPrim:function(e,t,i){"stroked"!==t&&e.setAttributeNS(null,t,i)},show:function(e){var t;e&&e.rendNode&&(t=e.rendNode,t.setAttributeNS(null,"display","inline"),t.style.visibility="inherit")},hide:function(e){var t;e&&e.rendNode&&(t=e.rendNode,t.setAttributeNS(null,"display","none"),t.style.visibility="hidden")},setBuffering:function(e,t){e.rendNode.setAttribute("buffered-rendering",t)},setDashStyle:function(e){var t=e.visProp.dash,i=e.rendNode;e.visProp.dash>0?i.setAttributeNS(null,"stroke-dasharray",this.dashArray[t-1]):i.hasAttributeNS(null,"stroke-dasharray")&&i.removeAttributeNS(null,"stroke-dasharray")},setGradient:function(e){var t,i,n,r,o,a,s,l,c,u=e.rendNode;i=JXG.evaluate(e.visProp.fillopacity),i=i>0?i:0,t=JXG.evaluate(e.visProp.fillcolor),"linear"===e.visProp.gradient?(n=this.createPrim("linearGradient",e.id+"_gradient"),a="0%",s="100%",l="0%",c="0%",n.setAttributeNS(null,"x1",a),n.setAttributeNS(null,"x2",s),n.setAttributeNS(null,"y1",l),n.setAttributeNS(null,"y2",c),r=this.createPrim("stop",e.id+"_gradient1"),r.setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+i),o=this.createPrim("stop",e.id+"_gradient2"),o.setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientsecondcolor+";stop-opacity:"+e.visProp.gradientsecondopacity),n.appendChild(r),n.appendChild(o),this.defs.appendChild(n),u.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)"),e.gradNode1=r,e.gradNode2=o):"radial"===e.visProp.gradient?(n=this.createPrim("radialGradient",e.id+"_gradient"),n.setAttributeNS(null,"cx","50%"),n.setAttributeNS(null,"cy","50%"),n.setAttributeNS(null,"r","50%"),n.setAttributeNS(null,"fx",100*e.visProp.gradientpositionx+"%"),n.setAttributeNS(null,"fy",100*e.visProp.gradientpositiony+"%"),r=this.createPrim("stop",e.id+"_gradient1"),r.setAttributeNS(null,"offset","0%"),r.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientsecondcolor+";stop-opacity:"+e.visProp.gradientsecondopacity),o=this.createPrim("stop",e.id+"_gradient2"),o.setAttributeNS(null,"offset","100%"),o.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+i),n.appendChild(r),n.appendChild(o),this.defs.appendChild(n),u.setAttributeNS(null,"style","fill:url(#"+this.container.id+"_"+e.id+"_gradient)"),e.gradNode1=r,e.gradNode2=o):u.removeAttributeNS(null,"style")},updateGradient:function(e){var t,i,n=e.gradNode1,r=e.gradNode2;JXG.exists(n)&&JXG.exists(r)&&(i=JXG.evaluate(e.visProp.fillopacity),i=i>0?i:0,t=JXG.evaluate(e.visProp.fillcolor),"linear"===e.visProp.gradient?(n.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+i),r.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientsecondcolor+";stop-opacity:"+e.visProp.gradientsecondopacity)):"radial"===e.visProp.gradient&&(n.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientsecondcolor+";stop-opacity:"+e.visProp.gradientsecondopacity),r.setAttributeNS(null,"style","stop-color:"+t+";stop-opacity:"+i)))},setObjectFillColor:function(e,t,i){var n,r,o,a,s=JXG.evaluate(t),l=JXG.evaluate(i);l=l>0?l:0,(e.visPropOld.fillcolor!==s||e.visPropOld.fillopacity!==l)&&(JXG.exists(s)&&s!==!1&&(9!=s.length?(r=s,a=l):(o=JXG.rgba2rgbo(s),r=o[0],a=l*o[1]),n=e.rendNode,"none"!=r?n.setAttributeNS(null,"fill",r):a=0,e.type===JXG.OBJECT_TYPE_IMAGE?n.setAttributeNS(null,"opacity",a):n.setAttributeNS(null,"fill-opacity",a),JXG.exists(e.visProp.gradient)&&this.updateGradient(e)),e.visPropOld.fillcolor=s,e.visPropOld.fillopacity=l)},setObjectStrokeColor:function(e,t,i){var n,r,o,a,s=JXG.evaluate(t),l=JXG.evaluate(i);l=l>0?l:0,(e.visPropOld.strokecolor!==s||e.visPropOld.strokeopacity!==l)&&(JXG.exists(s)&&s!==!1&&(9!=s.length?(n=s,o=l):(r=JXG.rgba2rgbo(s),n=r[0],o=l*r[1]),a=e.rendNode,e.type===JXG.OBJECT_TYPE_TEXT?"html"===e.visProp.display?(a.style.color=n,a.style.opacity=o):(a.setAttributeNS(null,"style","fill:"+n),a.setAttributeNS(null,"style","fill-opacity:"+o)):(a.setAttributeNS(null,"stroke",n),a.setAttributeNS(null,"stroke-opacity",o)),e.type===JXG.OBJECT_TYPE_ARROW?this._setArrowAtts(e.rendNodeTriangle,n,o,e.visProp.strokewidth):(e.elementClass===JXG.OBJECT_CLASS_CURVE||e.elementClass===JXG.OBJECT_CLASS_LINE)&&(e.visProp.firstarrow&&this._setArrowAtts(e.rendNodeTriangleStart,n,o,e.visProp.strokewidth),e.visProp.lastarrow&&this._setArrowAtts(e.rendNodeTriangleEnd,n,o,e.visProp.strokewidth))),e.visPropOld.strokecolor=s,e.visPropOld.strokeopacity=l)},setObjectStrokeWidth:function(e,t){var i,n=JXG.evaluate(t);e.visPropOld.strokewidth!==n&&(i=e.rendNode,this.setPropertyPrim(i,"stroked","true"),JXG.exists(n)&&(this.setPropertyPrim(i,"stroke-width",n+"px"),e.type===JXG.OBJECT_TYPE_ARROW?this._setArrowAtts(e.rendNodeTriangle,e.visProp.strokecolor,e.visProp.strokeopacity,n):(e.elementClass===JXG.OBJECT_CLASS_CURVE||e.elementClass===JXG.OBJECT_CLASS_LINE)&&(e.visProp.firstarrow&&this._setArrowAtts(e.rendNodeTriangleStart,e.visProp.strokecolor,e.visProp.strokeopacity,n),e.visProp.lastarrow&&this._setArrowAtts(e.rendNodeTriangleEnd,e.visProp.strokecolor,e.visProp.strokeopacity,n))),e.visPropOld.strokewidth=n)},setShadow:function(e){e.visPropOld.shadow!==e.visProp.shadow&&(JXG.exists(e.rendNode)&&(e.visProp.shadow?e.rendNode.setAttributeNS(null,"filter","url(#"+this.container.id+"_"+"f1)"):e.rendNode.removeAttributeNS(null,"filter")),e.visPropOld.shadow=e.visProp.shadow)},suspendRedraw:function(){},unsuspendRedraw:function(){},resize:function(e,t){this.svgRoot.style.width=parseFloat(e)+"px",this.svgRoot.style.height=parseFloat(t)+"px"}}),JXG.VMLRenderer=function(e){this.type="vml",this.container=e,this.container.style.overflow="hidden",this.container.onselectstart=function(){return!1},this.resolution=10,JXG.exists(JXG.vmlStylesheet)||(e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),JXG.vmlStylesheet=this.container.ownerDocument.createStyleSheet(),JXG.vmlStylesheet.addRule(".jxgvml","behavior:url(#default#VML)"));try{!e.ownerDocument.namespaces.jxgvml&&e.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml"),this.createNode=function(t){return e.ownerDocument.createElement("<jxgvml:"+t+' class="jxgvml">')}}catch(t){this.createNode=function(t){return e.ownerDocument.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]},JXG.VMLRenderer.prototype=new JXG.AbstractRenderer,JXG.extend(JXG.VMLRenderer.prototype,{_setAttr:function(e,t,i,n){try{8===document.documentMode?e[t]=i:e.setAttribute(t,i,n)}catch(r){JXG.debug("_setAttr: "+t+" "+i+"<br>\n")}},updateTicks:function(e){var t,i,n,r,o=[],a=this.resolution;for(i=e.ticks.length,t=0;i>t;t++)n=e.ticks[t],x=n[0],y=n[1],x[0]!==void 0&&x[1]!==void 0&&o.push(" m "+Math.round(a*x[0])+", "+Math.round(a*y[0])+" l "+Math.round(a*x[1])+", "+Math.round(a*y[1])+" ");for(t=0;i>t;t++)n=e.ticks[t].scrCoords,e.ticks[t].major&&(e.board.needsFullUpdate||e.needsRegularUpdate)&&e.labels[t]&&e.labels[t].visProp.visible&&this.updateText(e.labels[t]);JXG.exists(e)||(r=this.createPrim("path",e.id),this.appendChildPrim(r,e.visProp.layer),this.appendNodesToElement(e,"path")),this._setAttr(e.rendNode,"stroked","true"),this._setAttr(e.rendNode,"strokecolor",e.visProp.strokecolor,1),this._setAttr(e.rendNode,"strokeweight",e.visProp.strokewidth),this._setAttr(e.rendNodeStroke,"opacity",100*e.visProp.strokeopacity+"%"),this.updatePathPrim(e.rendNode,o,e.board)},displayCopyright:function(e,t){var i,n;i=this.createNode("textbox"),i.style.position="absolute",this._setAttr(i,"id",this.container.id+"_"+"licenseText"),i.style.left=20,i.style.top=2,i.style.fontSize=t,i.style.color="#356AA0",i.style.fontFamily="Arial,Helvetica,sans-serif",this._setAttr(i,"opacity","30%"),i.style.filter="alpha(opacity = 30)",n=document.createTextNode(e),i.appendChild(n),this.appendChildPrim(i,0)},drawInternalText:function(e){var t;return t=this.createNode("textbox"),t.style.position="absolute",e.rendNodeText=document.createTextNode(""),t.appendChild(e.rendNodeText),this.appendChildPrim(t,9),t},updateInternalText:function(e){var t=e.plaintext;isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])||("right"===e.visProp.anchorx?e.rendNode.style.right=parseInt(e.board.canvasWidth-e.coords.scrCoords[1])+"px":e.rendNode.style.left="middle"===e.visProp.anchorx?parseInt(e.coords.scrCoords[1]-.5*e.size[0])+"px":parseInt(e.coords.scrCoords[1])+"px",e.rendNode.style.top=parseInt(e.coords.scrCoords[2]-e.visProp.fontsize+this.vOffsetText)+"px",e.rendNode.style.top="top"===e.visProp.anchory?parseInt(e.coords.scrCoords[2]+this.vOffsetText)+"px":"middle"===e.visProp.anchory?parseInt(e.coords.scrCoords[2]-.5*e.size[1]+this.vOffsetText)+"px":parseInt(e.coords.scrCoords[2]-e.size[1]+this.vOffsetText)+"px"),e.htmlStr!==t&&(e.rendNodeText.data=t,e.htmlStr=t),this.transformImage(e,e.transformations)},drawImage:function(e){var t;t=this.container.ownerDocument.createElement("img"),t.style.position="absolute",this._setAttr(t,"id",this.container.id+"_"+e.id),this.container.appendChild(t),this.appendChildPrim(t,e.visProp.layer),t.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand')",e.rendNode=t,this.updateImage(e)},transformImage:function(e,t){var i,n,r,o,a,s,l,c=e.rendNode,u=[],d=t.length;if(e.type===JXG.OBJECT_TYPE_TEXT&&e.updateSize(),d>0){for(l=""+e.rendNode.style.filter,l.match(/DXImageTransform/)||(c.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand') "+l),i=this.joinTransforms(e,t),u[0]=JXG.Math.matVecMult(i,e.coords.scrCoords),u[0][1]/=u[0][0],u[0][2]/=u[0][0],u[1]=JXG.Math.matVecMult(i,[1,e.coords.scrCoords[1]+e.size[0],e.coords.scrCoords[2]]),u[1][1]/=u[1][0],u[1][2]/=u[1][0],u[2]=JXG.Math.matVecMult(i,[1,e.coords.scrCoords[1]+e.size[0],e.coords.scrCoords[2]-e.size[1]]),u[2][1]/=u[2][0],u[2][2]/=u[2][0],u[3]=JXG.Math.matVecMult(i,[1,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1]]),u[3][1]/=u[3][0],u[3][2]/=u[3][0],n=u[0][1],o=u[0][1],r=u[0][2],a=u[0][2],s=1;4>s;s++)n=Math.max(n,u[s][1]),o=Math.min(o,u[s][1]),r=Math.max(r,u[s][2]),a=Math.min(a,u[s][2]);c.style.left=parseInt(o)+"px",c.style.top=parseInt(a)+"px",c.filters.item(0).M11=i[1][1],c.filters.item(0).M12=i[1][2],c.filters.item(0).M21=i[2][1],c.filters.item(0).M22=i[2][2]}},updateImageURL:function(e){var t=JXG.evaluate(e.url);this._setAttr(e.rendNode,"src",t)},appendChildPrim:function(e,t){JXG.exists(t)||(t=0),e.style.zIndex=t,this.container.appendChild(e)},appendNodesToElement:function(e,t){("shape"===t||"path"===t||"polygon"===t)&&(e.rendNodePath=this.getElementById(e.id+"_path")),e.rendNodeFill=this.getElementById(e.id+"_fill"),e.rendNodeStroke=this.getElementById(e.id+"_stroke"),e.rendNodeShadow=this.getElementById(e.id+"_shadow"),e.rendNode=this.getElementById(e.id)},createPrim:function(e,t){var i,n,r=this.createNode("fill"),o=this.createNode("stroke"),a=this.createNode("shadow");return this._setAttr(r,"id",this.container.id+"_"+t+"_fill"),this._setAttr(o,"id",this.container.id+"_"+t+"_stroke"),this._setAttr(a,"id",this.container.id+"_"+t+"_shadow"),"circle"===e||"ellipse"===e?(i=this.createNode("oval"),i.appendChild(r),i.appendChild(o),i.appendChild(a)):"polygon"===e||"path"===e||"shape"===e||"line"===e?(i=this.createNode("shape"),i.appendChild(r),i.appendChild(o),i.appendChild(a),n=this.createNode("path"),this._setAttr(n,"id",this.container.id+"_"+t+"_path"),i.appendChild(n)):(i=this.createNode(e),i.appendChild(r),i.appendChild(o),i.appendChild(a)),i.style.position="absolute",i.style.left="0px",i.style.top="0px",this._setAttr(i,"id",this.container.id+"_"+t),i},remove:function(e){JXG.exists(e)&&e.removeNode(!0)},makeArrows:function(e){var t;(e.visPropOld.firstarrow!==e.visProp.firstarrow||e.visPropOld.lastarrow!==e.visProp.lastarrow)&&(e.visProp.firstarrow?(t=e.rendNodeStroke,this._setAttr(t,"startarrow","block"),this._setAttr(t,"startarrowlength","long")):(t=e.rendNodeStroke,JXG.exists(t)&&this._setAttr(t,"startarrow","none")),e.visProp.lastarrow?(t=e.rendNodeStroke,this._setAttr(t,"id",this.container.id+"_"+e.id+"stroke"),this._setAttr(t,"endarrow","block"),this._setAttr(t,"endarrowlength","long")):(t=e.rendNodeStroke,JXG.exists(t)&&this._setAttr(t,"endarrow","none")),e.visPropOld.firstarrow=e.visProp.firstarrow,e.visPropOld.lastarrow=e.visProp.lastarrow)},updateEllipsePrim:function(e,t,i,n,r){e.style.left=parseInt(t-n)+"px",e.style.top=parseInt(i-r)+"px",e.style.width=parseInt(2*Math.abs(n))+"px",e.style.height=parseInt(2*Math.abs(r))+"px"},updateLinePrim:function(e,t,i,n,r,o){var a,s=this.resolution;isNaN(t+i+n+r)||(a=["m ",parseInt(s*t),", ",parseInt(s*i)," l ",parseInt(s*n),", ",parseInt(s*r)],this.updatePathPrim(e,a,o))
},updatePathPrim:function(e,t,i){var n=i.canvasWidth,r=i.canvasHeight;0>=t.length&&(t=["m 0,0"]),e.style.width=n,e.style.height=r,this._setAttr(e,"coordsize",[parseInt(this.resolution*n),parseInt(this.resolution*r)].join(",")),this._setAttr(e,"path",t.join(""))},updatePathStringPoint:function(e,t,i){var n=[],r=Math.round,o=e.coords.scrCoords,a=.5*t*Math.sqrt(3),s=.5*t,l=this.resolution;return"x"===i?n.push([" m ",r(l*(o[1]-t)),", ",r(l*(o[2]-t))," l ",r(l*(o[1]+t)),", ",r(l*(o[2]+t))," m ",r(l*(o[1]+t)),", ",r(l*(o[2]-t))," l ",r(l*(o[1]-t)),", ",r(l*(o[2]+t))].join("")):"+"===i?n.push([" m ",r(l*(o[1]-t)),", ",r(l*o[2])," l ",r(l*(o[1]+t)),", ",r(l*o[2])," m ",r(l*o[1]),", ",r(l*(o[2]-t))," l ",r(l*o[1]),", ",r(l*(o[2]+t))].join("")):"<>"===i?n.push([" m ",r(l*(o[1]-t)),", ",r(l*o[2])," l ",r(l*o[1]),", ",r(l*(o[2]+t))," l ",r(l*(o[1]+t)),", ",r(l*o[2])," l ",r(l*o[1]),", ",r(l*(o[2]-t))," x e "].join("")):"^"===i?n.push([" m ",r(l*o[1]),", ",r(l*(o[2]-t))," l ",r(l*(o[1]-a)),", ",r(l*(o[2]+s))," l ",r(l*(o[1]+a)),", ",r(l*(o[2]+s))," x e "].join("")):"v"===i?n.push([" m ",r(l*o[1]),", ",r(l*(o[2]+t))," l ",r(l*(o[1]-a)),", ",r(l*(o[2]-s))," l ",r(l*(o[1]+a)),", ",r(l*(o[2]-s))," x e "].join("")):">"===i?n.push([" m ",r(l*(o[1]+t)),", ",r(l*o[2])," l ",r(l*(o[1]-s)),", ",r(l*(o[2]-a))," l ",r(l*(o[1]-s)),", ",r(l*(o[2]+a))," l ",r(l*(o[1]+t)),", ",r(l*o[2])].join("")):"<"===i&&n.push([" m ",r(l*(o[1]-t)),", ",r(l*o[2])," l ",r(l*(o[1]+s)),", ",r(l*(o[2]-a))," l ",r(l*(o[1]+s)),", ",r(l*(o[2]+a))," x e "].join("")),n},updatePathStringPrim:function(e){var t,i,n=[],r=this.resolution,o=Math.round,a=" m ",s=" l ",l=" c ",c=a,u="plot"!==e.visProp.curvetype,d=Math.min(e.numberPoints,8192);if(0>=e.numberPoints)return"";if(d=Math.min(d,e.points.length),1==e.bezierDegree)for(u&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,1)),t=0;d>t;t++)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?c=a:(i[1]>2e4?i[1]=2e4:-2e4>i[1]&&(i[1]=-2e4),i[2]>2e4?i[2]=2e4:-2e4>i[2]&&(i[2]=-2e4),n.push([c,o(r*i[1]),", ",o(r*i[2])].join("")),c=s);else if(3==e.bezierDegree)for(t=0;d>t;)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?c=a:(n.push([c,o(r*i[1]),", ",o(r*i[2])].join("")),c==l&&(t++,i=e.points[t].scrCoords,n.push([" ",o(r*i[1]),", ",o(r*i[2])].join("")),t++,i=e.points[t].scrCoords,n.push([" ",o(r*i[1]),", ",o(r*i[2])].join(""))),c=l),t++;return n.push(" e"),n},updatePathStringBezierPrim:function(e){var t,i,n,r,o,a=[],s=e.visProp.strokewidth,l=this.resolution,c=Math.round,u=" m ",d=" c ",h=u,p="plot"!==e.visProp.curvetype,f=Math.min(e.numberPoints,8192);if(0>=e.numberPoints)return"";for(p&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,1)),f=Math.min(f,e.points.length),i=1;3>i;i++)for(h=u,t=0;f>t;t++)n=e.points[t].scrCoords,isNaN(n[1])||isNaN(n[2])?h=u:(n[1]>2e4?n[1]=2e4:-2e4>n[1]&&(n[1]=-2e4),n[2]>2e4?n[2]=2e4:-2e4>n[2]&&(n[2]=-2e4),h==u?a.push([h,c(l*(n[1]+0*s*(2*i*Math.random()-i)))," ",c(l*(n[2]+0*s*(2*i*Math.random()-i)))].join("")):a.push([h,c(l*(r+.333*(n[1]-r)+s*(2*i*Math.random()-i)))," ",c(l*(o+.333*(n[2]-o)+s*(2*i*Math.random()-i)))," ",c(l*(r+.333*2*(n[1]-r)+s*(2*i*Math.random()-i)))," ",c(l*(o+.333*2*(n[2]-o)+s*(2*i*Math.random()-i)))," ",c(l*n[1])," ",c(l*n[2])].join("")),h=d,r=n[1],o=n[2]);return a.push(" e"),a},updatePolygonPrim:function(e,t){var i,n,r=t.vertices.length,o=this.resolution,a=[];if(this._setAttr(e,"stroked","false"),n=t.vertices[0].coords.scrCoords,!isNaN(n[1]+n[2])){for(a.push(["m ",parseInt(o*n[1]),",",parseInt(o*n[2])," l "].join("")),i=1;r-1>i;i++){if(!t.vertices[i].isReal)return this.updatePathPrim(e,"",t.board),void 0;if(n=t.vertices[i].coords.scrCoords,isNaN(n[1]+n[2]))return;a.push(parseInt(o*n[1])+","+parseInt(o*n[2])),r-2>i&&a.push(", ")}a.push(" x e"),this.updatePathPrim(e,a,t.board)}},updateRectPrim:function(e,t,i,n,r){e.style.left=parseInt(t)+"px",e.style.top=parseInt(i)+"px",n>=0&&(e.style.width=n+"px"),r>=0&&(e.style.height=r+"px")},setPropertyPrim:function(e,t,i){var n,r="";switch(t){case"stroke":r="strokecolor";break;case"stroke-width":r="strokeweight";break;case"stroke-dasharray":r="dashstyle"}""!==r&&(n=JXG.evaluate(i),this._setAttr(e,r,n))},show:function(e){e&&e.rendNode&&(e.rendNode.style.visibility="inherit")},hide:function(e){e&&e.rendNode&&(e.rendNode.style.visibility="hidden")},setDashStyle:function(e,t){var i;t.dash>=0&&(i=e.rendNodeStroke,this._setAttr(i,"dashstyle",this.dashArray[t.dash]))},setGradient:function(e){var t=e.rendNodeFill;"linear"===e.visProp.gradient?(this._setAttr(t,"type","gradient"),this._setAttr(t,"color2",e.visProp.gradientsecondcolor),this._setAttr(t,"opacity2",e.visProp.gradientsecondopacity),this._setAttr(t,"angle",e.visProp.gradientangle)):"radial"===e.visProp.gradient?(this._setAttr(t,"type","gradientradial"),this._setAttr(t,"color2",e.visProp.gradientsecondcolor),this._setAttr(t,"opacity2",e.visProp.gradientsecondopacity),this._setAttr(t,"focusposition",100*e.visProp.gradientpositionx+"%,"+100*e.visProp.gradientpositiony+"%"),this._setAttr(t,"focussize","0,0")):this._setAttr(t,"type","solid")},setObjectFillColor:function(e,t,i){var n,r,o,a,s=JXG.evaluate(t),l=JXG.evaluate(i);e.rendNode,l=l>0?l:0,(e.visPropOld.fillcolor!==s||e.visPropOld.fillopacity!==l)&&(JXG.exists(s)&&s!==!1&&(9!=s.length?(n=s,o=l):(r=JXG.rgba2rgbo(s),n=r[0],o=l*r[1]),"none"===n||n===!1?this._setAttr(e.rendNode,"filled","false"):(this._setAttr(e.rendNode,"filled","true"),this._setAttr(e.rendNode,"fillcolor",n),JXG.exists(o)&&e.rendNodeFill&&this._setAttr(e.rendNodeFill,"opacity",100*o+"%")),e.type===JXG.OBJECT_TYPE_IMAGE&&(a=""+e.rendNode.style.filter,a.match(/alpha/)?e.rendNode.style.filter=a.replace(/alpha\(opacity *= *[0-9\.]+\)/,"alpha(opacity = "+100*o+")"):e.rendNode.style.filter+=" alpha(opacity = "+100*o+")")),e.visPropOld.fillcolor=s,e.visPropOld.fillopacity=l)},setObjectStrokeColor:function(e,t,i){var n,r,o,a,s=JXG.evaluate(t),l=JXG.evaluate(i),c=e.rendNode;l=l>0?l:0,(e.visPropOld.strokecolor!==s||e.visPropOld.strokeopacity!==l)&&(JXG.exists(s)&&s!==!1&&(9!=s.length?(n=s,o=l):(r=JXG.rgba2rgbo(s),n=r[0],o=l*r[1]),e.type===JXG.OBJECT_TYPE_TEXT?(o=Math.round(100*o),c.style.filter=" alpha(opacity = "+o+")",c.style.color=n):(n!==!1&&(this._setAttr(c,"stroked","true"),this._setAttr(c,"strokecolor",n)),a=e.rendNodeStroke,JXG.exists(o)&&e.type!==JXG.OBJECT_TYPE_IMAGE&&this._setAttr(a,"opacity",100*o+"%"))),e.visPropOld.strokecolor=s,e.visPropOld.strokeopacity=l)},setObjectStrokeWidth:function(e,t){var i,n=JXG.evaluate(t);e.visPropOld.strokewidth!==n&&(i=e.rendNode,this.setPropertyPrim(i,"stroked","true"),JXG.exists(n)&&this.setPropertyPrim(i,"stroke-width",n),e.visPropOld.strokewidth=n)},setShadow:function(e){var t=e.rendNodeShadow;t&&e.visPropOld.shadow!==e.visProp.shadow&&(e.visProp.shadow?(this._setAttr(t,"On","True"),this._setAttr(t,"Offset","3pt,3pt"),this._setAttr(t,"Opacity","60%"),this._setAttr(t,"Color","#aaaaaa")):this._setAttr(t,"On","False"),e.visPropOld.shadow=e.visProp.shadow)},suspendRedraw:function(){this.container.style.display="none"},unsuspendRedraw:function(){this.container.style.display=""}}),JXG.CanvasRenderer=function(e){this.type="canvas",this.canvasRoot=null,this.suspendHandle=null,this.canvasId=JXG.Util.genUUID(),this.canvasNamespace=null,"undefined"!=typeof document?(this.container=e,this.container.style.MozUserSelect="none",this.container.style.overflow="hidden",""===this.container.style.position&&(this.container.style.position="relative"),this.container.innerHTML=['<canvas id="',this.canvasId,'" width="',JXG.getStyle(this.container,"width"),'" height="',JXG.getStyle(this.container,"height"),'"><',"/canvas>"].join(""),this.canvasRoot=document.getElementById(this.canvasId),this.context=this.canvasRoot.getContext("2d")):JXG.isNode()&&(this.canvasId=require("canvas"),this.canvasRoot=new this.canvasId(500,500),this.context=this.canvasRoot.getContext("2d")),this.dashArray=[[2,2],[5,5],[10,10],[20,20],[20,10,10,10],[20,5,10,5]]},JXG.CanvasRenderer.prototype=new JXG.AbstractRenderer,JXG.extend(JXG.CanvasRenderer.prototype,{_drawFilledPolygon:function(e){var t,i=e.length,n=this.context;if(i>0){for(n.beginPath(),n.moveTo(e[0][0],e[0][1]),t=0;i>t;t++)t>0&&n.lineTo(e[t][0],e[t][1]);n.lineTo(e[0][0],e[0][1]),n.fill()}},_fill:function(e){var t=this.context;t.save(),this._setColor(e,"fill")&&t.fill(),t.restore()},_rotatePoint:function(e,t,i){return[t*Math.cos(e)-i*Math.sin(e),t*Math.sin(e)+i*Math.cos(e)]},_rotateShape:function(e,t){var i,n=[],r=e.length;if(0>=r)return e;for(i=0;r>i;i++)n.push(this._rotatePoint(t,e[i][0],e[i][1]));return n},_setColor:function(e,t,i){var n,r,o,a,s,l,c=!0,u=!1,d=e.visProp;return t=t||"stroke",i=i||t,JXG.exists(e.board)&&JXG.exists(e.board.highlightedObjects)||(u=!0),n=!u&&JXG.exists(e.board.highlightedObjects[e.id])?"highlight":"",r=JXG.evaluate(d[n+t+"color"]),"none"!==r&&r!==!1?(s=JXG.evaluate(d[n+t+"opacity"]),s=s>0?s:0,9!=r.length?(a=r,l=s):(o=JXG.rgba2rgbo(r),a=o[0],l=s*o[1]),this.context.globalAlpha=l,this.context[i+"Style"]=a):c=!1,"stroke"===t&&(this.context.lineWidth=parseFloat(d.strokewidth)),c},_stroke:function(e){var t=this.context;t.save(),e.visProp.dash>0?t.setLineDash&&t.setLineDash(this.dashArray[e.visProp.dash]):this.context.lineDashArray=[],this._setColor(e,"stroke")&&t.stroke(),t.restore()},_translateShape:function(e,t,i){var n,r=[],o=e.length;if(0>=o)return e;for(n=0;o>n;n++)r.push([e[n][0]+t,e[n][1]+i]);return r},drawPoint:function(e){var t=e.visProp.face,i=e.visProp.size,n=e.coords.scrCoords,r=.5*i*Math.sqrt(3),o=.5*i,a=parseFloat(e.visProp.strokewidth)/2,s=this.context;switch(t){case"cross":case"x":s.beginPath(),s.moveTo(n[1]-i,n[2]-i),s.lineTo(n[1]+i,n[2]+i),s.moveTo(n[1]+i,n[2]-i),s.lineTo(n[1]-i,n[2]+i),s.closePath(),this._stroke(e);break;case"circle":case"o":s.beginPath(),s.arc(n[1],n[2],i+1+a,0,2*Math.PI,!1),s.closePath(),this._fill(e),this._stroke(e);break;case"square":case"[]":if(0>=i)break;s.save(),this._setColor(e,"stroke","fill")&&s.fillRect(n[1]-i-a,n[2]-i-a,2*i+3*a,2*i+3*a),s.restore(),s.save(),this._setColor(e,"fill"),s.fillRect(n[1]-i+a,n[2]-i+a,2*i-a,2*i-a),s.restore();break;case"plus":case"+":s.beginPath(),s.moveTo(n[1]-i,n[2]),s.lineTo(n[1]+i,n[2]),s.moveTo(n[1],n[2]-i),s.lineTo(n[1],n[2]+i),s.closePath(),this._stroke(e);break;case"diamond":case"<>":s.beginPath(),s.moveTo(n[1]-i,n[2]),s.lineTo(n[1],n[2]+i),s.lineTo(n[1]+i,n[2]),s.lineTo(n[1],n[2]-i),s.closePath(),this._fill(e),this._stroke(e);break;case"triangleup":case"a":case"^":s.beginPath(),s.moveTo(n[1],n[2]-i),s.lineTo(n[1]-r,n[2]+o),s.lineTo(n[1]+r,n[2]+o),s.closePath(),this._fill(e),this._stroke(e);break;case"triangledown":case"v":s.beginPath(),s.moveTo(n[1],n[2]+i),s.lineTo(n[1]-r,n[2]-o),s.lineTo(n[1]+r,n[2]-o),s.closePath(),this._fill(e),this._stroke(e);break;case"triangleleft":case"<":s.beginPath(),s.moveTo(n[1]-i,n[2]),s.lineTo(n[1]+o,n[2]-r),s.lineTo(n[1]+o,n[2]+r),s.closePath(),this.fill(e),this._stroke(e);break;case"triangleright":case">":s.beginPath(),s.moveTo(n[1]+i,n[2]),s.lineTo(n[1]-o,n[2]-r),s.lineTo(n[1]-o,n[2]+r),s.closePath(),this._fill(e),this._stroke(e)}},updatePoint:function(e){this.drawPoint(e)},drawLine:function(e){var t=new JXG.Coords(JXG.COORDS_BY_USER,e.point1.coords.usrCoords,e.board),i=new JXG.Coords(JXG.COORDS_BY_USER,e.point2.coords.usrCoords,e.board);JXG.Math.Geometry.calcStraight(e,t,i),this.context.beginPath(),this.context.moveTo(t.scrCoords[1],t.scrCoords[2]),this.context.lineTo(i.scrCoords[1],i.scrCoords[2]),this._stroke(e),this.makeArrows(e,t,i)},updateLine:function(e){this.drawLine(e)},drawTicks:function(){},updateTicks:function(e){var t,i,n=e.ticks.length,r=this.context;for(r.beginPath(),t=0;n>t;t++)i=e.ticks[t],x=i[0],y=i[1],r.moveTo(x[0],y[0]),r.lineTo(x[1],y[1]);for(t=0;n>t;t++)i=e.ticks[t].scrCoords,e.ticks[t].major&&(e.board.needsFullUpdate||e.needsRegularUpdate)&&e.labels[t]&&e.labels[t].visProp.visible&&this.updateText(e.labels[t]);this._stroke(e)},drawCurve:function(e){e.visProp.handdrawing?this.updatePathStringBezierPrim(e):this.updatePathStringPrim(e)},updateCurve:function(e){this.drawCurve(e)},drawEllipse:function(e){var t=e.center.coords.scrCoords[1],i=e.center.coords.scrCoords[2],n=e.board.unitX,r=e.board.unitY,o=2*e.Radius(),a=2*e.Radius(),s=o*n,l=a*r,c=t-s/2,u=i-l/2,d=.5522848*(s/2),h=.5522848*(l/2),p=c+s,f=u+l,g=c+s/2,m=u+l/2,b=this.context;o>0&&a>0&&!isNaN(t+i)&&(b.beginPath(),b.moveTo(c,m),b.bezierCurveTo(c,m-h,g-d,u,g,u),b.bezierCurveTo(g+d,u,p,m-h,p,m),b.bezierCurveTo(p,m+h,g+d,f,g,f),b.bezierCurveTo(g-d,f,c,m+h,c,m),b.closePath(),this._fill(e),this._stroke(e))},updateEllipse:function(e){return this.drawEllipse(e)},displayCopyright:function(e,t){var i=this.context;i.save(),i.font=t+"px Arial",i.fillStyle="#aaa",i.lineWidth=.5,i.fillText(e,10,2+t),i.restore()},drawInternalText:function(e){var t,i=this.context;return i.save(),this._setColor(e,"stroke","fill")&&!isNaN(e.coords.scrCoords[1]+e.coords.scrCoords[2])&&(e.visProp.fontsize&&("function"==typeof e.visProp.fontsize?(t=e.visProp.fontsize(),i.font=(t>0?t:0)+"px Arial"):i.font=e.visProp.fontsize+"px Arial"),this.transformImage(e,e.transformations),"right"===e.visProp.anchorx?i.textAlign="right":"middle"===e.visProp.anchorx&&(i.textAlign="center"),"top"===e.visProp.anchory?i.textBaseline="top":"middle"===e.visProp.anchory&&(i.textBaseline="middle"),i.fillText(e.plaintext,e.coords.scrCoords[1],e.coords.scrCoords[2])),i.restore(),null},updateInternalText:function(e){this.drawInternalText(e)},setObjectStrokeColor:function(e,t,i){var n,r,o,a,s=JXG.evaluate(t),l=JXG.evaluate(i);l=l>0?l:0,(e.visPropOld.strokecolor!==s||e.visPropOld.strokeopacity!==l)&&(JXG.exists(s)&&s!==!1&&(9!=s.length?(n=s,o=l):(r=JXG.rgba2rgbo(s),n=r[0],o=l*r[1]),a=e.rendNode,e.type===JXG.OBJECT_TYPE_TEXT&&"html"===e.visProp.display&&(a.style.color=n,a.style.opacity=o)),e.visPropOld.strokecolor=s,e.visPropOld.strokeopacity=l)},drawImage:function(e){e.rendNode=new Image,e._src="",this.updateImage(e)},updateImage:function(e){var t=this.context,i=JXG.evaluate(e.visProp.fillopacity),n=JXG.bind(function(){e.imgIsLoaded=!0,0>=e.size[0]||0>=e.size[1]||(t.save(),t.globalAlpha=i,this.transformImage(e,e.transformations),t.drawImage(e.rendNode,e.coords.scrCoords[1],e.coords.scrCoords[2]-e.size[1],e.size[0],e.size[1]),t.restore())},this);this.updateImageURL(e)?e.rendNode.onload=n:e.imgIsLoaded&&n()},transformImage:function(e,t){var i,n=t.length,r=this.context;n>0&&(i=this.joinTransforms(e,t),Math.abs(JXG.Math.Numerics.det(i))>=JXG.Math.eps&&r.transform(i[1][1],i[2][1],i[1][2],i[2][2],i[1][0],i[2][0]))},updateImageURL:function(e){var t;return t=JXG.evaluate(e.url),e._src!==t?(e.imgIsLoaded=!1,e.rendNode.src=t,e._src=t,!0):!1},remove:function(e){JXG.exists(e)&&JXG.exists(e.parentNode)&&e.parentNode.removeChild(e)},makeArrows:function(e,t,i){var n,r,o,a,s,l=Math.min(e.visProp.strokewidth/2,3),c=[[2,0],[-10,-4*l],[-10,4*l],[2,0]],u=[[-2,0],[10,-4*l],[10,4*l]],d=this.context;if("none"!==e.visProp.strokecolor&&(e.visProp.lastarrow||e.visProp.firstarrow)){if(e.elementClass!==JXG.OBJECT_CLASS_LINE)return;n=t.scrCoords[1],r=t.scrCoords[2],o=i.scrCoords[1],a=i.scrCoords[2],d.save(),this._setColor(e,"stroke","fill")&&(s=Math.atan2(a-r,o-n),e.visProp.lastarrow&&this._drawFilledPolygon(this._translateShape(this._rotateShape(c,s),o,a)),e.visProp.firstarrow&&this._drawFilledPolygon(this._translateShape(this._rotateShape(u,s),n,r))),d.restore()}},updatePathStringPrim:function(e){var t,i,n,r,o,a="M",s="L",l="C",c=a,u=5e3,d="plot"!==e.visProp.curvetype,h=this.context;if(!(0>=e.numberPoints)){if(o=Math.min(e.points.length,e.numberPoints),h.beginPath(),1==e.bezierDegree)for(d&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,.5)),t=0;o>t;t++)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?c=a:(i[1]>u?i[1]=u:-u>i[1]&&(i[1]=-u),i[2]>u?i[2]=u:-u>i[2]&&(i[2]=-u),c===a?h.moveTo(i[1],i[2]):h.lineTo(i[1],i[2]),c=s);else if(3==e.bezierDegree)for(t=0;o>t;)i=e.points[t].scrCoords,isNaN(i[1])||isNaN(i[2])?c=a:(c===a?h.moveTo(i[1],i[2]):(t++,n=e.points[t].scrCoords,t++,r=e.points[t].scrCoords,h.bezierCurveTo(i[1],i[2],n[1],n[2],r[1],r[2])),c=l),t++;this._fill(e),this._stroke(e)}},updatePathStringBezierPrim:function(e){var t,i,n,r,o,a,s="M",l="C",c=s,u=5e3,d=e.visProp.strokewidth,h="plot"!==e.visProp.curvetype,p=this.context;if(!(0>=e.numberPoints)){for(h&&e.board.options.curve.RDPsmoothing&&(e.points=JXG.Math.Numerics.RamerDouglasPeuker(e.points,.5)),a=Math.min(e.points.length,e.numberPoints),p.beginPath(),i=1;3>i;i++)for(c=s,t=0;a>t;t++)n=e.points[t].scrCoords,isNaN(n[1])||isNaN(n[2])?c=s:(n[1]>u?n[1]=u:-u>n[1]&&(n[1]=-u),n[2]>u?n[2]=u:-u>n[2]&&(n[2]=-u),c==s?p.moveTo(n[1]+0*d*(2*i*Math.random()-i),n[2]+0*d*(2*i*Math.random()-i)):p.bezierCurveTo(r+.333*(n[1]-r)+d*(2*i*Math.random()-i),o+.333*(n[2]-o)+d*(2*i*Math.random()-i),r+.333*2*(n[1]-r)+d*(2*i*Math.random()-i),o+.333*2*(n[2]-o)+d*(2*i*Math.random()-i),n[1],n[2]),c=l,r=n[1],o=n[2]);this._fill(e),this._stroke(e)}},updatePolygonPrim:function(e,t){var i,n,r=t.vertices.length,o=this.context,a=!0;if(!(0>=r)){for(o.beginPath(),n=0;!t.vertices[n].isReal&&r-1>n;)n++,a=!1;for(i=t.vertices[n].coords.scrCoords,o.moveTo(i[1],i[2]),n=n;r-1>n;n++)t.vertices[n].isReal||(a=!1),i=t.vertices[n].coords.scrCoords,o.lineTo(i[1],i[2]);o.closePath(),a&&this._fill(t)}},show:function(e){JXG.exists(e.rendNode)&&(e.rendNode.style.visibility="inherit")},hide:function(e){JXG.exists(e.rendNode)&&(e.rendNode.style.visibility="hidden")},setGradient:function(e){var t,i;i=JXG.evaluate(e.visProp.fillopacity),i=i>0?i:0,t=JXG.evaluate(e.visProp.fillcolor)},setShadow:function(e){e.visPropOld.shadow!==e.visProp.shadow&&(e.visPropOld.shadow=e.visProp.shadow)},highlight:function(e){return e.type===JXG.OBJECT_TYPE_TEXT&&"html"===e.visProp.display?this.updateTextStyle(e,!0):(e.board.prepareUpdate(),e.board.renderer.suspendRedraw(e.board),e.board.updateRenderer(),e.board.renderer.unsuspendRedraw()),this},noHighlight:function(e){return e.type===JXG.OBJECT_TYPE_TEXT&&"html"===e.visProp.display?this.updateTextStyle(e,!1):(e.board.prepareUpdate(),e.board.renderer.suspendRedraw(e.board),e.board.updateRenderer(),e.board.renderer.unsuspendRedraw()),this},suspendRedraw:function(e){this.context.save(),this.context.clearRect(0,0,this.canvasRoot.width,this.canvasRoot.height),e&&e.showCopyright&&this.displayCopyright(JXG.JSXGraph.licenseText,12)},unsuspendRedraw:function(){this.context.restore()},resize:function(e,t){this.container?(this.canvasRoot.style.width=parseFloat(e)+"px",this.canvasRoot.style.height=parseFloat(t)+"px",this.canvasRoot.setAttribute("width",parseFloat(e)+"px"),this.canvasRoot.setAttribute("height",parseFloat(t)+"px")):(this.canvasRoot.width=parseFloat(e),this.canvasRoot.height=parseFloat(t))}});