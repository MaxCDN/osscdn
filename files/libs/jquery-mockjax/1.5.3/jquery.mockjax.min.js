/*!
 * MockJax - jQuery Plugin to Mock Ajax requests
 *
 * Version:  1.5.3
 * Released:
 * Home:   http://github.com/appendto/jquery-mockjax
 * Author:   Jonathan Sharp (http://jdsharp.com)
 * License:  MIT,GPL
 *
 * Copyright (c) 2011 appendTo LLC.
 * Dual licensed under the MIT or GPL licenses.
 * http://appendto.com/open-source-licenses
 */
(function(f){var d=f.ajax,e=[],l=[],n=/=\?(&|$)/,q=(new Date()).getTime();function m(v){if(window.DOMParser==undefined&&window.ActiveXObject){DOMParser=function(){};DOMParser.prototype.parseFromString=function(B){var A=new ActiveXObject("Microsoft.XMLDOM");A.async="false";A.loadXML(B);return A}}try{var x=(new DOMParser()).parseFromString(v,"text/xml");if(f.isXMLDoc(x)){var w=f("parsererror",x);if(w.length==1){throw ("Error: "+f(x).text())}}else{throw ("Unable to parse XML")}return x}catch(y){var z=(y.name==undefined?y:y.name+": "+y.message);f(document).trigger("xmlParseError",[z]);return undefined}}function p(x,w,v){(x.context?f(x.context):f.event).trigger(w,v)}function g(v,w){var x=true;if(typeof w==="string"){return f.isFunction(v.test)?v.test(w):v==w}f.each(v,function(y){if(w[y]===undefined){x=false;return x}else{if(typeof w[y]==="object"&&w[y]!==null){x=x&&g(v[y],w[y])}else{if(v[y]&&f.isFunction(v[y].test)){x=x&&v[y].test(w[y])}else{x=x&&(v[y]==w[y])}}}});return x}function b(v,w){return v[w]===f.mockjaxSettings[w]}function t(v,x){if(f.isFunction(v)){return v(x)}if(f.isFunction(v.url.test)){if(!v.url.test(x.url)){return null}}else{var w=v.url.indexOf("*");if(v.url!==x.url&&w===-1||!new RegExp(v.url.replace(/[-[\]{}()+?.,\\^$|#\s]/g,"\\$&").replace(/\*/g,".+")).test(x.url)){return null}}if(v.data&&x.data){if(!g(v.data,x.data)){return null}}if(v&&v.type&&v.type.toLowerCase()!=x.type.toLowerCase()){return null}return v}function h(w,y,v){var x=(function(z){return function(){return(function(){var A;this.status=w.status;this.statusText=w.statusText;this.readyState=4;if(f.isFunction(w.response)){w.response(v)}if(y.dataType=="json"&&(typeof w.responseText=="object")){this.responseText=JSON.stringify(w.responseText)}else{if(y.dataType=="xml"){if(typeof w.responseXML=="string"){this.responseXML=m(w.responseXML);this.responseText=w.responseXML}else{this.responseXML=w.responseXML}}else{this.responseText=w.responseText}}if(typeof w.status=="number"||typeof w.status=="string"){this.status=w.status}if(typeof w.statusText==="string"){this.statusText=w.statusText}A=this.onreadystatechange||this.onload;if(f.isFunction(A)){if(w.isTimeout){this.status=-1}A.call(this,w.isTimeout?"timeout":undefined)}else{if(w.isTimeout){this.status=-1}}}).apply(z)}})(this);if(w.proxy){d({global:false,url:w.proxy,type:w.proxyType,data:w.data,dataType:y.dataType==="script"?"text/plain":y.dataType,complete:function(z){w.responseXML=z.responseXML;w.responseText=z.responseText;if(b(w,"status")){w.status=z.status}if(b(w,"statusText")){w.statusText=z.statusText}this.responseTimer=setTimeout(x,w.responseTime||0)}})}else{if(y.async===false){x()}else{this.responseTimer=setTimeout(x,w.responseTime||50)}}}function i(x,y,v,w){x=f.extend(true,{},f.mockjaxSettings,x);if(typeof x.headers==="undefined"){x.headers={}}if(x.contentType){x.headers["content-type"]=x.contentType}return{status:x.status,statusText:x.statusText,readyState:1,open:function(){},send:function(){w.fired=true;h.call(this,x,y,v)},abort:function(){clearTimeout(this.responseTimer)},setRequestHeader:function(A,z){x.headers[A]=z},getResponseHeader:function(z){if(x.headers&&x.headers[z]){return x.headers[z]}else{if(z.toLowerCase()=="last-modified"){return x.lastModified||(new Date()).toString()}else{if(z.toLowerCase()=="etag"){return x.etag||""}else{if(z.toLowerCase()=="content-type"){return x.contentType||"text/plain"}}}}},getAllResponseHeaders:function(){var z="";f.each(x.headers,function(B,A){z+=B+": "+A+"\n"});return z}}}function k(B,z,v){c(B);B.dataType="json";if(B.data&&n.test(B.data)||n.test(B.url)){r(B,z,v);var x=/^(\w+:)?\/\/([^\/?#]+)/,A=x.exec(B.url),y=A&&(A[1]&&A[1]!==location.protocol||A[2]!==location.host);B.dataType="script";if(B.type.toUpperCase()==="GET"&&y){var w=o(B,z,v);if(w){return w}else{return true}}}return null}function c(v){if(v.type.toUpperCase()==="GET"){if(!n.test(v.url)){v.url+=(/\?/.test(v.url)?"&":"?")+(v.jsonp||"callback")+"=?"}}else{if(!v.data||!n.test(v.data)){v.data=(v.data?v.data+"&":"")+(v.jsonp||"callback")+"=?"}}}function o(y,x,v){var w=v&&v.context||y,z=null;if(x.response&&f.isFunction(x.response)){x.response(v)}else{if(typeof x.responseText==="object"){f.globalEval("("+JSON.stringify(x.responseText)+")")}else{f.globalEval("("+x.responseText+")")}}j(y,w,x);s(y,w,x);if(f.Deferred){z=new f.Deferred();if(typeof x.responseText=="object"){z.resolveWith(w,[x.responseText])}else{z.resolveWith(w,[f.parseJSON(x.responseText)])}}return z}function r(y,x,v){var w=v&&v.context||y;var z=y.jsonpCallback||("jsonp"+q++);if(y.data){y.data=(y.data+"").replace(n,"="+z+"$1")}y.url=y.url.replace(n,"="+z+"$1");window[z]=window[z]||function(A){data=A;j(y,w,x);s(y,w,x);window[z]=undefined;try{delete window[z]}catch(B){}if(head){head.removeChild(script)}}}function j(x,v,w){if(x.success){x.success.call(v,w.responseText||"",status,{})}if(x.global){p(x,"ajaxSuccess",[{},x])}}function s(w,v){if(w.complete){w.complete.call(v,{},status)}if(w.global){p("ajaxComplete",[{},w])}if(w.global&&!--f.active){f.event.trigger("ajaxStop")}}function a(x,v){var A,z,y;if(typeof x==="object"){v=x;x=undefined}else{v.url=x}z=f.extend(true,{},f.ajaxSettings,v);for(var w=0;w<e.length;w++){if(!e[w]){continue}y=t(e[w],z);if(!y){continue}l.push(z);f.mockjaxSettings.log(y,z);if(z.dataType==="jsonp"){if((A=k(z,y,v))){return A}}y.cache=z.cache;y.timeout=z.timeout;y.global=z.global;u(y,v);(function(D,E,B,C){A=d.call(f,f.extend(true,{},B,{xhr:function(){return i(D,E,B,C)}}))})(y,z,v,e[w]);return A}if(f.mockjaxSettings.throwUnmocked===true){throw ("AJAX not mocked: "+v.url)}else{return d.apply(f,[v])}}function u(y,w){if(!(y.url instanceof RegExp)){return}if(!y.hasOwnProperty("urlParams")){return}var v=y.url.exec(w.url);if(v.length===1){return}v.shift();var z=0,x=v.length,B=y.urlParams.length,C=Math.min(x,B),A={};for(z;z<C;z++){var D=y.urlParams[z];A[D]=v[z]}w.urlParams=A}f.extend({ajax:a});f.mockjaxSettings={log:function(x,z){if(x.logging===false||(typeof x.logging==="undefined"&&f.mockjaxSettings.logging===false)){return}if(window.console&&console.log){var w="MOCK "+z.type.toUpperCase()+": "+z.url;var v=f.extend({},z);if(typeof console.log==="function"){console.log(w,v)}else{try{console.log(w+" "+JSON.stringify(v))}catch(y){console.log(w)}}}},logging:true,status:200,statusText:"OK",responseTime:500,isTimeout:false,throwUnmocked:false,contentType:"text/plain",response:"",responseText:"",responseXML:"",proxy:"",proxyType:"GET",lastModified:null,etag:"",headers:{etag:"IJF@H#@923uf8023hFO@I#H#","content-type":"text/plain"}};f.mockjax=function(w){var v=e.length;e[v]=w;return v};f.mockjaxClear=function(v){if(arguments.length==1){e[v]=null}else{e=[]}l=[]};f.mockjax.handler=function(v){if(arguments.length==1){return e[v]}};f.mockjax.mockedAjaxCalls=function(){return l}})(jQuery);